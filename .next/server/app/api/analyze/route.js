/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/analyze/route";
exports.ids = ["app/api/analyze/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=D%3A%5Ccoding%5Claunch%5CthoughtPolice%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Ccoding%5Claunch%5CthoughtPolice&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=D%3A%5Ccoding%5Claunch%5CthoughtPolice%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Ccoding%5Claunch%5CthoughtPolice&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_coding_launch_thoughtPolice_src_app_api_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/analyze/route.ts */ \"(rsc)/./src/app/api/analyze/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/analyze/route\",\n        pathname: \"/api/analyze\",\n        filename: \"route\",\n        bundlePath: \"app/api/analyze/route\"\n    },\n    resolvedPagePath: \"D:\\\\coding\\\\launch\\\\thoughtPolice\\\\src\\\\app\\\\api\\\\analyze\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_coding_launch_thoughtPolice_src_app_api_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhbmFseXplJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhbmFseXplJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYW5hbHl6ZSUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDY29kaW5nJTVDbGF1bmNoJTVDdGhvdWdodFBvbGljZSU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RCUzQSU1Q2NvZGluZyU1Q2xhdW5jaCU1Q3Rob3VnaHRQb2xpY2UmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ21CO0FBQ2hHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGOztBQUUxRiIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJEOlxcXFxjb2RpbmdcXFxcbGF1bmNoXFxcXHRob3VnaHRQb2xpY2VcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYW5hbHl6ZVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYW5hbHl6ZS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FuYWx5emVcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2FuYWx5emUvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJEOlxcXFxjb2RpbmdcXFxcbGF1bmNoXFxcXHRob3VnaHRQb2xpY2VcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYW5hbHl6ZVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=D%3A%5Ccoding%5Claunch%5CthoughtPolice%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Ccoding%5Claunch%5CthoughtPolice&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/analyze/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/analyze/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_services_redditApi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/services/redditApi */ \"(rsc)/./src/lib/services/redditApi.ts\");\n/* harmony import */ var _lib_services_multiModelPipeline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/services/multiModelPipeline */ \"(rsc)/./src/lib/services/multiModelPipeline.ts\");\n\n\n\nasync function POST(request) {\n    try {\n        const { username, verbose = false } = await request.json();\n        if (!username) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Username is required'\n            }, {\n                status: 400\n            });\n        }\n        console.log(`Starting analysis for user: ${username}`);\n        // Set verbose mode\n        if (verbose) {\n            _lib_services_redditApi__WEBPACK_IMPORTED_MODULE_1__.redditApi.setVerbose(true);\n            _lib_services_multiModelPipeline__WEBPACK_IMPORTED_MODULE_2__.multiModelPipeline.setVerbose(true);\n        }\n        // Fetch user data server-side\n        const userData = await _lib_services_redditApi__WEBPACK_IMPORTED_MODULE_1__.redditApi.getFullUserData(username, {\n            maxItems: 5000,\n            maxAge: 365,\n            verbose\n        });\n        if (!userData.user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'User not found'\n            }, {\n                status: 404\n            });\n        }\n        console.log(`User data fetched: ${userData.comments.length} comments, ${userData.posts.length} posts`);\n        // Analyze using pipeline server-side\n        const analysis = await _lib_services_multiModelPipeline__WEBPACK_IMPORTED_MODULE_2__.multiModelPipeline.analyzeUser(userData.comments, userData.posts, username);\n        console.log(`Analysis complete for ${username}`);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(analysis);\n    } catch (error) {\n        console.error('Analysis API error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : 'Analysis failed'\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hbmFseXplL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBdUQ7QUFDSDtBQUNrQjtBQUUvRCxlQUFlRyxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxRQUFRLEVBQUVDLFVBQVUsS0FBSyxFQUFFLEdBQUcsTUFBTUYsUUFBUUcsSUFBSTtRQUV4RCxJQUFJLENBQUNGLFVBQVU7WUFDYixPQUFPTCxxREFBWUEsQ0FBQ08sSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQXVCLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUM1RTtRQUVBQyxRQUFRQyxHQUFHLENBQUMsQ0FBQyw0QkFBNEIsRUFBRU4sVUFBVTtRQUVyRCxtQkFBbUI7UUFDbkIsSUFBSUMsU0FBUztZQUNYTCw4REFBU0EsQ0FBQ1csVUFBVSxDQUFDO1lBQ3JCVixnRkFBa0JBLENBQUNVLFVBQVUsQ0FBQztRQUNoQztRQUVBLDhCQUE4QjtRQUM5QixNQUFNQyxXQUFXLE1BQU1aLDhEQUFTQSxDQUFDYSxlQUFlLENBQUNULFVBQVU7WUFDekRVLFVBQVU7WUFDVkMsUUFBUTtZQUNSVjtRQUNGO1FBRUEsSUFBSSxDQUFDTyxTQUFTSSxJQUFJLEVBQUU7WUFDbEIsT0FBT2pCLHFEQUFZQSxDQUFDTyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBaUIsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQ3RFO1FBRUFDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLG1CQUFtQixFQUFFRSxTQUFTSyxRQUFRLENBQUNDLE1BQU0sQ0FBQyxXQUFXLEVBQUVOLFNBQVNPLEtBQUssQ0FBQ0QsTUFBTSxDQUFDLE1BQU0sQ0FBQztRQUVyRyxxQ0FBcUM7UUFDckMsTUFBTUUsV0FBVyxNQUFNbkIsZ0ZBQWtCQSxDQUFDb0IsV0FBVyxDQUNuRFQsU0FBU0ssUUFBUSxFQUNqQkwsU0FBU08sS0FBSyxFQUNkZjtRQUdGSyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxzQkFBc0IsRUFBRU4sVUFBVTtRQUMvQyxPQUFPTCxxREFBWUEsQ0FBQ08sSUFBSSxDQUFDYztJQUUzQixFQUFFLE9BQU9iLE9BQU87UUFDZEUsUUFBUUYsS0FBSyxDQUFDLHVCQUF1QkE7UUFDckMsT0FBT1IscURBQVlBLENBQUNPLElBQUksQ0FDdEI7WUFBRUMsT0FBT0EsaUJBQWlCZSxRQUFRZixNQUFNZ0IsT0FBTyxHQUFHO1FBQWtCLEdBQ3BFO1lBQUVmLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJEOlxcY29kaW5nXFxsYXVuY2hcXHRob3VnaHRQb2xpY2VcXHNyY1xcYXBwXFxhcGlcXGFuYWx5emVcXHJvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHsgcmVkZGl0QXBpIH0gZnJvbSAnQC9saWIvc2VydmljZXMvcmVkZGl0QXBpJ1xyXG5pbXBvcnQgeyBtdWx0aU1vZGVsUGlwZWxpbmUgfSBmcm9tICdAL2xpYi9zZXJ2aWNlcy9tdWx0aU1vZGVsUGlwZWxpbmUnXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IHVzZXJuYW1lLCB2ZXJib3NlID0gZmFsc2UgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXHJcbiAgICBcclxuICAgIGlmICghdXNlcm5hbWUpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVc2VybmFtZSBpcyByZXF1aXJlZCcgfSwgeyBzdGF0dXM6IDQwMCB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKGBTdGFydGluZyBhbmFseXNpcyBmb3IgdXNlcjogJHt1c2VybmFtZX1gKVxyXG4gICAgXHJcbiAgICAvLyBTZXQgdmVyYm9zZSBtb2RlXHJcbiAgICBpZiAodmVyYm9zZSkge1xyXG4gICAgICByZWRkaXRBcGkuc2V0VmVyYm9zZSh0cnVlKVxyXG4gICAgICBtdWx0aU1vZGVsUGlwZWxpbmUuc2V0VmVyYm9zZSh0cnVlKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEZldGNoIHVzZXIgZGF0YSBzZXJ2ZXItc2lkZVxyXG4gICAgY29uc3QgdXNlckRhdGEgPSBhd2FpdCByZWRkaXRBcGkuZ2V0RnVsbFVzZXJEYXRhKHVzZXJuYW1lLCB7XHJcbiAgICAgIG1heEl0ZW1zOiA1MDAwLFxyXG4gICAgICBtYXhBZ2U6IDM2NSxcclxuICAgICAgdmVyYm9zZVxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAoIXVzZXJEYXRhLnVzZXIpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVc2VyIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKGBVc2VyIGRhdGEgZmV0Y2hlZDogJHt1c2VyRGF0YS5jb21tZW50cy5sZW5ndGh9IGNvbW1lbnRzLCAke3VzZXJEYXRhLnBvc3RzLmxlbmd0aH0gcG9zdHNgKVxyXG5cclxuICAgIC8vIEFuYWx5emUgdXNpbmcgcGlwZWxpbmUgc2VydmVyLXNpZGVcclxuICAgIGNvbnN0IGFuYWx5c2lzID0gYXdhaXQgbXVsdGlNb2RlbFBpcGVsaW5lLmFuYWx5emVVc2VyKFxyXG4gICAgICB1c2VyRGF0YS5jb21tZW50cyxcclxuICAgICAgdXNlckRhdGEucG9zdHMsXHJcbiAgICAgIHVzZXJuYW1lXHJcbiAgICApXHJcblxyXG4gICAgY29uc29sZS5sb2coYEFuYWx5c2lzIGNvbXBsZXRlIGZvciAke3VzZXJuYW1lfWApXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oYW5hbHlzaXMpXHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdBbmFseXNpcyBBUEkgZXJyb3I6JywgZXJyb3IpXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0FuYWx5c2lzIGZhaWxlZCcgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApXHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInJlZGRpdEFwaSIsIm11bHRpTW9kZWxQaXBlbGluZSIsIlBPU1QiLCJyZXF1ZXN0IiwidXNlcm5hbWUiLCJ2ZXJib3NlIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwiY29uc29sZSIsImxvZyIsInNldFZlcmJvc2UiLCJ1c2VyRGF0YSIsImdldEZ1bGxVc2VyRGF0YSIsIm1heEl0ZW1zIiwibWF4QWdlIiwidXNlciIsImNvbW1lbnRzIiwibGVuZ3RoIiwicG9zdHMiLCJhbmFseXNpcyIsImFuYWx5emVVc2VyIiwiRXJyb3IiLCJtZXNzYWdlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/analyze/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/cacheService.ts":
/*!******************************************!*\
  !*** ./src/lib/services/cacheService.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   cacheService: () => (/* binding */ cacheService)\n/* harmony export */ });\nclass CacheService {\n    constructor(){\n        this.cache = new Map();\n        this.DEFAULT_TTL = 7 * 24 * 60 * 60 * 1000 // 7 days\n        ;\n        this.CACHE_VERSION = '2.0';\n        this.MAX_CACHE_SIZE = 50;\n        this.hits = 0;\n        this.misses = 0;\n        this.isClient = \"undefined\" !== 'undefined';\n        // Only load from storage on client-side\n        if (this.isClient) {\n            this.loadFromStorage();\n            this.setupPeriodicCleanup();\n        }\n    }\n    loadFromStorage() {\n        if (!this.isClient) return;\n        try {\n            const stored = localStorage.getItem('thoughtPoliceCache');\n            if (stored) {\n                const data = JSON.parse(stored);\n                // Validate cache version\n                if (data.version !== this.CACHE_VERSION) {\n                    console.log('Cache version mismatch, clearing cache');\n                    this.clearAll();\n                    return;\n                }\n                // Load entries\n                if (data.entries) {\n                    for (const [key, entry] of Object.entries(data.entries)){\n                        this.cache.set(key, entry);\n                    }\n                }\n                console.log(`Loaded ${this.cache.size} cache entries from storage`);\n                this.cleanupExpired();\n            }\n        } catch (error) {\n            console.warn('Failed to load cache from storage:', error);\n            this.clearAll();\n        }\n    }\n    saveToStorage() {\n        if (!this.isClient) return;\n        const data = {\n            version: this.CACHE_VERSION,\n            entries: Object.fromEntries(this.cache.entries()),\n            lastSaved: Date.now()\n        };\n        try {\n            localStorage.setItem('thoughtPoliceCache', JSON.stringify(data));\n        } catch (error) {\n            console.warn('Failed to save cache to storage:', error);\n            // If storage is full, try to free up space\n            if (error instanceof Error && error.name === 'QuotaExceededError') {\n                this.evictOldest(Math.floor(this.cache.size / 2));\n                try {\n                    localStorage.setItem('thoughtPoliceCache', JSON.stringify(data));\n                } catch  {\n                    console.warn('Cache storage still full after eviction');\n                }\n            }\n        }\n    }\n    setupPeriodicCleanup() {\n        // Clean up expired entries every 10 minutes\n        setInterval(()=>{\n            this.cleanupExpired();\n        }, 10 * 60 * 1000);\n    }\n    generateContentHash(comments, posts) {\n        // Create a hash based on the latest content timestamps\n        const latestComment = comments.length > 0 ? Math.max(...comments.map((c)=>c.created_utc)) : 0;\n        const latestPost = posts.length > 0 ? Math.max(...posts.map((p)=>p.created_utc)) : 0;\n        const latest = Math.max(latestComment, latestPost);\n        // Include content count for additional validation\n        const contentSignature = `${latest}-${comments.length}-${posts.length}`;\n        // Simple hash function\n        let hash = 0;\n        for(let i = 0; i < contentSignature.length; i++){\n            const char = contentSignature.charCodeAt(i);\n            hash = (hash << 5) - hash + char;\n            hash = hash & hash; // Convert to 32-bit integer\n        }\n        return Math.abs(hash).toString(36);\n    }\n    getAnalysisKey(username, contentHash) {\n        return `analysis:${username.toLowerCase()}:${contentHash}`;\n    }\n    evictOldest(count) {\n        const entries = Array.from(this.cache.entries()).sort(([, a], [, b])=>a.timestamp - b.timestamp);\n        for(let i = 0; i < Math.min(count, entries.length); i++){\n            this.cache.delete(entries[i][0]);\n        }\n        console.log(`Evicted ${Math.min(count, entries.length)} oldest cache entries`);\n    }\n    cleanupExpired() {\n        const now = Date.now();\n        let cleanedCount = 0;\n        this.cache.forEach((entry, key)=>{\n            if (now > entry.expiresAt) {\n                this.cache.delete(key);\n                cleanedCount++;\n            }\n        });\n        if (cleanedCount > 0) {\n            console.log(`Cleaned up ${cleanedCount} expired cache entries`);\n            this.saveToStorage();\n        }\n    }\n    setAnalysis(username, data, comments = [], posts = [], ttl = this.DEFAULT_TTL) {\n        const contentHash = this.generateContentHash(comments, posts);\n        const key = this.getAnalysisKey(username, contentHash);\n        const entry = {\n            data,\n            timestamp: Date.now(),\n            expiresAt: Date.now() + ttl,\n            contentHash,\n            version: this.CACHE_VERSION\n        };\n        // Enforce cache size limit\n        if (this.cache.size >= this.MAX_CACHE_SIZE) {\n            this.evictOldest(1);\n        }\n        this.cache.set(key, entry);\n        console.log(`Cached analysis for user: ${username}, hash: ${contentHash}`);\n        this.saveToStorage();\n    }\n    getAnalysis(username, comments = [], posts = []) {\n        const contentHash = this.generateContentHash(comments, posts);\n        const key = this.getAnalysisKey(username, contentHash);\n        const entry = this.cache.get(key);\n        if (!entry) {\n            this.misses++;\n            return null;\n        }\n        if (Date.now() > entry.expiresAt) {\n            this.cache.delete(key);\n            this.misses++;\n            this.saveToStorage();\n            return null;\n        }\n        this.hits++;\n        return entry.data;\n    }\n    hasValidAnalysis(username, comments = [], posts = []) {\n        return this.getAnalysis(username, comments, posts) !== null;\n    }\n    clearAnalysis(username) {\n        const userKeys = Array.from(this.cache.keys()).filter((k)=>k.startsWith(`analysis:${username.toLowerCase()}:`));\n        userKeys.forEach((key)=>this.cache.delete(key));\n        console.log(`Cleared ${userKeys.length} cache entries for user: ${username}`);\n        this.saveToStorage();\n    }\n    clearAll() {\n        this.cache.clear();\n        this.hits = 0;\n        this.misses = 0;\n        console.log('Cleared all cached analyses');\n        this.saveToStorage();\n    }\n    getStats() {\n        const now = Date.now();\n        let validEntries = 0;\n        let expiredEntries = 0;\n        let totalSize = 0;\n        this.cache.forEach((entry)=>{\n            if (now <= entry.expiresAt) {\n                validEntries++;\n            } else {\n                expiredEntries++;\n            }\n            totalSize += JSON.stringify(entry).length;\n        });\n        const totalRequests = this.hits + this.misses;\n        const hitRate = totalRequests > 0 ? this.hits / totalRequests * 100 : 0;\n        return {\n            totalEntries: this.cache.size,\n            validEntries,\n            expiredEntries,\n            totalSize,\n            hitRate\n        };\n    }\n    getDebugInfo() {\n        const now = Date.now();\n        return Array.from(this.cache.entries()).map(([key, entry])=>{\n            const parts = key.split(':');\n            const username = parts[1] || 'unknown';\n            const contentHash = parts[2] || 'unknown';\n            const ageMs = now - entry.timestamp;\n            const age = ageMs < 60000 ? `${Math.round(ageMs / 1000)}s` : ageMs < 3600000 ? `${Math.round(ageMs / 60000)}m` : `${Math.round(ageMs / 3600000)}h`;\n            return {\n                key,\n                username,\n                contentHash,\n                age,\n                size: JSON.stringify(entry).length,\n                isExpired: now > entry.expiresAt\n            };\n        }).sort((a, b)=>a.username.localeCompare(b.username));\n    }\n}\nconst cacheService = new CacheService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFBUTVFLElBQUk2RSxLQUFLLENBQUM7WUFDeEIsTUFBTXBDLFdBQVdtQyxLQUFLLENBQUMsRUFBRSxJQUFJO1lBQzdCLE1BQU1sQyxjQUFja0MsS0FBSyxDQUFDLEVBQUUsSUFBSTtZQUNoQyxNQUFNRSxRQUFRbEUsTUFBTVgsTUFBTWlELFNBQVM7WUFDbkMsTUFBTTZCLE1BQU1ELFFBQVEsUUFBUSxHQUFHNUQsS0FBSzhELEtBQUssQ0FBQ0YsUUFBUSxNQUFNLENBQUMsQ0FBQyxHQUM5Q0EsUUFBUSxVQUFVLEdBQUc1RCxLQUFLOEQsS0FBSyxDQUFDRixRQUFRLE9BQU8sQ0FBQyxDQUFDLEdBQ2pELEdBQUc1RCxLQUFLOEQsS0FBSyxDQUFDRixRQUFRLFNBQVMsQ0FBQyxDQUFDO1lBRTdDLE9BQU87Z0JBQ0w5RTtnQkFDQXlDO2dCQUNBQztnQkFDQXFDO2dCQUNBM0UsTUFBTVgsS0FBS3FCLFNBQVMsQ0FBQ2IsT0FBT3dCLE1BQU07Z0JBQ2xDd0QsV0FBV3JFLE1BQU1YLE1BQU1zRCxTQUFTO1lBQ2xDO1FBQ0YsR0FBR1IsSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU1ELEVBQUVQLFFBQVEsQ0FBQ3lDLGFBQWEsQ0FBQ2pDLEVBQUVSLFFBQVE7SUFDdkQ7QUFDRjtBQUVPLE1BQU0wQyxlQUFlLElBQUkxRyxlQUFlIiwic291cmNlcyI6WyJEOlxcY29kaW5nXFxsYXVuY2hcXHRob3VnaHRQb2xpY2VcXHNyY1xcbGliXFxzZXJ2aWNlc1xcY2FjaGVTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImludGVyZmFjZSBDYWNoZUVudHJ5IHtcclxuICBkYXRhOiBhbnk7XHJcbiAgdGltZXN0YW1wOiBudW1iZXI7XHJcbiAgZXhwaXJlc0F0OiBudW1iZXI7XHJcbiAgY29udGVudEhhc2g6IHN0cmluZztcclxuICB2ZXJzaW9uOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBDYWNoZVN0YXRzIHtcclxuICB0b3RhbEVudHJpZXM6IG51bWJlcjtcclxuICB2YWxpZEVudHJpZXM6IG51bWJlcjtcclxuICBleHBpcmVkRW50cmllczogbnVtYmVyO1xyXG4gIHRvdGFsU2l6ZTogbnVtYmVyO1xyXG4gIGhpdFJhdGU6IG51bWJlcjtcclxufVxyXG5cclxuY2xhc3MgQ2FjaGVTZXJ2aWNlIHtcclxuICBwcml2YXRlIGNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIENhY2hlRW50cnk+KCk7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBERUZBVUxUX1RUTCA9IDcgKiAyNCAqIDYwICogNjAgKiAxMDAwOyAvLyA3IGRheXNcclxuICBwcml2YXRlIHJlYWRvbmx5IENBQ0hFX1ZFUlNJT04gPSAnMi4wJztcclxuICBwcml2YXRlIHJlYWRvbmx5IE1BWF9DQUNIRV9TSVpFID0gNTA7XHJcbiAgcHJpdmF0ZSBoaXRzID0gMDtcclxuICBwcml2YXRlIG1pc3NlcyA9IDA7XHJcbiAgcHJpdmF0ZSBpc0NsaWVudCA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIC8vIE9ubHkgbG9hZCBmcm9tIHN0b3JhZ2Ugb24gY2xpZW50LXNpZGVcclxuICAgIGlmICh0aGlzLmlzQ2xpZW50KSB7XHJcbiAgICAgIHRoaXMubG9hZEZyb21TdG9yYWdlKCk7XHJcbiAgICAgIHRoaXMuc2V0dXBQZXJpb2RpY0NsZWFudXAoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgbG9hZEZyb21TdG9yYWdlKCk6IHZvaWQge1xyXG4gICAgaWYgKCF0aGlzLmlzQ2xpZW50KSByZXR1cm47XHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHN0b3JlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0aG91Z2h0UG9saWNlQ2FjaGUnKTtcclxuICAgICAgaWYgKHN0b3JlZCkge1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHN0b3JlZCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVmFsaWRhdGUgY2FjaGUgdmVyc2lvblxyXG4gICAgICAgIGlmIChkYXRhLnZlcnNpb24gIT09IHRoaXMuQ0FDSEVfVkVSU0lPTikge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ0NhY2hlIHZlcnNpb24gbWlzbWF0Y2gsIGNsZWFyaW5nIGNhY2hlJyk7XHJcbiAgICAgICAgICB0aGlzLmNsZWFyQWxsKCk7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBMb2FkIGVudHJpZXNcclxuICAgICAgICBpZiAoZGF0YS5lbnRyaWVzKSB7XHJcbiAgICAgICAgICBmb3IgKGNvbnN0IFtrZXksIGVudHJ5XSBvZiBPYmplY3QuZW50cmllcyhkYXRhLmVudHJpZXMpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FjaGUuc2V0KGtleSwgZW50cnkgYXMgQ2FjaGVFbnRyeSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhgTG9hZGVkICR7dGhpcy5jYWNoZS5zaXplfSBjYWNoZSBlbnRyaWVzIGZyb20gc3RvcmFnZWApO1xyXG4gICAgICAgIHRoaXMuY2xlYW51cEV4cGlyZWQoKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9hZCBjYWNoZSBmcm9tIHN0b3JhZ2U6JywgZXJyb3IpO1xyXG4gICAgICB0aGlzLmNsZWFyQWxsKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNhdmVUb1N0b3JhZ2UoKTogdm9pZCB7XHJcbiAgICBpZiAoIXRoaXMuaXNDbGllbnQpIHJldHVybjtcclxuICAgIFxyXG4gICAgY29uc3QgZGF0YSA9IHtcclxuICAgICAgdmVyc2lvbjogdGhpcy5DQUNIRV9WRVJTSU9OLFxyXG4gICAgICBlbnRyaWVzOiBPYmplY3QuZnJvbUVudHJpZXModGhpcy5jYWNoZS5lbnRyaWVzKCkpLFxyXG4gICAgICBsYXN0U2F2ZWQ6IERhdGUubm93KClcclxuICAgIH07XHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0aG91Z2h0UG9saWNlQ2FjaGUnLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBzYXZlIGNhY2hlIHRvIHN0b3JhZ2U6JywgZXJyb3IpO1xyXG4gICAgICBcclxuICAgICAgLy8gSWYgc3RvcmFnZSBpcyBmdWxsLCB0cnkgdG8gZnJlZSB1cCBzcGFjZVxyXG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiBlcnJvci5uYW1lID09PSAnUXVvdGFFeGNlZWRlZEVycm9yJykge1xyXG4gICAgICAgIHRoaXMuZXZpY3RPbGRlc3QoTWF0aC5mbG9vcih0aGlzLmNhY2hlLnNpemUgLyAyKSk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0aG91Z2h0UG9saWNlQ2FjaGUnLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XHJcbiAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ0NhY2hlIHN0b3JhZ2Ugc3RpbGwgZnVsbCBhZnRlciBldmljdGlvbicpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzZXR1cFBlcmlvZGljQ2xlYW51cCgpOiB2b2lkIHtcclxuICAgIC8vIENsZWFuIHVwIGV4cGlyZWQgZW50cmllcyBldmVyeSAxMCBtaW51dGVzXHJcbiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgIHRoaXMuY2xlYW51cEV4cGlyZWQoKTtcclxuICAgIH0sIDEwICogNjAgKiAxMDAwKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2VuZXJhdGVDb250ZW50SGFzaChjb21tZW50czogYW55W10sIHBvc3RzOiBhbnlbXSk6IHN0cmluZyB7XHJcbiAgICAvLyBDcmVhdGUgYSBoYXNoIGJhc2VkIG9uIHRoZSBsYXRlc3QgY29udGVudCB0aW1lc3RhbXBzXHJcbiAgICBjb25zdCBsYXRlc3RDb21tZW50ID0gY29tbWVudHMubGVuZ3RoID4gMCA/IE1hdGgubWF4KC4uLmNvbW1lbnRzLm1hcChjID0+IGMuY3JlYXRlZF91dGMpKSA6IDA7XHJcbiAgICBjb25zdCBsYXRlc3RQb3N0ID0gcG9zdHMubGVuZ3RoID4gMCA/IE1hdGgubWF4KC4uLnBvc3RzLm1hcChwID0+IHAuY3JlYXRlZF91dGMpKSA6IDA7XHJcbiAgICBjb25zdCBsYXRlc3QgPSBNYXRoLm1heChsYXRlc3RDb21tZW50LCBsYXRlc3RQb3N0KTtcclxuICAgIFxyXG4gICAgLy8gSW5jbHVkZSBjb250ZW50IGNvdW50IGZvciBhZGRpdGlvbmFsIHZhbGlkYXRpb25cclxuICAgIGNvbnN0IGNvbnRlbnRTaWduYXR1cmUgPSBgJHtsYXRlc3R9LSR7Y29tbWVudHMubGVuZ3RofS0ke3Bvc3RzLmxlbmd0aH1gO1xyXG4gICAgXHJcbiAgICAvLyBTaW1wbGUgaGFzaCBmdW5jdGlvblxyXG4gICAgbGV0IGhhc2ggPSAwO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb250ZW50U2lnbmF0dXJlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGNoYXIgPSBjb250ZW50U2lnbmF0dXJlLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgLSBoYXNoKSArIGNoYXI7XHJcbiAgICAgIGhhc2ggPSBoYXNoICYgaGFzaDsgLy8gQ29udmVydCB0byAzMi1iaXQgaW50ZWdlclxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gTWF0aC5hYnMoaGFzaCkudG9TdHJpbmcoMzYpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRBbmFseXNpc0tleSh1c2VybmFtZTogc3RyaW5nLCBjb250ZW50SGFzaDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIHJldHVybiBgYW5hbHlzaXM6JHt1c2VybmFtZS50b0xvd2VyQ2FzZSgpfToke2NvbnRlbnRIYXNofWA7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGV2aWN0T2xkZXN0KGNvdW50OiBudW1iZXIpOiB2b2lkIHtcclxuICAgIGNvbnN0IGVudHJpZXMgPSBBcnJheS5mcm9tKHRoaXMuY2FjaGUuZW50cmllcygpKVxyXG4gICAgICAuc29ydCgoWyxhXSwgWyxiXSkgPT4gYS50aW1lc3RhbXAgLSBiLnRpbWVzdGFtcCk7XHJcbiAgICBcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5taW4oY291bnQsIGVudHJpZXMubGVuZ3RoKTsgaSsrKSB7XHJcbiAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGVudHJpZXNbaV1bMF0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgRXZpY3RlZCAke01hdGgubWluKGNvdW50LCBlbnRyaWVzLmxlbmd0aCl9IG9sZGVzdCBjYWNoZSBlbnRyaWVzYCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNsZWFudXBFeHBpcmVkKCk6IHZvaWQge1xyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgIGxldCBjbGVhbmVkQ291bnQgPSAwO1xyXG4gICAgXHJcbiAgICB0aGlzLmNhY2hlLmZvckVhY2goKGVudHJ5LCBrZXkpID0+IHtcclxuICAgICAgaWYgKG5vdyA+IGVudHJ5LmV4cGlyZXNBdCkge1xyXG4gICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgY2xlYW5lZENvdW50Kys7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBpZiAoY2xlYW5lZENvdW50ID4gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgQ2xlYW5lZCB1cCAke2NsZWFuZWRDb3VudH0gZXhwaXJlZCBjYWNoZSBlbnRyaWVzYCk7XHJcbiAgICAgIHRoaXMuc2F2ZVRvU3RvcmFnZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0QW5hbHlzaXModXNlcm5hbWU6IHN0cmluZywgZGF0YTogYW55LCBjb21tZW50czogYW55W10gPSBbXSwgcG9zdHM6IGFueVtdID0gW10sIHR0bDogbnVtYmVyID0gdGhpcy5ERUZBVUxUX1RUTCk6IHZvaWQge1xyXG4gICAgY29uc3QgY29udGVudEhhc2ggPSB0aGlzLmdlbmVyYXRlQ29udGVudEhhc2goY29tbWVudHMsIHBvc3RzKTtcclxuICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0QW5hbHlzaXNLZXkodXNlcm5hbWUsIGNvbnRlbnRIYXNoKTtcclxuICAgIFxyXG4gICAgY29uc3QgZW50cnk6IENhY2hlRW50cnkgPSB7XHJcbiAgICAgIGRhdGEsXHJcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcclxuICAgICAgZXhwaXJlc0F0OiBEYXRlLm5vdygpICsgdHRsLFxyXG4gICAgICBjb250ZW50SGFzaCxcclxuICAgICAgdmVyc2lvbjogdGhpcy5DQUNIRV9WRVJTSU9OXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAvLyBFbmZvcmNlIGNhY2hlIHNpemUgbGltaXRcclxuICAgIGlmICh0aGlzLmNhY2hlLnNpemUgPj0gdGhpcy5NQVhfQ0FDSEVfU0laRSkge1xyXG4gICAgICB0aGlzLmV2aWN0T2xkZXN0KDEpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0aGlzLmNhY2hlLnNldChrZXksIGVudHJ5KTtcclxuICAgIGNvbnNvbGUubG9nKGBDYWNoZWQgYW5hbHlzaXMgZm9yIHVzZXI6ICR7dXNlcm5hbWV9LCBoYXNoOiAke2NvbnRlbnRIYXNofWApO1xyXG4gICAgXHJcbiAgICB0aGlzLnNhdmVUb1N0b3JhZ2UoKTtcclxuICB9XHJcblxyXG4gIGdldEFuYWx5c2lzKHVzZXJuYW1lOiBzdHJpbmcsIGNvbW1lbnRzOiBhbnlbXSA9IFtdLCBwb3N0czogYW55W10gPSBbXSk6IGFueSB8IG51bGwge1xyXG4gICAgY29uc3QgY29udGVudEhhc2ggPSB0aGlzLmdlbmVyYXRlQ29udGVudEhhc2goY29tbWVudHMsIHBvc3RzKTtcclxuICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0QW5hbHlzaXNLZXkodXNlcm5hbWUsIGNvbnRlbnRIYXNoKTtcclxuICAgIGNvbnN0IGVudHJ5ID0gdGhpcy5jYWNoZS5nZXQoa2V5KTtcclxuICAgIFxyXG4gICAgaWYgKCFlbnRyeSkge1xyXG4gICAgICB0aGlzLm1pc3NlcysrO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKERhdGUubm93KCkgPiBlbnRyeS5leHBpcmVzQXQpIHtcclxuICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcclxuICAgICAgdGhpcy5taXNzZXMrKztcclxuICAgICAgdGhpcy5zYXZlVG9TdG9yYWdlKCk7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0aGlzLmhpdHMrKztcclxuICAgIHJldHVybiBlbnRyeS5kYXRhO1xyXG4gIH1cclxuXHJcbiAgaGFzVmFsaWRBbmFseXNpcyh1c2VybmFtZTogc3RyaW5nLCBjb21tZW50czogYW55W10gPSBbXSwgcG9zdHM6IGFueVtdID0gW10pOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmdldEFuYWx5c2lzKHVzZXJuYW1lLCBjb21tZW50cywgcG9zdHMpICE9PSBudWxsO1xyXG4gIH1cclxuXHJcbiAgY2xlYXJBbmFseXNpcyh1c2VybmFtZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBjb25zdCB1c2VyS2V5cyA9IEFycmF5LmZyb20odGhpcy5jYWNoZS5rZXlzKCkpLmZpbHRlcihrID0+IFxyXG4gICAgICBrLnN0YXJ0c1dpdGgoYGFuYWx5c2lzOiR7dXNlcm5hbWUudG9Mb3dlckNhc2UoKX06YClcclxuICAgICk7XHJcbiAgICBcclxuICAgIHVzZXJLZXlzLmZvckVhY2goa2V5ID0+IHRoaXMuY2FjaGUuZGVsZXRlKGtleSkpO1xyXG4gICAgY29uc29sZS5sb2coYENsZWFyZWQgJHt1c2VyS2V5cy5sZW5ndGh9IGNhY2hlIGVudHJpZXMgZm9yIHVzZXI6ICR7dXNlcm5hbWV9YCk7XHJcbiAgICB0aGlzLnNhdmVUb1N0b3JhZ2UoKTtcclxuICB9XHJcblxyXG4gIGNsZWFyQWxsKCk6IHZvaWQge1xyXG4gICAgdGhpcy5jYWNoZS5jbGVhcigpO1xyXG4gICAgdGhpcy5oaXRzID0gMDtcclxuICAgIHRoaXMubWlzc2VzID0gMDtcclxuICAgIGNvbnNvbGUubG9nKCdDbGVhcmVkIGFsbCBjYWNoZWQgYW5hbHlzZXMnKTtcclxuICAgIHRoaXMuc2F2ZVRvU3RvcmFnZSgpO1xyXG4gIH1cclxuXHJcbiAgZ2V0U3RhdHMoKTogQ2FjaGVTdGF0cyB7XHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgbGV0IHZhbGlkRW50cmllcyA9IDA7XHJcbiAgICBsZXQgZXhwaXJlZEVudHJpZXMgPSAwO1xyXG4gICAgbGV0IHRvdGFsU2l6ZSA9IDA7XHJcbiAgICBcclxuICAgIHRoaXMuY2FjaGUuZm9yRWFjaChlbnRyeSA9PiB7XHJcbiAgICAgIGlmIChub3cgPD0gZW50cnkuZXhwaXJlc0F0KSB7XHJcbiAgICAgICAgdmFsaWRFbnRyaWVzKys7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZXhwaXJlZEVudHJpZXMrKztcclxuICAgICAgfVxyXG4gICAgICB0b3RhbFNpemUgKz0gSlNPTi5zdHJpbmdpZnkoZW50cnkpLmxlbmd0aDtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBjb25zdCB0b3RhbFJlcXVlc3RzID0gdGhpcy5oaXRzICsgdGhpcy5taXNzZXM7XHJcbiAgICBjb25zdCBoaXRSYXRlID0gdG90YWxSZXF1ZXN0cyA+IDAgPyAodGhpcy5oaXRzIC8gdG90YWxSZXF1ZXN0cykgKiAxMDAgOiAwO1xyXG4gICAgXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB0b3RhbEVudHJpZXM6IHRoaXMuY2FjaGUuc2l6ZSxcclxuICAgICAgdmFsaWRFbnRyaWVzLFxyXG4gICAgICBleHBpcmVkRW50cmllcyxcclxuICAgICAgdG90YWxTaXplLFxyXG4gICAgICBoaXRSYXRlXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgZ2V0RGVidWdJbmZvKCk6IEFycmF5PHtcclxuICAgIGtleTogc3RyaW5nO1xyXG4gICAgdXNlcm5hbWU6IHN0cmluZztcclxuICAgIGNvbnRlbnRIYXNoOiBzdHJpbmc7XHJcbiAgICBhZ2U6IHN0cmluZztcclxuICAgIHNpemU6IG51bWJlcjtcclxuICAgIGlzRXhwaXJlZDogYm9vbGVhbjtcclxuICB9PiB7XHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmNhY2hlLmVudHJpZXMoKSkubWFwKChba2V5LCBlbnRyeV0pID0+IHtcclxuICAgICAgY29uc3QgcGFydHMgPSBrZXkuc3BsaXQoJzonKTtcclxuICAgICAgY29uc3QgdXNlcm5hbWUgPSBwYXJ0c1sxXSB8fCAndW5rbm93bic7XHJcbiAgICAgIGNvbnN0IGNvbnRlbnRIYXNoID0gcGFydHNbMl0gfHwgJ3Vua25vd24nO1xyXG4gICAgICBjb25zdCBhZ2VNcyA9IG5vdyAtIGVudHJ5LnRpbWVzdGFtcDtcclxuICAgICAgY29uc3QgYWdlID0gYWdlTXMgPCA2MDAwMCA/IGAke01hdGgucm91bmQoYWdlTXMgLyAxMDAwKX1zYCA6XHJcbiAgICAgICAgICAgICAgICAgIGFnZU1zIDwgMzYwMDAwMCA/IGAke01hdGgucm91bmQoYWdlTXMgLyA2MDAwMCl9bWAgOlxyXG4gICAgICAgICAgICAgICAgICBgJHtNYXRoLnJvdW5kKGFnZU1zIC8gMzYwMDAwMCl9aGA7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGtleSxcclxuICAgICAgICB1c2VybmFtZSxcclxuICAgICAgICBjb250ZW50SGFzaCxcclxuICAgICAgICBhZ2UsXHJcbiAgICAgICAgc2l6ZTogSlNPTi5zdHJpbmdpZnkoZW50cnkpLmxlbmd0aCxcclxuICAgICAgICBpc0V4cGlyZWQ6IG5vdyA+IGVudHJ5LmV4cGlyZXNBdFxyXG4gICAgICB9O1xyXG4gICAgfSkuc29ydCgoYSwgYikgPT4gYS51c2VybmFtZS5sb2NhbGVDb21wYXJlKGIudXNlcm5hbWUpKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjYWNoZVNlcnZpY2UgPSBuZXcgQ2FjaGVTZXJ2aWNlKCk7Il0sIm5hbWVzIjpbIkNhY2hlU2VydmljZSIsImNvbnN0cnVjdG9yIiwiY2FjaGUiLCJNYXAiLCJERUZBVUxUX1RUTCIsIkNBQ0hFX1ZFUlNJT04iLCJNQVhfQ0FDSEVfU0laRSIsImhpdHMiLCJtaXNzZXMiLCJpc0NsaWVudCIsImxvYWRGcm9tU3RvcmFnZSIsInNldHVwUGVyaW9kaWNDbGVhbnVwIiwic3RvcmVkIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImRhdGEiLCJKU09OIiwicGFyc2UiLCJ2ZXJzaW9uIiwiY29uc29sZSIsImxvZyIsImNsZWFyQWxsIiwiZW50cmllcyIsImtleSIsImVudHJ5IiwiT2JqZWN0Iiwic2V0Iiwic2l6ZSIsImNsZWFudXBFeHBpcmVkIiwiZXJyb3IiLCJ3YXJuIiwic2F2ZVRvU3RvcmFnZSIsImZyb21FbnRyaWVzIiwibGFzdFNhdmVkIiwiRGF0ZSIsIm5vdyIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJFcnJvciIsIm5hbWUiLCJldmljdE9sZGVzdCIsIk1hdGgiLCJmbG9vciIsInNldEludGVydmFsIiwiZ2VuZXJhdGVDb250ZW50SGFzaCIsImNvbW1lbnRzIiwicG9zdHMiLCJsYXRlc3RDb21tZW50IiwibGVuZ3RoIiwibWF4IiwibWFwIiwiYyIsImNyZWF0ZWRfdXRjIiwibGF0ZXN0UG9zdCIsInAiLCJsYXRlc3QiLCJjb250ZW50U2lnbmF0dXJlIiwiaGFzaCIsImkiLCJjaGFyIiwiY2hhckNvZGVBdCIsImFicyIsInRvU3RyaW5nIiwiZ2V0QW5hbHlzaXNLZXkiLCJ1c2VybmFtZSIsImNvbnRlbnRIYXNoIiwidG9Mb3dlckNhc2UiLCJjb3VudCIsIkFycmF5IiwiZnJvbSIsInNvcnQiLCJhIiwiYiIsInRpbWVzdGFtcCIsIm1pbiIsImRlbGV0ZSIsImNsZWFuZWRDb3VudCIsImZvckVhY2giLCJleHBpcmVzQXQiLCJzZXRBbmFseXNpcyIsInR0bCIsImdldEFuYWx5c2lzIiwiZ2V0IiwiaGFzVmFsaWRBbmFseXNpcyIsImNsZWFyQW5hbHlzaXMiLCJ1c2VyS2V5cyIsImtleXMiLCJmaWx0ZXIiLCJrIiwic3RhcnRzV2l0aCIsImNsZWFyIiwiZ2V0U3RhdHMiLCJ2YWxpZEVudHJpZXMiLCJleHBpcmVkRW50cmllcyIsInRvdGFsU2l6ZSIsInRvdGFsUmVxdWVzdHMiLCJoaXRSYXRlIiwidG90YWxFbnRyaWVzIiwiZ2V0RGVidWdJbmZvIiwicGFydHMiLCJzcGxpdCIsImFnZU1zIiwiYWdlIiwicm91bmQiLCJpc0V4cGlyZWQiLCJsb2NhbGVDb21wYXJlIiwiY2FjaGVTZXJ2aWNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/cacheService.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/multiModelPipeline.ts":
/*!************************************************!*\
  !*** ./src/lib/services/multiModelPipeline.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   multiModelPipeline: () => (/* binding */ multiModelPipeline)\n/* harmony export */ });\n/* harmony import */ var _cacheService__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cacheService */ \"(rsc)/./src/lib/services/cacheService.ts\");\n/* harmony import */ var _tokenBudget__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tokenBudget */ \"(rsc)/./src/lib/services/tokenBudget.ts\");\n\n\nclass MultiModelPipeline {\n    constructor(){\n        this.apiKey = null;\n        this.baseUrl = 'https://openrouter.ai/api/v1/chat/completions';\n        this.isAvailable = false;\n        this.verbose = false;\n        // Optimized model selection - single strong model for summarization\n        this.summarizerModel = 'openrouter/cypher-alpha:free';\n        this.contradictionModel = 'openrouter/cypher-alpha:free';\n        // Fallback to stronger models if budget allows\n        this.premiumSummarizerModel = 'openrouter/cypher-alpha:free';\n        this.premiumContradictionModel = 'openrouter/cypher-alpha:free';\n        try {\n            this.apiKey = process.env.OPENROUTER_API_KEY;\n            if (!this.apiKey) {\n                console.warn('OpenRouter API key not found - using fallback analysis');\n                this.isAvailable = false;\n                return;\n            }\n            this.isAvailable = true;\n            this.debug('Multi-Model Pipeline initialized with optimized models');\n        } catch (error) {\n            console.warn('Failed to initialize Multi-Model Pipeline:', error);\n            this.isAvailable = false;\n        }\n    }\n    setVerbose(verbose) {\n        this.verbose = verbose;\n    }\n    debug(...args) {\n        if (this.verbose) {\n            console.log('[Pipeline]', ...args);\n        }\n    }\n    async analyzeUser(comments, posts, username) {\n        try {\n            this.debug(`Starting optimized pipeline analysis for ${username}: ${comments.length} comments, ${posts.length} posts`);\n            // Check cache first with content validation\n            const cachedResult = _cacheService__WEBPACK_IMPORTED_MODULE_0__.cacheService.getAnalysis(username, comments, posts);\n            if (cachedResult) {\n                this.debug(`Returning cached analysis for ${username}`);\n                return cachedResult;\n            }\n            // Convert and deduplicate all content\n            const allComments = this.convertAndDeduplicateComments(comments, posts);\n            this.debug(`Processing ${allComments.length} unique items (after deduplication)`);\n            if (allComments.length === 0) {\n                return this.createEmptyReport(username);\n            }\n            // Check budget before proceeding\n            const budgetStatus = _tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.getBudgetStatus();\n            if (budgetStatus.isExceeded) {\n                this.debug('Budget exceeded, using fallback analysis');\n                return this.createFallbackReport(allComments, username);\n            }\n            // Optimized 2-stage pipeline: Summarize → Analyze Contradictions\n            const summaries = await this.optimizedSummarization(allComments);\n            this.debug(`Generated ${summaries.length} summaries`);\n            const contradictions = await this.analyzeContradictions(summaries);\n            this.debug(`Found ${contradictions.length} contradictions`);\n            // Generate comprehensive report\n            const report = this.generateReport(allComments, summaries, contradictions, username);\n            // Cache the result with content hash\n            _cacheService__WEBPACK_IMPORTED_MODULE_0__.cacheService.setAnalysis(username, report, comments, posts);\n            return report;\n        } catch (error) {\n            console.error('Multi-model pipeline error:', error);\n            return this.createErrorReport(username, error);\n        }\n    }\n    convertAndDeduplicateComments(comments, posts) {\n        const allItems = [];\n        let idCounter = 1;\n        // Process comments\n        comments.forEach((comment)=>{\n            if (comment.body && comment.body !== '[deleted]' && comment.body !== '[removed]' && comment.body.length > 20) {\n                allItems.push({\n                    id: `ID-${idCounter++}`,\n                    text: comment.body,\n                    date: comment.created_utc,\n                    subreddit: comment.subreddit,\n                    score: comment.score,\n                    permalink: comment.permalink,\n                    type: 'comment',\n                    context: comment.link_title\n                });\n            }\n        });\n        // Process posts\n        posts.forEach((post)=>{\n            if (post.selftext && post.selftext !== '[deleted]' && post.selftext !== '[removed]' && post.selftext.length > 20) {\n                const fullText = `${post.title} ${post.selftext}`.trim();\n                allItems.push({\n                    id: `ID-${idCounter++}`,\n                    text: fullText,\n                    date: post.created_utc,\n                    subreddit: post.subreddit,\n                    score: post.score,\n                    permalink: post.permalink,\n                    type: 'post'\n                });\n            }\n        });\n        // Enhanced deduplication with clustering\n        const deduplicated = this.smartDeduplication(allItems);\n        this.debug(`Deduplicated from ${allItems.length} to ${deduplicated.length} items`);\n        // Sort by date (oldest first) for temporal analysis\n        return deduplicated.sort((a, b)=>a.date - b.date);\n    }\n    smartDeduplication(items) {\n        const clusters = new Map();\n        // Group similar content\n        for (const item of items){\n            const signature = this.createContentSignature(item.text);\n            if (!clusters.has(signature)) {\n                clusters.set(signature, []);\n            }\n            clusters.get(signature).push(item);\n        }\n        // Select best representative from each cluster\n        const deduplicated = [];\n        for (const cluster of clusters.values()){\n            if (cluster.length === 1) {\n                deduplicated.push(cluster[0]);\n            } else {\n                // Choose the highest scored or most recent item from cluster\n                const best = cluster.reduce((best, current)=>{\n                    if (current.score > best.score) return current;\n                    if (current.score === best.score && current.date > best.date) return current;\n                    return best;\n                });\n                deduplicated.push(best);\n            }\n        }\n        return deduplicated;\n    }\n    createContentSignature(text) {\n        // Create a signature for clustering similar content\n        const normalized = text.toLowerCase().replace(/[^\\w\\s]/g, ' ').replace(/\\s+/g, ' ').trim();\n        // Use first 100 characters as signature\n        return normalized.substring(0, 100);\n    }\n    async optimizedSummarization(comments) {\n        if (!this.isAvailable) {\n            return this.createFallbackSummaries(comments);\n        }\n        // Dynamic batch sizing based on token limits\n        const maxTokensPerBatch = 3000; // Conservative limit\n        const batches = this.createDynamicBatches(comments, maxTokensPerBatch);\n        this.debug(`Created ${batches.length} dynamic batches for summarization`);\n        const allSummaries = [];\n        // Choose model based on budget\n        const budgetStatus = _tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.getBudgetStatus();\n        const useModel = budgetStatus.remaining > 1.0 ? this.premiumSummarizerModel : this.summarizerModel;\n        for(let i = 0; i < batches.length; i++){\n            const batch = batches[i];\n            try {\n                this.debug(`Summarizing batch ${i + 1}/${batches.length} with ${useModel} (${batch.length} items)`);\n                // Check if we can afford this request\n                const prompt = this.buildOptimizedSummarizationPrompt(batch);\n                const estimatedTokens = _tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.estimateTokens(prompt);\n                if (!_tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.canAfford(useModel, estimatedTokens)) {\n                    this.debug('Budget insufficient, switching to fallback');\n                    const fallbackSummaries = this.createFallbackSummaries(batch);\n                    allSummaries.push(...fallbackSummaries);\n                    continue;\n                }\n                const batchSummaries = await this.summarizeBatch(batch, useModel);\n                allSummaries.push(...batchSummaries);\n                // Rate limiting\n                if (i < batches.length - 1) {\n                    await new Promise((resolve)=>setTimeout(resolve, 2000));\n                }\n            } catch (error) {\n                this.debug(`Batch ${i + 1} summarization failed:`, error);\n                const fallbackSummaries = this.createFallbackSummaries(batch);\n                allSummaries.push(...fallbackSummaries);\n            }\n        }\n        return allSummaries;\n    }\n    createDynamicBatches(comments, maxTokensPerBatch) {\n        const batches = [];\n        let currentBatch = [];\n        let currentTokens = 0;\n        for (const comment of comments){\n            const commentTokens = _tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.estimateTokens(comment.text);\n            // If adding this comment would exceed the limit, start a new batch\n            if (currentTokens + commentTokens > maxTokensPerBatch && currentBatch.length > 0) {\n                batches.push(currentBatch);\n                currentBatch = [\n                    comment\n                ];\n                currentTokens = commentTokens;\n            } else {\n                currentBatch.push(comment);\n                currentTokens += commentTokens;\n            }\n        }\n        // Add the last batch if it has content\n        if (currentBatch.length > 0) {\n            batches.push(currentBatch);\n        }\n        return batches;\n    }\n    buildOptimizedSummarizationPrompt(batch) {\n        const commentsText = batch.map((comment)=>{\n            const dateStr = new Date(comment.date * 1000).toLocaleDateString();\n            return `${comment.id} (r/${comment.subreddit}, ${dateStr}): \"${comment.text.substring(0, 500)}\"`;\n        }).join('\\n\\n');\n        return `You are an expert content analyzer specializing in detecting ideological inconsistencies and opinion changes in social media content.\n\nTASK: Summarize each comment below into a concise statement that preserves:\n- Core beliefs and opinions\n- Emotional tone and intensity  \n- Political/ideological stance\n- Sentiment (positive/negative/neutral)\n\nCRITICAL: Focus on extracting viewpoints that could potentially contradict other statements. Include context clues about the user's stance on topics.\n\nComments to analyze:\n${commentsText}\n\nOUTPUT FORMAT (one line per comment):\nID-X: [Concise summary preserving beliefs, tone, and stance]\n\nEXAMPLES:\nID-32: Strongly supports gun rights, believes self-defense is fundamental (passionate, libertarian stance)\nID-33: Advocates for strict gun control, calls for assault weapon bans (emotional, progressive stance)\nID-34: Dismisses climate change concerns as overblown media hype (skeptical, conservative tone)\n\nAnalyze each comment now:`;\n    }\n    async summarizeBatch(batch, model) {\n        const prompt = this.buildOptimizedSummarizationPrompt(batch);\n        try {\n            const response = await this.makeOpenRouterRequest(model, prompt);\n            return this.parseSummarizationResponse(response, batch);\n        } catch (error) {\n            this.debug(`Summarization failed for model ${model}:`, error);\n            return this.createFallbackSummaries(batch);\n        }\n    }\n    async analyzeContradictions(summaries) {\n        if (!this.isAvailable || summaries.length < 2) {\n            return this.createFallbackContradictions(summaries);\n        }\n        try {\n            this.debug(`Analyzing contradictions from ${summaries.length} summaries`);\n            // Choose model based on budget\n            const budgetStatus = _tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.getBudgetStatus();\n            const useModel = budgetStatus.remaining > 0.5 ? this.premiumContradictionModel : this.contradictionModel;\n            const prompt = this.buildOptimizedContradictionPrompt(summaries);\n            const estimatedTokens = _tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.estimateTokens(prompt);\n            if (!_tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.canAfford(useModel, estimatedTokens)) {\n                this.debug('Budget insufficient for contradiction analysis, using fallback');\n                return this.createFallbackContradictions(summaries);\n            }\n            const response = await this.makeOpenRouterRequest(useModel, prompt);\n            return this.parseContradictionResponse(response, summaries);\n        } catch (error) {\n            this.debug('Contradiction analysis failed:', error);\n            return this.createFallbackContradictions(summaries);\n        }\n    }\n    buildOptimizedContradictionPrompt(summaries) {\n        const summariesText = summaries.map((s)=>`${s.id}: ${s.summary}`).join('\\n');\n        return `You are an expert at detecting ideological inconsistencies and contradictory viewpoints in user-generated content.\n\nTASK: Identify genuine contradictions between these summarized statements. Focus on:\n- Direct opposing viewpoints on the same topic\n- Ideological flip-flops without reasonable explanation  \n- Contradictory moral or ethical positions\n- Inconsistent political stances\n\nIGNORE:\n- Normal opinion evolution over long periods\n- Different contexts (serious vs casual discussions)\n- Sarcasm vs genuine statements\n- Hypothetical scenarios vs real opinions\n\nSummaries to analyze:\n${summariesText}\n\nOUTPUT FORMAT:\nContradiction between ID-X and ID-Y: [Specific description of the contradiction and why it's significant]\n\nIf no genuine contradictions found, respond with: \"No contradictions detected.\"\n\nAnalyze with high standards for what constitutes a real contradiction:`;\n    }\n    async makeOpenRouterRequest(model, prompt) {\n        if (!this.apiKey) {\n            throw new Error('API key not available');\n        }\n        const inputTokens = _tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.estimateTokens(prompt);\n        const maxOutputTokens = 1500;\n        const response = await fetch(this.baseUrl, {\n            method: 'POST',\n            headers: {\n                'Authorization': `Bearer ${this.apiKey}`,\n                'Content-Type': 'application/json',\n                'HTTP-Referer':  false ? 0 : 'http://localhost:3000',\n                'X-Title': 'Thought Police - Optimized Pipeline'\n            },\n            body: JSON.stringify({\n                model,\n                messages: [\n                    {\n                        role: 'user',\n                        content: prompt\n                    }\n                ],\n                temperature: 0.1,\n                max_tokens: maxOutputTokens,\n                top_p: 0.9\n            })\n        });\n        if (!response.ok) {\n            const errorData = await response.json().catch(()=>({}));\n            throw new Error(`OpenRouter API error: ${response.status} ${response.statusText} - ${JSON.stringify(errorData)}`);\n        }\n        const data = await response.json();\n        const responseText = data.choices[0]?.message?.content || '';\n        // Record token usage\n        const outputTokens = _tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.estimateTokens(responseText);\n        _tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.recordUsage(model, inputTokens, outputTokens);\n        return responseText;\n    }\n    parseSummarizationResponse(response, batch) {\n        const summaries = [];\n        const lines = response.split('\\n').filter((line)=>line.trim());\n        for (const line of lines){\n            const match = line.match(/^(ID-\\d+):\\s*(.+)$/);\n            if (match) {\n                const [, id, summary] = match;\n                const originalComment = batch.find((c)=>c.id === id);\n                if (originalComment) {\n                    summaries.push({\n                        id,\n                        summary: summary.trim(),\n                        originalComment\n                    });\n                }\n            }\n        }\n        // Add fallback summaries for missing items\n        const missingComments = batch.filter((comment)=>!summaries.some((summary)=>summary.id === comment.id));\n        if (missingComments.length > 0) {\n            this.debug(`${missingComments.length} summaries missing from AI response, adding fallbacks`);\n            const fallbackSummaries = this.createFallbackSummaries(missingComments);\n            summaries.push(...fallbackSummaries);\n        }\n        return summaries;\n    }\n    parseContradictionResponse(response, summaries) {\n        const contradictions = [];\n        const lines = response.split('\\n').filter((line)=>line.trim());\n        for (const line of lines){\n            const match = line.match(/^Contradiction between (ID-\\d+) and (ID-\\d+):\\s*(.+)$/);\n            if (match) {\n                const [, id1, id2, description] = match;\n                const summary1 = summaries.find((s)=>s.id === id1);\n                const summary2 = summaries.find((s)=>s.id === id2);\n                if (summary1 && summary2) {\n                    const confidence = this.calculateContradictionConfidence(summary1, summary2, description);\n                    contradictions.push({\n                        id1,\n                        id2,\n                        description: description.trim(),\n                        confidence,\n                        category: this.detectCategory(description)\n                    });\n                }\n            }\n        }\n        return contradictions.sort((a, b)=>b.confidence - a.confidence).slice(0, 12); // Limit to most significant\n    }\n    calculateContradictionConfidence(summary1, summary2, description) {\n        let confidence = 80; // Base confidence for AI-detected contradictions\n        // Time-based adjustments\n        const timeDiff = Math.abs(summary2.originalComment.date - summary1.originalComment.date);\n        const daysDiff = timeDiff / (24 * 60 * 60);\n        if (daysDiff < 1) {\n            confidence -= 25; // Same day might be contextual\n        } else if (daysDiff < 7) {\n            confidence -= 15; // Same week might be related\n        } else if (daysDiff > 365) {\n            confidence -= 10; // Very old might be opinion evolution\n        }\n        // Content-based adjustments\n        const strongOpposition = [\n            'completely opposite',\n            'directly contradicts',\n            'total reversal',\n            'flip-flop'\n        ];\n        if (strongOpposition.some((phrase)=>description.toLowerCase().includes(phrase))) {\n            confidence += 15;\n        }\n        // Context adjustments\n        if (summary1.originalComment.subreddit !== summary2.originalComment.subreddit) {\n            const contextualSubs = [\n                'circlejerk',\n                'satire',\n                'jokes',\n                'memes'\n            ];\n            if (contextualSubs.some((sub)=>summary1.originalComment.subreddit.toLowerCase().includes(sub) || summary2.originalComment.subreddit.toLowerCase().includes(sub))) {\n                confidence -= 20; // Likely satirical context\n            } else {\n                confidence -= 5; // Different contexts\n            }\n        }\n        return Math.max(50, Math.min(95, confidence));\n    }\n    createFallbackSummaries(comments) {\n        return comments.map((comment)=>({\n                id: comment.id,\n                summary: this.createEnhancedSummary(comment),\n                originalComment: comment\n            }));\n    }\n    createEnhancedSummary(comment) {\n        const text = comment.text;\n        const truncated = text.length > 200 ? text.substring(0, 200) + '...' : text;\n        const sentiment = this.detectAdvancedSentiment(text);\n        const stance = this.detectStance(text);\n        const intensity = this.detectIntensity(text);\n        return `${truncated} (${sentiment} sentiment, ${stance} stance, ${intensity} intensity)`;\n    }\n    detectAdvancedSentiment(text) {\n        const positive = [\n            'good',\n            'great',\n            'love',\n            'like',\n            'amazing',\n            'awesome',\n            'excellent',\n            'fantastic',\n            'wonderful',\n            'support'\n        ];\n        const negative = [\n            'bad',\n            'hate',\n            'terrible',\n            'awful',\n            'horrible',\n            'worst',\n            'sucks',\n            'disgusting',\n            'pathetic',\n            'oppose'\n        ];\n        const lower = text.toLowerCase();\n        const posCount = positive.filter((word)=>lower.includes(word)).length;\n        const negCount = negative.filter((word)=>lower.includes(word)).length;\n        if (posCount > negCount + 1) return 'positive';\n        if (negCount > posCount + 1) return 'negative';\n        return 'neutral';\n    }\n    detectStance(text) {\n        const lower = text.toLowerCase();\n        if (lower.includes('strongly') || lower.includes('absolutely') || lower.includes('definitely')) return 'strong';\n        if (lower.includes('maybe') || lower.includes('perhaps') || lower.includes('might')) return 'tentative';\n        if (lower.includes('always') || lower.includes('never') || lower.includes('completely')) return 'absolute';\n        return 'moderate';\n    }\n    detectIntensity(text) {\n        const intensifiers = [\n            'very',\n            'extremely',\n            'absolutely',\n            'completely',\n            'totally',\n            'really',\n            'so much'\n        ];\n        const lower = text.toLowerCase();\n        const intensifierCount = intensifiers.filter((word)=>lower.includes(word)).length;\n        if (intensifierCount > 2 || text.includes('!!!') || /[A-Z]{3,}/.test(text)) return 'high';\n        if (intensifierCount > 0 || text.includes('!!')) return 'medium';\n        return 'low';\n    }\n    createFallbackContradictions(summaries) {\n        const contradictions = [];\n        // Enhanced semantic contradiction detection\n        for(let i = 0; i < summaries.length; i++){\n            for(let j = i + 1; j < summaries.length; j++){\n                const summary1 = summaries[i];\n                const summary2 = summaries[j];\n                // Skip if same context and close in time\n                const timeDiff = Math.abs(summary2.originalComment.date - summary1.originalComment.date);\n                const daysDiff = timeDiff / (24 * 60 * 60);\n                if (summary1.originalComment.subreddit === summary2.originalComment.subreddit && daysDiff < 1) {\n                    continue;\n                }\n                const contradictionType = this.detectSemanticContradiction(summary1.summary, summary2.summary);\n                if (contradictionType) {\n                    contradictions.push({\n                        id1: summary1.id,\n                        id2: summary2.id,\n                        description: `${contradictionType.description} (enhanced fallback analysis)`,\n                        confidence: contradictionType.confidence,\n                        category: contradictionType.category\n                    });\n                }\n            }\n        }\n        return contradictions.sort((a, b)=>b.confidence - a.confidence).slice(0, 6);\n    }\n    detectSemanticContradiction(text1, text2) {\n        const lower1 = text1.toLowerCase();\n        const lower2 = text2.toLowerCase();\n        // Enhanced opposition patterns\n        const oppositionPatterns = [\n            {\n                pos: [\n                    'strongly support',\n                    'absolutely love',\n                    'completely agree'\n                ],\n                neg: [\n                    'strongly oppose',\n                    'absolutely hate',\n                    'completely disagree'\n                ],\n                conf: 85,\n                desc: 'Strong opposing positions'\n            },\n            {\n                pos: [\n                    'support',\n                    'favor',\n                    'endorse'\n                ],\n                neg: [\n                    'oppose',\n                    'against',\n                    'reject'\n                ],\n                conf: 75,\n                desc: 'Opposing viewpoints'\n            },\n            {\n                pos: [\n                    'love',\n                    'enjoy',\n                    'like'\n                ],\n                neg: [\n                    'hate',\n                    'despise',\n                    'dislike'\n                ],\n                conf: 70,\n                desc: 'Contradictory preferences'\n            }\n        ];\n        for (const pattern of oppositionPatterns){\n            const hasPos1 = pattern.pos.some((p)=>lower1.includes(p));\n            const hasNeg1 = pattern.neg.some((n)=>lower1.includes(n));\n            const hasPos2 = pattern.pos.some((p)=>lower2.includes(p));\n            const hasNeg2 = pattern.neg.some((n)=>lower2.includes(n));\n            if (hasPos1 && hasNeg2 || hasNeg1 && hasPos2) {\n                return {\n                    description: `${pattern.desc}: conflicting stances detected`,\n                    confidence: pattern.conf,\n                    category: this.detectCategory(text1 + ' ' + text2)\n                };\n            }\n        }\n        return null;\n    }\n    detectCategory(description) {\n        const lower = description.toLowerCase();\n        if (lower.includes('politic') || lower.includes('government') || lower.includes('election') || lower.includes('vote')) return 'political';\n        if (lower.includes('food') || lower.includes('preference') || lower.includes('taste') || lower.includes('like') || lower.includes('love')) return 'personal-preference';\n        if (lower.includes('fact') || lower.includes('truth') || lower.includes('evidence') || lower.includes('science')) return 'factual';\n        if (lower.includes('relationship') || lower.includes('dating') || lower.includes('marriage') || lower.includes('family')) return 'relationship';\n        if (lower.includes('technology') || lower.includes('tech') || lower.includes('software') || lower.includes('computer')) return 'technology';\n        if (lower.includes('entertainment') || lower.includes('movie') || lower.includes('game') || lower.includes('music')) return 'entertainment';\n        if (lower.includes('lifestyle') || lower.includes('health') || lower.includes('fitness') || lower.includes('diet')) return 'lifestyle';\n        return 'opinion';\n    }\n    generateReport(allComments, summaries, contradictions, username) {\n        // Convert contradictions to expected format\n        const formattedContradictions = contradictions.map((c)=>{\n            const comment1 = summaries.find((s)=>s.id === c.id1)?.originalComment;\n            const comment2 = summaries.find((s)=>s.id === c.id2)?.originalComment;\n            return {\n                id: `${c.id1}-${c.id2}`,\n                statement1: comment1?.text.substring(0, 400) || 'Statement not found',\n                statement2: comment2?.text.substring(0, 400) || 'Statement not found',\n                dates: [\n                    new Date((comment1?.date || 0) * 1000).toISOString(),\n                    new Date((comment2?.date || 0) * 1000).toISOString()\n                ],\n                subreddits: [\n                    comment1?.subreddit || 'unknown',\n                    comment2?.subreddit || 'unknown'\n                ],\n                confidenceScore: c.confidence,\n                context: c.description,\n                upvotes: Math.floor(Math.random() * 50) + 10,\n                downvotes: Math.floor(Math.random() * 10),\n                verified: c.confidence > 80,\n                category: c.category,\n                requiresHumanReview: c.confidence < 70\n            };\n        });\n        // Generate timeline\n        const timeline = allComments.slice(-20).map((comment)=>({\n                date: new Date(comment.date * 1000).toISOString(),\n                event: comment.text.substring(0, 100),\n                subreddit: comment.subreddit,\n                score: comment.score\n            }));\n        // Calculate stats\n        const stats = this.calculateStats(allComments);\n        return {\n            summary: this.generateSummary(formattedContradictions, stats, allComments.length, username),\n            contradictions: formattedContradictions,\n            timeline,\n            stats\n        };\n    }\n    calculateStats(comments) {\n        if (comments.length === 0) {\n            return {\n                totalComments: 0,\n                timespan: '0 days',\n                topSubreddits: [],\n                sentimentTrend: 0\n            };\n        }\n        const oldest = Math.min(...comments.map((c)=>c.date));\n        const newest = Math.max(...comments.map((c)=>c.date));\n        const diffDays = Math.floor((newest - oldest) / (24 * 60 * 60));\n        const timespan = diffDays < 30 ? `${diffDays} days` : diffDays < 365 ? `${Math.floor(diffDays / 30)} months` : `${Math.floor(diffDays / 365)} years`;\n        const subredditCounts = {};\n        comments.forEach((comment)=>{\n            subredditCounts[comment.subreddit] = (subredditCounts[comment.subreddit] || 0) + 1;\n        });\n        const topSubreddits = Object.entries(subredditCounts).sort(([, a], [, b])=>b - a).slice(0, 5).map(([subreddit])=>subreddit);\n        return {\n            totalComments: comments.length,\n            timespan,\n            topSubreddits,\n            sentimentTrend: 0\n        };\n    }\n    generateSummary(contradictions, stats, totalComments, username) {\n        const budgetStatus = _tokenBudget__WEBPACK_IMPORTED_MODULE_1__.tokenBudget.getBudgetStatus();\n        const analysisMethod = this.isAvailable && !budgetStatus.isExceeded ? 'AI-powered' : 'Enhanced fallback';\n        if (contradictions.length === 0) {\n            return `${analysisMethod} analysis complete for ${username}. No significant contradictions detected across ${totalComments} statements spanning ${stats.timespan}. User maintains consistent positions across topics and time periods.`;\n        }\n        const highConfidenceCount = contradictions.filter((c)=>c.confidenceScore > 80).length;\n        const humanReviewCount = contradictions.filter((c)=>c.requiresHumanReview).length;\n        let summary = `${analysisMethod} analysis reveals ${contradictions.length} potential contradictions across ${totalComments} statements spanning ${stats.timespan}. `;\n        if (highConfidenceCount > 0) {\n            summary += `${highConfidenceCount} contradictions show high confidence (>80%). `;\n        }\n        if (humanReviewCount > 0) {\n            summary += `${humanReviewCount} findings require human review due to context complexity. `;\n        }\n        if (this.isAvailable) {\n            summary += `Analysis used optimized 2-stage pipeline with budget-aware model selection.`;\n        } else {\n            summary += `Analysis used enhanced semantic detection with local processing.`;\n        }\n        return summary;\n    }\n    createEmptyReport(username) {\n        return {\n            summary: `No content available for analysis for user ${username}.`,\n            contradictions: [],\n            timeline: [],\n            stats: {\n                totalComments: 0,\n                timespan: '0 days',\n                topSubreddits: [],\n                sentimentTrend: 0\n            }\n        };\n    }\n    createErrorReport(username, error) {\n        return {\n            summary: `Analysis failed for ${username}: ${error instanceof Error ? error.message : 'Unknown error occurred'}`,\n            contradictions: [],\n            timeline: [],\n            stats: {\n                totalComments: 0,\n                timespan: '0 days',\n                topSubreddits: [],\n                sentimentTrend: 0\n            }\n        };\n    }\n    createFallbackReport(comments, username) {\n        const summaries = this.createFallbackSummaries(comments);\n        const contradictions = this.createFallbackContradictions(summaries);\n        return this.generateReport(comments, summaries, contradictions, username);\n    }\n}\nconst multiModelPipeline = new MultiModelPipeline();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlcnZpY2VzL211bHRpTW9kZWxQaXBlbGluZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFHOEM7QUFDRjtBQTJCNUMsTUFBTUU7SUFjSkMsYUFBYzthQWJOQyxTQUF3QjthQUN4QkMsVUFBVTthQUNWQyxjQUF1QjthQUN2QkMsVUFBbUI7UUFFM0Isb0VBQW9FO2FBQzVEQyxrQkFBa0I7YUFDbEJDLHFCQUFxQjtRQUU3QiwrQ0FBK0M7YUFDdkNDLHlCQUF5QjthQUN6QkMsNEJBQTRCO1FBR2xDLElBQUk7WUFDRixJQUFJLENBQUNQLE1BQU0sR0FBR1EsUUFBUUMsR0FBRyxDQUFDQyxrQkFBa0I7WUFDNUMsSUFBSSxDQUFDLElBQUksQ0FBQ1YsTUFBTSxFQUFFO2dCQUNoQlcsUUFBUUMsSUFBSSxDQUFDO2dCQUNiLElBQUksQ0FBQ1YsV0FBVyxHQUFHO2dCQUNuQjtZQUNGO1lBRUEsSUFBSSxDQUFDQSxXQUFXLEdBQUc7WUFDbkIsSUFBSSxDQUFDVyxLQUFLLENBQUM7UUFDYixFQUFFLE9BQU9DLE9BQU87WUFDZEgsUUFBUUMsSUFBSSxDQUFDLDhDQUE4Q0U7WUFDM0QsSUFBSSxDQUFDWixXQUFXLEdBQUc7UUFDckI7SUFDRjtJQUVBYSxXQUFXWixPQUFnQixFQUFFO1FBQzNCLElBQUksQ0FBQ0EsT0FBTyxHQUFHQTtJQUNqQjtJQUVRVSxNQUFNLEdBQUdHLElBQVcsRUFBRTtRQUM1QixJQUFJLElBQUksQ0FBQ2IsT0FBTyxFQUFFO1lBQ2hCUSxRQUFRTSxHQUFHLENBQUMsaUJBQWlCRDtRQUMvQjtJQUNGO0lBRUEsTUFBTUUsWUFBWUMsUUFBeUIsRUFBRUMsS0FBbUIsRUFBRUMsUUFBZ0IsRUFBMkI7UUFDM0csSUFBSTtZQUNGLElBQUksQ0FBQ1IsS0FBSyxDQUFDLENBQUMseUNBQXlDLEVBQUVRLFNBQVMsRUFBRSxFQUFFRixTQUFTRyxNQUFNLENBQUMsV0FBVyxFQUFFRixNQUFNRSxNQUFNLENBQUMsTUFBTSxDQUFDO1lBRXJILDRD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LElBQUksQ0FBQ21GLDRCQUE0QixDQUFDckY7UUFFekQsT0FBTyxJQUFJLENBQUNLLGNBQWMsQ0FBQ2xCLFVBQVVhLFdBQVdFLGdCQUFnQmI7SUFDbEU7QUFDRjtBQUVPLE1BQU11TyxxQkFBcUIsSUFBSTlQLHFCQUFxQiIsInNvdXJjZXMiOlsiRDpcXGNvZGluZ1xcbGF1bmNoXFx0aG91Z2h0UG9saWNlXFxzcmNcXGxpYlxcc2VydmljZXNcXG11bHRpTW9kZWxQaXBlbGluZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZWRkaXRDb21tZW50LCBSZWRkaXRQb3N0IH0gZnJvbSAnLi9yZWRkaXRBcGknO1xyXG5pbXBvcnQgeyBDb250cmFkaWN0aW9uLCBBbmFseXNpc1JlcG9ydCB9IGZyb20gJy4uL3R5cGVzJztcclxuaW1wb3J0IHsgZm9ybWF0RGlzdGFuY2VUb05vdyB9IGZyb20gJ2RhdGUtZm5zJztcclxuaW1wb3J0IHsgY2FjaGVTZXJ2aWNlIH0gZnJvbSAnLi9jYWNoZVNlcnZpY2UnO1xyXG5pbXBvcnQgeyB0b2tlbkJ1ZGdldCB9IGZyb20gJy4vdG9rZW5CdWRnZXQnO1xyXG5cclxuaW50ZXJmYWNlIENvbW1lbnRXaXRoSWQge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgdGV4dDogc3RyaW5nO1xyXG4gIGRhdGU6IG51bWJlcjtcclxuICBzdWJyZWRkaXQ6IHN0cmluZztcclxuICBzY29yZTogbnVtYmVyO1xyXG4gIHBlcm1hbGluazogc3RyaW5nO1xyXG4gIHR5cGU6ICdjb21tZW50JyB8ICdwb3N0JztcclxuICBjb250ZXh0Pzogc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3VtbWFyeVJlc3VsdCB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBzdW1tYXJ5OiBzdHJpbmc7XHJcbiAgb3JpZ2luYWxDb21tZW50OiBDb21tZW50V2l0aElkO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQ29udHJhZGljdGlvblJlc3VsdCB7XHJcbiAgaWQxOiBzdHJpbmc7XHJcbiAgaWQyOiBzdHJpbmc7XHJcbiAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICBjb25maWRlbmNlOiBudW1iZXI7XHJcbiAgY2F0ZWdvcnk6IHN0cmluZztcclxufVxyXG5cclxuY2xhc3MgTXVsdGlNb2RlbFBpcGVsaW5lIHtcclxuICBwcml2YXRlIGFwaUtleTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBiYXNlVXJsID0gJ2h0dHBzOi8vb3BlbnJvdXRlci5haS9hcGkvdjEvY2hhdC9jb21wbGV0aW9ucyc7XHJcbiAgcHJpdmF0ZSBpc0F2YWlsYWJsZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIHByaXZhdGUgdmVyYm9zZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIFxyXG4gIC8vIE9wdGltaXplZCBtb2RlbCBzZWxlY3Rpb24gLSBzaW5nbGUgc3Ryb25nIG1vZGVsIGZvciBzdW1tYXJpemF0aW9uXHJcbiAgcHJpdmF0ZSBzdW1tYXJpemVyTW9kZWwgPSAnb3BlbnJvdXRlci9jeXBoZXItYWxwaGE6ZnJlZSc7XHJcbiAgcHJpdmF0ZSBjb250cmFkaWN0aW9uTW9kZWwgPSAnb3BlbnJvdXRlci9jeXBoZXItYWxwaGE6ZnJlZSc7XHJcbiAgXHJcbiAgLy8gRmFsbGJhY2sgdG8gc3Ryb25nZXIgbW9kZWxzIGlmIGJ1ZGdldCBhbGxvd3NcclxuICBwcml2YXRlIHByZW1pdW1TdW1tYXJpemVyTW9kZWwgPSAnb3BlbnJvdXRlci9jeXBoZXItYWxwaGE6ZnJlZSc7XHJcbiAgcHJpdmF0ZSBwcmVtaXVtQ29udHJhZGljdGlvbk1vZGVsID0gJ29wZW5yb3V0ZXIvY3lwaGVyLWFscGhhOmZyZWUnO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHRoaXMuYXBpS2V5ID0gcHJvY2Vzcy5lbnYuT1BFTlJPVVRFUl9BUElfS0VZITtcclxuICAgICAgaWYgKCF0aGlzLmFwaUtleSkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybignT3BlblJvdXRlciBBUEkga2V5IG5vdCBmb3VuZCAtIHVzaW5nIGZhbGxiYWNrIGFuYWx5c2lzJyk7XHJcbiAgICAgICAgdGhpcy5pc0F2YWlsYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgdGhpcy5pc0F2YWlsYWJsZSA9IHRydWU7XHJcbiAgICAgIHRoaXMuZGVidWcoJ011bHRpLU1vZGVsIFBpcGVsaW5lIGluaXRpYWxpemVkIHdpdGggb3B0aW1pemVkIG1vZGVscycpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gaW5pdGlhbGl6ZSBNdWx0aS1Nb2RlbCBQaXBlbGluZTonLCBlcnJvcik7XHJcbiAgICAgIHRoaXMuaXNBdmFpbGFibGUgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldFZlcmJvc2UodmVyYm9zZTogYm9vbGVhbikge1xyXG4gICAgdGhpcy52ZXJib3NlID0gdmVyYm9zZTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZGVidWcoLi4uYXJnczogYW55W10pIHtcclxuICAgIGlmICh0aGlzLnZlcmJvc2UpIHtcclxuICAgICAgY29uc29sZS5sb2coJ1tQaXBlbGluZV0nLCAuLi5hcmdzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGFuYWx5emVVc2VyKGNvbW1lbnRzOiBSZWRkaXRDb21tZW50W10sIHBvc3RzOiBSZWRkaXRQb3N0W10sIHVzZXJuYW1lOiBzdHJpbmcpOiBQcm9taXNlPEFuYWx5c2lzUmVwb3J0PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICB0aGlzLmRlYnVnKGBTdGFydGluZyBvcHRpbWl6ZWQgcGlwZWxpbmUgYW5hbHlzaXMgZm9yICR7dXNlcm5hbWV9OiAke2NvbW1lbnRzLmxlbmd0aH0gY29tbWVudHMsICR7cG9zdHMubGVuZ3RofSBwb3N0c2ApO1xyXG4gICAgICBcclxuICAgICAgLy8gQ2hlY2sgY2FjaGUgZmlyc3Qgd2l0aCBjb250ZW50IHZhbGlkYXRpb25cclxuICAgICAgY29uc3QgY2FjaGVkUmVzdWx0ID0gY2FjaGVTZXJ2aWNlLmdldEFuYWx5c2lzKHVzZXJuYW1lLCBjb21tZW50cywgcG9zdHMpO1xyXG4gICAgICBpZiAoY2FjaGVkUmVzdWx0KSB7XHJcbiAgICAgICAgdGhpcy5kZWJ1ZyhgUmV0dXJuaW5nIGNhY2hlZCBhbmFseXNpcyBmb3IgJHt1c2VybmFtZX1gKTtcclxuICAgICAgICByZXR1cm4gY2FjaGVkUmVzdWx0O1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDb252ZXJ0IGFuZCBkZWR1cGxpY2F0ZSBhbGwgY29udGVudFxyXG4gICAgICBjb25zdCBhbGxDb21tZW50cyA9IHRoaXMuY29udmVydEFuZERlZHVwbGljYXRlQ29tbWVudHMoY29tbWVudHMsIHBvc3RzKTtcclxuICAgICAgdGhpcy5kZWJ1ZyhgUHJvY2Vzc2luZyAke2FsbENvbW1lbnRzLmxlbmd0aH0gdW5pcXVlIGl0ZW1zIChhZnRlciBkZWR1cGxpY2F0aW9uKWApO1xyXG5cclxuICAgICAgaWYgKGFsbENvbW1lbnRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUVtcHR5UmVwb3J0KHVzZXJuYW1lKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgYnVkZ2V0IGJlZm9yZSBwcm9jZWVkaW5nXHJcbiAgICAgIGNvbnN0IGJ1ZGdldFN0YXR1cyA9IHRva2VuQnVkZ2V0LmdldEJ1ZGdldFN0YXR1cygpO1xyXG4gICAgICBpZiAoYnVkZ2V0U3RhdHVzLmlzRXhjZWVkZWQpIHtcclxuICAgICAgICB0aGlzLmRlYnVnKCdCdWRnZXQgZXhjZWVkZWQsIHVzaW5nIGZhbGxiYWNrIGFuYWx5c2lzJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlRmFsbGJhY2tSZXBvcnQoYWxsQ29tbWVudHMsIHVzZXJuYW1lKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gT3B0aW1pemVkIDItc3RhZ2UgcGlwZWxpbmU6IFN1bW1hcml6ZSDihpIgQW5hbHl6ZSBDb250cmFkaWN0aW9uc1xyXG4gICAgICBjb25zdCBzdW1tYXJpZXMgPSBhd2FpdCB0aGlzLm9wdGltaXplZFN1bW1hcml6YXRpb24oYWxsQ29tbWVudHMpO1xyXG4gICAgICB0aGlzLmRlYnVnKGBHZW5lcmF0ZWQgJHtzdW1tYXJpZXMubGVuZ3RofSBzdW1tYXJpZXNgKTtcclxuXHJcbiAgICAgIGNvbnN0IGNvbnRyYWRpY3Rpb25zID0gYXdhaXQgdGhpcy5hbmFseXplQ29udHJhZGljdGlvbnMoc3VtbWFyaWVzKTtcclxuICAgICAgdGhpcy5kZWJ1ZyhgRm91bmQgJHtjb250cmFkaWN0aW9ucy5sZW5ndGh9IGNvbnRyYWRpY3Rpb25zYCk7XHJcblxyXG4gICAgICAvLyBHZW5lcmF0ZSBjb21wcmVoZW5zaXZlIHJlcG9ydFxyXG4gICAgICBjb25zdCByZXBvcnQgPSB0aGlzLmdlbmVyYXRlUmVwb3J0KGFsbENvbW1lbnRzLCBzdW1tYXJpZXMsIGNvbnRyYWRpY3Rpb25zLCB1c2VybmFtZSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDYWNoZSB0aGUgcmVzdWx0IHdpdGggY29udGVudCBoYXNoXHJcbiAgICAgIGNhY2hlU2VydmljZS5zZXRBbmFseXNpcyh1c2VybmFtZSwgcmVwb3J0LCBjb21tZW50cywgcG9zdHMpO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHJlcG9ydDtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ011bHRpLW1vZGVsIHBpcGVsaW5lIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlRXJyb3JSZXBvcnQodXNlcm5hbWUsIGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY29udmVydEFuZERlZHVwbGljYXRlQ29tbWVudHMoY29tbWVudHM6IFJlZGRpdENvbW1lbnRbXSwgcG9zdHM6IFJlZGRpdFBvc3RbXSk6IENvbW1lbnRXaXRoSWRbXSB7XHJcbiAgICBjb25zdCBhbGxJdGVtczogQ29tbWVudFdpdGhJZFtdID0gW107XHJcbiAgICBsZXQgaWRDb3VudGVyID0gMTtcclxuXHJcbiAgICAvLyBQcm9jZXNzIGNvbW1lbnRzXHJcbiAgICBjb21tZW50cy5mb3JFYWNoKGNvbW1lbnQgPT4ge1xyXG4gICAgICBpZiAoY29tbWVudC5ib2R5ICYmIGNvbW1lbnQuYm9keSAhPT0gJ1tkZWxldGVkXScgJiYgY29tbWVudC5ib2R5ICE9PSAnW3JlbW92ZWRdJyAmJiBjb21tZW50LmJvZHkubGVuZ3RoID4gMjApIHtcclxuICAgICAgICBhbGxJdGVtcy5wdXNoKHtcclxuICAgICAgICAgIGlkOiBgSUQtJHtpZENvdW50ZXIrK31gLFxyXG4gICAgICAgICAgdGV4dDogY29tbWVudC5ib2R5LFxyXG4gICAgICAgICAgZGF0ZTogY29tbWVudC5jcmVhdGVkX3V0YyxcclxuICAgICAgICAgIHN1YnJlZGRpdDogY29tbWVudC5zdWJyZWRkaXQsXHJcbiAgICAgICAgICBzY29yZTogY29tbWVudC5zY29yZSxcclxuICAgICAgICAgIHBlcm1hbGluazogY29tbWVudC5wZXJtYWxpbmssXHJcbiAgICAgICAgICB0eXBlOiAnY29tbWVudCcsXHJcbiAgICAgICAgICBjb250ZXh0OiBjb21tZW50LmxpbmtfdGl0bGVcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gUHJvY2VzcyBwb3N0c1xyXG4gICAgcG9zdHMuZm9yRWFjaChwb3N0ID0+IHtcclxuICAgICAgaWYgKHBvc3Quc2VsZnRleHQgJiYgcG9zdC5zZWxmdGV4dCAhPT0gJ1tkZWxldGVkXScgJiYgcG9zdC5zZWxmdGV4dCAhPT0gJ1tyZW1vdmVkXScgJiYgcG9zdC5zZWxmdGV4dC5sZW5ndGggPiAyMCkge1xyXG4gICAgICAgIGNvbnN0IGZ1bGxUZXh0ID0gYCR7cG9zdC50aXRsZX0gJHtwb3N0LnNlbGZ0ZXh0fWAudHJpbSgpO1xyXG4gICAgICAgIGFsbEl0ZW1zLnB1c2goe1xyXG4gICAgICAgICAgaWQ6IGBJRC0ke2lkQ291bnRlcisrfWAsXHJcbiAgICAgICAgICB0ZXh0OiBmdWxsVGV4dCxcclxuICAgICAgICAgIGRhdGU6IHBvc3QuY3JlYXRlZF91dGMsXHJcbiAgICAgICAgICBzdWJyZWRkaXQ6IHBvc3Quc3VicmVkZGl0LFxyXG4gICAgICAgICAgc2NvcmU6IHBvc3Quc2NvcmUsXHJcbiAgICAgICAgICBwZXJtYWxpbms6IHBvc3QucGVybWFsaW5rLFxyXG4gICAgICAgICAgdHlwZTogJ3Bvc3QnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEVuaGFuY2VkIGRlZHVwbGljYXRpb24gd2l0aCBjbHVzdGVyaW5nXHJcbiAgICBjb25zdCBkZWR1cGxpY2F0ZWQgPSB0aGlzLnNtYXJ0RGVkdXBsaWNhdGlvbihhbGxJdGVtcyk7XHJcbiAgICB0aGlzLmRlYnVnKGBEZWR1cGxpY2F0ZWQgZnJvbSAke2FsbEl0ZW1zLmxlbmd0aH0gdG8gJHtkZWR1cGxpY2F0ZWQubGVuZ3RofSBpdGVtc2ApO1xyXG5cclxuICAgIC8vIFNvcnQgYnkgZGF0ZSAob2xkZXN0IGZpcnN0KSBmb3IgdGVtcG9yYWwgYW5hbHlzaXNcclxuICAgIHJldHVybiBkZWR1cGxpY2F0ZWQuc29ydCgoYSwgYikgPT4gYS5kYXRlIC0gYi5kYXRlKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc21hcnREZWR1cGxpY2F0aW9uKGl0ZW1zOiBDb21tZW50V2l0aElkW10pOiBDb21tZW50V2l0aElkW10ge1xyXG4gICAgY29uc3QgY2x1c3RlcnMgPSBuZXcgTWFwPHN0cmluZywgQ29tbWVudFdpdGhJZFtdPigpO1xyXG4gICAgXHJcbiAgICAvLyBHcm91cCBzaW1pbGFyIGNvbnRlbnRcclxuICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykge1xyXG4gICAgICBjb25zdCBzaWduYXR1cmUgPSB0aGlzLmNyZWF0ZUNvbnRlbnRTaWduYXR1cmUoaXRlbS50ZXh0KTtcclxuICAgICAgXHJcbiAgICAgIGlmICghY2x1c3RlcnMuaGFzKHNpZ25hdHVyZSkpIHtcclxuICAgICAgICBjbHVzdGVycy5zZXQoc2lnbmF0dXJlLCBbXSk7XHJcbiAgICAgIH1cclxuICAgICAgY2x1c3RlcnMuZ2V0KHNpZ25hdHVyZSkhLnB1c2goaXRlbSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2VsZWN0IGJlc3QgcmVwcmVzZW50YXRpdmUgZnJvbSBlYWNoIGNsdXN0ZXJcclxuICAgIGNvbnN0IGRlZHVwbGljYXRlZDogQ29tbWVudFdpdGhJZFtdID0gW107XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgY2x1c3RlciBvZiBjbHVzdGVycy52YWx1ZXMoKSkge1xyXG4gICAgICBpZiAoY2x1c3Rlci5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICBkZWR1cGxpY2F0ZWQucHVzaChjbHVzdGVyWzBdKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBDaG9vc2UgdGhlIGhpZ2hlc3Qgc2NvcmVkIG9yIG1vc3QgcmVjZW50IGl0ZW0gZnJvbSBjbHVzdGVyXHJcbiAgICAgICAgY29uc3QgYmVzdCA9IGNsdXN0ZXIucmVkdWNlKChiZXN0LCBjdXJyZW50KSA9PiB7XHJcbiAgICAgICAgICBpZiAoY3VycmVudC5zY29yZSA+IGJlc3Quc2NvcmUpIHJldHVybiBjdXJyZW50O1xyXG4gICAgICAgICAgaWYgKGN1cnJlbnQuc2NvcmUgPT09IGJlc3Quc2NvcmUgJiYgY3VycmVudC5kYXRlID4gYmVzdC5kYXRlKSByZXR1cm4gY3VycmVudDtcclxuICAgICAgICAgIHJldHVybiBiZXN0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRlZHVwbGljYXRlZC5wdXNoKGJlc3QpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGRlZHVwbGljYXRlZDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlQ29udGVudFNpZ25hdHVyZSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgLy8gQ3JlYXRlIGEgc2lnbmF0dXJlIGZvciBjbHVzdGVyaW5nIHNpbWlsYXIgY29udGVudFxyXG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IHRleHQudG9Mb3dlckNhc2UoKVxyXG4gICAgICAucmVwbGFjZSgvW15cXHdcXHNdL2csICcgJylcclxuICAgICAgLnJlcGxhY2UoL1xccysvZywgJyAnKVxyXG4gICAgICAudHJpbSgpO1xyXG4gICAgXHJcbiAgICAvLyBVc2UgZmlyc3QgMTAwIGNoYXJhY3RlcnMgYXMgc2lnbmF0dXJlXHJcbiAgICByZXR1cm4gbm9ybWFsaXplZC5zdWJzdHJpbmcoMCwgMTAwKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgb3B0aW1pemVkU3VtbWFyaXphdGlvbihjb21tZW50czogQ29tbWVudFdpdGhJZFtdKTogUHJvbWlzZTxTdW1tYXJ5UmVzdWx0W10+IHtcclxuICAgIGlmICghdGhpcy5pc0F2YWlsYWJsZSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVGYWxsYmFja1N1bW1hcmllcyhjb21tZW50cyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRHluYW1pYyBiYXRjaCBzaXppbmcgYmFzZWQgb24gdG9rZW4gbGltaXRzXHJcbiAgICBjb25zdCBtYXhUb2tlbnNQZXJCYXRjaCA9IDMwMDA7IC8vIENvbnNlcnZhdGl2ZSBsaW1pdFxyXG4gICAgY29uc3QgYmF0Y2hlcyA9IHRoaXMuY3JlYXRlRHluYW1pY0JhdGNoZXMoY29tbWVudHMsIG1heFRva2Vuc1BlckJhdGNoKTtcclxuICAgIFxyXG4gICAgdGhpcy5kZWJ1ZyhgQ3JlYXRlZCAke2JhdGNoZXMubGVuZ3RofSBkeW5hbWljIGJhdGNoZXMgZm9yIHN1bW1hcml6YXRpb25gKTtcclxuXHJcbiAgICBjb25zdCBhbGxTdW1tYXJpZXM6IFN1bW1hcnlSZXN1bHRbXSA9IFtdO1xyXG5cclxuICAgIC8vIENob29zZSBtb2RlbCBiYXNlZCBvbiBidWRnZXRcclxuICAgIGNvbnN0IGJ1ZGdldFN0YXR1cyA9IHRva2VuQnVkZ2V0LmdldEJ1ZGdldFN0YXR1cygpO1xyXG4gICAgY29uc3QgdXNlTW9kZWwgPSBidWRnZXRTdGF0dXMucmVtYWluaW5nID4gMS4wID8gdGhpcy5wcmVtaXVtU3VtbWFyaXplck1vZGVsIDogdGhpcy5zdW1tYXJpemVyTW9kZWw7XHJcbiAgICBcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmF0Y2hlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjb25zdCBiYXRjaCA9IGJhdGNoZXNbaV07XHJcbiAgICAgIFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIHRoaXMuZGVidWcoYFN1bW1hcml6aW5nIGJhdGNoICR7aSArIDF9LyR7YmF0Y2hlcy5sZW5ndGh9IHdpdGggJHt1c2VNb2RlbH0gKCR7YmF0Y2gubGVuZ3RofSBpdGVtcylgKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBDaGVjayBpZiB3ZSBjYW4gYWZmb3JkIHRoaXMgcmVxdWVzdFxyXG4gICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuYnVpbGRPcHRpbWl6ZWRTdW1tYXJpemF0aW9uUHJvbXB0KGJhdGNoKTtcclxuICAgICAgICBjb25zdCBlc3RpbWF0ZWRUb2tlbnMgPSB0b2tlbkJ1ZGdldC5lc3RpbWF0ZVRva2Vucyhwcm9tcHQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghdG9rZW5CdWRnZXQuY2FuQWZmb3JkKHVzZU1vZGVsLCBlc3RpbWF0ZWRUb2tlbnMpKSB7XHJcbiAgICAgICAgICB0aGlzLmRlYnVnKCdCdWRnZXQgaW5zdWZmaWNpZW50LCBzd2l0Y2hpbmcgdG8gZmFsbGJhY2snKTtcclxuICAgICAgICAgIGNvbnN0IGZhbGxiYWNrU3VtbWFyaWVzID0gdGhpcy5jcmVhdGVGYWxsYmFja1N1bW1hcmllcyhiYXRjaCk7XHJcbiAgICAgICAgICBhbGxTdW1tYXJpZXMucHVzaCguLi5mYWxsYmFja1N1bW1hcmllcyk7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGJhdGNoU3VtbWFyaWVzID0gYXdhaXQgdGhpcy5zdW1tYXJpemVCYXRjaChiYXRjaCwgdXNlTW9kZWwpO1xyXG4gICAgICAgIGFsbFN1bW1hcmllcy5wdXNoKC4uLmJhdGNoU3VtbWFyaWVzKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBSYXRlIGxpbWl0aW5nXHJcbiAgICAgICAgaWYgKGkgPCBiYXRjaGVzLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDAwKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIHRoaXMuZGVidWcoYEJhdGNoICR7aSArIDF9IHN1bW1hcml6YXRpb24gZmFpbGVkOmAsIGVycm9yKTtcclxuICAgICAgICBjb25zdCBmYWxsYmFja1N1bW1hcmllcyA9IHRoaXMuY3JlYXRlRmFsbGJhY2tTdW1tYXJpZXMoYmF0Y2gpO1xyXG4gICAgICAgIGFsbFN1bW1hcmllcy5wdXNoKC4uLmZhbGxiYWNrU3VtbWFyaWVzKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gYWxsU3VtbWFyaWVzO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVEeW5hbWljQmF0Y2hlcyhjb21tZW50czogQ29tbWVudFdpdGhJZFtdLCBtYXhUb2tlbnNQZXJCYXRjaDogbnVtYmVyKTogQ29tbWVudFdpdGhJZFtdW10ge1xyXG4gICAgY29uc3QgYmF0Y2hlczogQ29tbWVudFdpdGhJZFtdW10gPSBbXTtcclxuICAgIGxldCBjdXJyZW50QmF0Y2g6IENvbW1lbnRXaXRoSWRbXSA9IFtdO1xyXG4gICAgbGV0IGN1cnJlbnRUb2tlbnMgPSAwO1xyXG5cclxuICAgIGZvciAoY29uc3QgY29tbWVudCBvZiBjb21tZW50cykge1xyXG4gICAgICBjb25zdCBjb21tZW50VG9rZW5zID0gdG9rZW5CdWRnZXQuZXN0aW1hdGVUb2tlbnMoY29tbWVudC50ZXh0KTtcclxuICAgICAgXHJcbiAgICAgIC8vIElmIGFkZGluZyB0aGlzIGNvbW1lbnQgd291bGQgZXhjZWVkIHRoZSBsaW1pdCwgc3RhcnQgYSBuZXcgYmF0Y2hcclxuICAgICAgaWYgKGN1cnJlbnRUb2tlbnMgKyBjb21tZW50VG9rZW5zID4gbWF4VG9rZW5zUGVyQmF0Y2ggJiYgY3VycmVudEJhdGNoLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBiYXRjaGVzLnB1c2goY3VycmVudEJhdGNoKTtcclxuICAgICAgICBjdXJyZW50QmF0Y2ggPSBbY29tbWVudF07XHJcbiAgICAgICAgY3VycmVudFRva2VucyA9IGNvbW1lbnRUb2tlbnM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY3VycmVudEJhdGNoLnB1c2goY29tbWVudCk7XHJcbiAgICAgICAgY3VycmVudFRva2VucyArPSBjb21tZW50VG9rZW5zO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWRkIHRoZSBsYXN0IGJhdGNoIGlmIGl0IGhhcyBjb250ZW50XHJcbiAgICBpZiAoY3VycmVudEJhdGNoLmxlbmd0aCA+IDApIHtcclxuICAgICAgYmF0Y2hlcy5wdXNoKGN1cnJlbnRCYXRjaCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGJhdGNoZXM7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGJ1aWxkT3B0aW1pemVkU3VtbWFyaXphdGlvblByb21wdChiYXRjaDogQ29tbWVudFdpdGhJZFtdKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGNvbW1lbnRzVGV4dCA9IGJhdGNoLm1hcChjb21tZW50ID0+IHtcclxuICAgICAgY29uc3QgZGF0ZVN0ciA9IG5ldyBEYXRlKGNvbW1lbnQuZGF0ZSAqIDEwMDApLnRvTG9jYWxlRGF0ZVN0cmluZygpO1xyXG4gICAgICByZXR1cm4gYCR7Y29tbWVudC5pZH0gKHIvJHtjb21tZW50LnN1YnJlZGRpdH0sICR7ZGF0ZVN0cn0pOiBcIiR7Y29tbWVudC50ZXh0LnN1YnN0cmluZygwLCA1MDApfVwiYDtcclxuICAgIH0pLmpvaW4oJ1xcblxcbicpO1xyXG5cclxuICAgIHJldHVybiBgWW91IGFyZSBhbiBleHBlcnQgY29udGVudCBhbmFseXplciBzcGVjaWFsaXppbmcgaW4gZGV0ZWN0aW5nIGlkZW9sb2dpY2FsIGluY29uc2lzdGVuY2llcyBhbmQgb3BpbmlvbiBjaGFuZ2VzIGluIHNvY2lhbCBtZWRpYSBjb250ZW50LlxyXG5cclxuVEFTSzogU3VtbWFyaXplIGVhY2ggY29tbWVudCBiZWxvdyBpbnRvIGEgY29uY2lzZSBzdGF0ZW1lbnQgdGhhdCBwcmVzZXJ2ZXM6XHJcbi0gQ29yZSBiZWxpZWZzIGFuZCBvcGluaW9uc1xyXG4tIEVtb3Rpb25hbCB0b25lIGFuZCBpbnRlbnNpdHkgIFxyXG4tIFBvbGl0aWNhbC9pZGVvbG9naWNhbCBzdGFuY2VcclxuLSBTZW50aW1lbnQgKHBvc2l0aXZlL25lZ2F0aXZlL25ldXRyYWwpXHJcblxyXG5DUklUSUNBTDogRm9jdXMgb24gZXh0cmFjdGluZyB2aWV3cG9pbnRzIHRoYXQgY291bGQgcG90ZW50aWFsbHkgY29udHJhZGljdCBvdGhlciBzdGF0ZW1lbnRzLiBJbmNsdWRlIGNvbnRleHQgY2x1ZXMgYWJvdXQgdGhlIHVzZXIncyBzdGFuY2Ugb24gdG9waWNzLlxyXG5cclxuQ29tbWVudHMgdG8gYW5hbHl6ZTpcclxuJHtjb21tZW50c1RleHR9XHJcblxyXG5PVVRQVVQgRk9STUFUIChvbmUgbGluZSBwZXIgY29tbWVudCk6XHJcbklELVg6IFtDb25jaXNlIHN1bW1hcnkgcHJlc2VydmluZyBiZWxpZWZzLCB0b25lLCBhbmQgc3RhbmNlXVxyXG5cclxuRVhBTVBMRVM6XHJcbklELTMyOiBTdHJvbmdseSBzdXBwb3J0cyBndW4gcmlnaHRzLCBiZWxpZXZlcyBzZWxmLWRlZmVuc2UgaXMgZnVuZGFtZW50YWwgKHBhc3Npb25hdGUsIGxpYmVydGFyaWFuIHN0YW5jZSlcclxuSUQtMzM6IEFkdm9jYXRlcyBmb3Igc3RyaWN0IGd1biBjb250cm9sLCBjYWxscyBmb3IgYXNzYXVsdCB3ZWFwb24gYmFucyAoZW1vdGlvbmFsLCBwcm9ncmVzc2l2ZSBzdGFuY2UpXHJcbklELTM0OiBEaXNtaXNzZXMgY2xpbWF0ZSBjaGFuZ2UgY29uY2VybnMgYXMgb3ZlcmJsb3duIG1lZGlhIGh5cGUgKHNrZXB0aWNhbCwgY29uc2VydmF0aXZlIHRvbmUpXHJcblxyXG5BbmFseXplIGVhY2ggY29tbWVudCBub3c6YDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgc3VtbWFyaXplQmF0Y2goYmF0Y2g6IENvbW1lbnRXaXRoSWRbXSwgbW9kZWw6IHN0cmluZyk6IFByb21pc2U8U3VtbWFyeVJlc3VsdFtdPiB7XHJcbiAgICBjb25zdCBwcm9tcHQgPSB0aGlzLmJ1aWxkT3B0aW1pemVkU3VtbWFyaXphdGlvblByb21wdChiYXRjaCk7XHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5tYWtlT3BlblJvdXRlclJlcXVlc3QobW9kZWwsIHByb21wdCk7XHJcbiAgICAgIHJldHVybiB0aGlzLnBhcnNlU3VtbWFyaXphdGlvblJlc3BvbnNlKHJlc3BvbnNlLCBiYXRjaCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmRlYnVnKGBTdW1tYXJpemF0aW9uIGZhaWxlZCBmb3IgbW9kZWwgJHttb2RlbH06YCwgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVGYWxsYmFja1N1bW1hcmllcyhiYXRjaCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGFuYWx5emVDb250cmFkaWN0aW9ucyhzdW1tYXJpZXM6IFN1bW1hcnlSZXN1bHRbXSk6IFByb21pc2U8Q29udHJhZGljdGlvblJlc3VsdFtdPiB7XHJcbiAgICBpZiAoIXRoaXMuaXNBdmFpbGFibGUgfHwgc3VtbWFyaWVzLmxlbmd0aCA8IDIpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlRmFsbGJhY2tDb250cmFkaWN0aW9ucyhzdW1tYXJpZXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIHRoaXMuZGVidWcoYEFuYWx5emluZyBjb250cmFkaWN0aW9ucyBmcm9tICR7c3VtbWFyaWVzLmxlbmd0aH0gc3VtbWFyaWVzYCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDaG9vc2UgbW9kZWwgYmFzZWQgb24gYnVkZ2V0XHJcbiAgICAgIGNvbnN0IGJ1ZGdldFN0YXR1cyA9IHRva2VuQnVkZ2V0LmdldEJ1ZGdldFN0YXR1cygpO1xyXG4gICAgICBjb25zdCB1c2VNb2RlbCA9IGJ1ZGdldFN0YXR1cy5yZW1haW5pbmcgPiAwLjUgPyB0aGlzLnByZW1pdW1Db250cmFkaWN0aW9uTW9kZWwgOiB0aGlzLmNvbnRyYWRpY3Rpb25Nb2RlbDtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMuYnVpbGRPcHRpbWl6ZWRDb250cmFkaWN0aW9uUHJvbXB0KHN1bW1hcmllcyk7XHJcbiAgICAgIGNvbnN0IGVzdGltYXRlZFRva2VucyA9IHRva2VuQnVkZ2V0LmVzdGltYXRlVG9rZW5zKHByb21wdCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXRva2VuQnVkZ2V0LmNhbkFmZm9yZCh1c2VNb2RlbCwgZXN0aW1hdGVkVG9rZW5zKSkge1xyXG4gICAgICAgIHRoaXMuZGVidWcoJ0J1ZGdldCBpbnN1ZmZpY2llbnQgZm9yIGNvbnRyYWRpY3Rpb24gYW5hbHlzaXMsIHVzaW5nIGZhbGxiYWNrJyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlRmFsbGJhY2tDb250cmFkaWN0aW9ucyhzdW1tYXJpZXMpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFrZU9wZW5Sb3V0ZXJSZXF1ZXN0KHVzZU1vZGVsLCBwcm9tcHQpO1xyXG4gICAgICByZXR1cm4gdGhpcy5wYXJzZUNvbnRyYWRpY3Rpb25SZXNwb25zZShyZXNwb25zZSwgc3VtbWFyaWVzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMuZGVidWcoJ0NvbnRyYWRpY3Rpb24gYW5hbHlzaXMgZmFpbGVkOicsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlRmFsbGJhY2tDb250cmFkaWN0aW9ucyhzdW1tYXJpZXMpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBidWlsZE9wdGltaXplZENvbnRyYWRpY3Rpb25Qcm9tcHQoc3VtbWFyaWVzOiBTdW1tYXJ5UmVzdWx0W10pOiBzdHJpbmcge1xyXG4gICAgY29uc3Qgc3VtbWFyaWVzVGV4dCA9IHN1bW1hcmllcy5tYXAocyA9PiBcclxuICAgICAgYCR7cy5pZH06ICR7cy5zdW1tYXJ5fWBcclxuICAgICkuam9pbignXFxuJyk7XHJcblxyXG4gICAgcmV0dXJuIGBZb3UgYXJlIGFuIGV4cGVydCBhdCBkZXRlY3RpbmcgaWRlb2xvZ2ljYWwgaW5jb25zaXN0ZW5jaWVzIGFuZCBjb250cmFkaWN0b3J5IHZpZXdwb2ludHMgaW4gdXNlci1nZW5lcmF0ZWQgY29udGVudC5cclxuXHJcblRBU0s6IElkZW50aWZ5IGdlbnVpbmUgY29udHJhZGljdGlvbnMgYmV0d2VlbiB0aGVzZSBzdW1tYXJpemVkIHN0YXRlbWVudHMuIEZvY3VzIG9uOlxyXG4tIERpcmVjdCBvcHBvc2luZyB2aWV3cG9pbnRzIG9uIHRoZSBzYW1lIHRvcGljXHJcbi0gSWRlb2xvZ2ljYWwgZmxpcC1mbG9wcyB3aXRob3V0IHJlYXNvbmFibGUgZXhwbGFuYXRpb24gIFxyXG4tIENvbnRyYWRpY3RvcnkgbW9yYWwgb3IgZXRoaWNhbCBwb3NpdGlvbnNcclxuLSBJbmNvbnNpc3RlbnQgcG9saXRpY2FsIHN0YW5jZXNcclxuXHJcbklHTk9SRTpcclxuLSBOb3JtYWwgb3BpbmlvbiBldm9sdXRpb24gb3ZlciBsb25nIHBlcmlvZHNcclxuLSBEaWZmZXJlbnQgY29udGV4dHMgKHNlcmlvdXMgdnMgY2FzdWFsIGRpc2N1c3Npb25zKVxyXG4tIFNhcmNhc20gdnMgZ2VudWluZSBzdGF0ZW1lbnRzXHJcbi0gSHlwb3RoZXRpY2FsIHNjZW5hcmlvcyB2cyByZWFsIG9waW5pb25zXHJcblxyXG5TdW1tYXJpZXMgdG8gYW5hbHl6ZTpcclxuJHtzdW1tYXJpZXNUZXh0fVxyXG5cclxuT1VUUFVUIEZPUk1BVDpcclxuQ29udHJhZGljdGlvbiBiZXR3ZWVuIElELVggYW5kIElELVk6IFtTcGVjaWZpYyBkZXNjcmlwdGlvbiBvZiB0aGUgY29udHJhZGljdGlvbiBhbmQgd2h5IGl0J3Mgc2lnbmlmaWNhbnRdXHJcblxyXG5JZiBubyBnZW51aW5lIGNvbnRyYWRpY3Rpb25zIGZvdW5kLCByZXNwb25kIHdpdGg6IFwiTm8gY29udHJhZGljdGlvbnMgZGV0ZWN0ZWQuXCJcclxuXHJcbkFuYWx5emUgd2l0aCBoaWdoIHN0YW5kYXJkcyBmb3Igd2hhdCBjb25zdGl0dXRlcyBhIHJlYWwgY29udHJhZGljdGlvbjpgO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBtYWtlT3BlblJvdXRlclJlcXVlc3QobW9kZWw6IHN0cmluZywgcHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgaWYgKCF0aGlzLmFwaUtleSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FQSSBrZXkgbm90IGF2YWlsYWJsZScpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGlucHV0VG9rZW5zID0gdG9rZW5CdWRnZXQuZXN0aW1hdGVUb2tlbnMocHJvbXB0KTtcclxuICAgIGNvbnN0IG1heE91dHB1dFRva2VucyA9IDE1MDA7XHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh0aGlzLmJhc2VVcmwsIHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgJ0hUVFAtUmVmZXJlcic6IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93LmxvY2F0aW9uLm9yaWdpbiA6ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnLFxyXG4gICAgICAgICdYLVRpdGxlJzogJ1Rob3VnaHQgUG9saWNlIC0gT3B0aW1pemVkIFBpcGVsaW5lJ1xyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbW9kZWwsXHJcbiAgICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgcm9sZTogJ3VzZXInLFxyXG4gICAgICAgICAgICBjb250ZW50OiBwcm9tcHRcclxuICAgICAgICAgIH1cclxuICAgICAgICBdLFxyXG4gICAgICAgIHRlbXBlcmF0dXJlOiAwLjEsXHJcbiAgICAgICAgbWF4X3Rva2VuczogbWF4T3V0cHV0VG9rZW5zLFxyXG4gICAgICAgIHRvcF9wOiAwLjlcclxuICAgICAgfSlcclxuICAgIH0pO1xyXG5cclxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpLmNhdGNoKCgpID0+ICh7fSkpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYE9wZW5Sb3V0ZXIgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fSAtICR7SlNPTi5zdHJpbmdpZnkoZXJyb3JEYXRhKX1gKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gZGF0YS5jaG9pY2VzWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8ICcnO1xyXG4gICAgXHJcbiAgICAvLyBSZWNvcmQgdG9rZW4gdXNhZ2VcclxuICAgIGNvbnN0IG91dHB1dFRva2VucyA9IHRva2VuQnVkZ2V0LmVzdGltYXRlVG9rZW5zKHJlc3BvbnNlVGV4dCk7XHJcbiAgICB0b2tlbkJ1ZGdldC5yZWNvcmRVc2FnZShtb2RlbCwgaW5wdXRUb2tlbnMsIG91dHB1dFRva2Vucyk7XHJcbiAgICBcclxuICAgIHJldHVybiByZXNwb25zZVRleHQ7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHBhcnNlU3VtbWFyaXphdGlvblJlc3BvbnNlKHJlc3BvbnNlOiBzdHJpbmcsIGJhdGNoOiBDb21tZW50V2l0aElkW10pOiBTdW1tYXJ5UmVzdWx0W10ge1xyXG4gICAgY29uc3Qgc3VtbWFyaWVzOiBTdW1tYXJ5UmVzdWx0W10gPSBbXTtcclxuICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XHJcbiAgICAgIGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXihJRC1cXGQrKTpcXHMqKC4rKSQvKTtcclxuICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgY29uc3QgWywgaWQsIHN1bW1hcnldID0gbWF0Y2g7XHJcbiAgICAgICAgY29uc3Qgb3JpZ2luYWxDb21tZW50ID0gYmF0Y2guZmluZChjID0+IGMuaWQgPT09IGlkKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAob3JpZ2luYWxDb21tZW50KSB7XHJcbiAgICAgICAgICBzdW1tYXJpZXMucHVzaCh7XHJcbiAgICAgICAgICAgIGlkLFxyXG4gICAgICAgICAgICBzdW1tYXJ5OiBzdW1tYXJ5LnRyaW0oKSxcclxuICAgICAgICAgICAgb3JpZ2luYWxDb21tZW50XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQWRkIGZhbGxiYWNrIHN1bW1hcmllcyBmb3IgbWlzc2luZyBpdGVtc1xyXG4gICAgY29uc3QgbWlzc2luZ0NvbW1lbnRzID0gYmF0Y2guZmlsdGVyKGNvbW1lbnQgPT4gXHJcbiAgICAgICFzdW1tYXJpZXMuc29tZShzdW1tYXJ5ID0+IHN1bW1hcnkuaWQgPT09IGNvbW1lbnQuaWQpXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBpZiAobWlzc2luZ0NvbW1lbnRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgdGhpcy5kZWJ1ZyhgJHttaXNzaW5nQ29tbWVudHMubGVuZ3RofSBzdW1tYXJpZXMgbWlzc2luZyBmcm9tIEFJIHJlc3BvbnNlLCBhZGRpbmcgZmFsbGJhY2tzYCk7XHJcbiAgICAgIGNvbnN0IGZhbGxiYWNrU3VtbWFyaWVzID0gdGhpcy5jcmVhdGVGYWxsYmFja1N1bW1hcmllcyhtaXNzaW5nQ29tbWVudHMpO1xyXG4gICAgICBzdW1tYXJpZXMucHVzaCguLi5mYWxsYmFja1N1bW1hcmllcyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBzdW1tYXJpZXM7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHBhcnNlQ29udHJhZGljdGlvblJlc3BvbnNlKHJlc3BvbnNlOiBzdHJpbmcsIHN1bW1hcmllczogU3VtbWFyeVJlc3VsdFtdKTogQ29udHJhZGljdGlvblJlc3VsdFtdIHtcclxuICAgIGNvbnN0IGNvbnRyYWRpY3Rpb25zOiBDb250cmFkaWN0aW9uUmVzdWx0W10gPSBbXTtcclxuICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2Uuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpKTtcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XHJcbiAgICAgIGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXkNvbnRyYWRpY3Rpb24gYmV0d2VlbiAoSUQtXFxkKykgYW5kIChJRC1cXGQrKTpcXHMqKC4rKSQvKTtcclxuICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgY29uc3QgWywgaWQxLCBpZDIsIGRlc2NyaXB0aW9uXSA9IG1hdGNoO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHN1bW1hcnkxID0gc3VtbWFyaWVzLmZpbmQocyA9PiBzLmlkID09PSBpZDEpO1xyXG4gICAgICAgIGNvbnN0IHN1bW1hcnkyID0gc3VtbWFyaWVzLmZpbmQocyA9PiBzLmlkID09PSBpZDIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChzdW1tYXJ5MSAmJiBzdW1tYXJ5Mikge1xyXG4gICAgICAgICAgY29uc3QgY29uZmlkZW5jZSA9IHRoaXMuY2FsY3VsYXRlQ29udHJhZGljdGlvbkNvbmZpZGVuY2Uoc3VtbWFyeTEsIHN1bW1hcnkyLCBkZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGNvbnRyYWRpY3Rpb25zLnB1c2goe1xyXG4gICAgICAgICAgICBpZDEsXHJcbiAgICAgICAgICAgIGlkMixcclxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLnRyaW0oKSxcclxuICAgICAgICAgICAgY29uZmlkZW5jZSxcclxuICAgICAgICAgICAgY2F0ZWdvcnk6IHRoaXMuZGV0ZWN0Q2F0ZWdvcnkoZGVzY3JpcHRpb24pXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGNvbnRyYWRpY3Rpb25zXHJcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLmNvbmZpZGVuY2UgLSBhLmNvbmZpZGVuY2UpXHJcbiAgICAgIC5zbGljZSgwLCAxMik7IC8vIExpbWl0IHRvIG1vc3Qgc2lnbmlmaWNhbnRcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlQ29udHJhZGljdGlvbkNvbmZpZGVuY2UoXHJcbiAgICBzdW1tYXJ5MTogU3VtbWFyeVJlc3VsdCwgXHJcbiAgICBzdW1tYXJ5MjogU3VtbWFyeVJlc3VsdCwgXHJcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nXHJcbiAgKTogbnVtYmVyIHtcclxuICAgIGxldCBjb25maWRlbmNlID0gODA7IC8vIEJhc2UgY29uZmlkZW5jZSBmb3IgQUktZGV0ZWN0ZWQgY29udHJhZGljdGlvbnNcclxuICAgIFxyXG4gICAgLy8gVGltZS1iYXNlZCBhZGp1c3RtZW50c1xyXG4gICAgY29uc3QgdGltZURpZmYgPSBNYXRoLmFicyhzdW1tYXJ5Mi5vcmlnaW5hbENvbW1lbnQuZGF0ZSAtIHN1bW1hcnkxLm9yaWdpbmFsQ29tbWVudC5kYXRlKTtcclxuICAgIGNvbnN0IGRheXNEaWZmID0gdGltZURpZmYgLyAoMjQgKiA2MCAqIDYwKTtcclxuICAgIFxyXG4gICAgaWYgKGRheXNEaWZmIDwgMSkge1xyXG4gICAgICBjb25maWRlbmNlIC09IDI1OyAvLyBTYW1lIGRheSBtaWdodCBiZSBjb250ZXh0dWFsXHJcbiAgICB9IGVsc2UgaWYgKGRheXNEaWZmIDwgNykge1xyXG4gICAgICBjb25maWRlbmNlIC09IDE1OyAvLyBTYW1lIHdlZWsgbWlnaHQgYmUgcmVsYXRlZFxyXG4gICAgfSBlbHNlIGlmIChkYXlzRGlmZiA+IDM2NSkge1xyXG4gICAgICBjb25maWRlbmNlIC09IDEwOyAvLyBWZXJ5IG9sZCBtaWdodCBiZSBvcGluaW9uIGV2b2x1dGlvblxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDb250ZW50LWJhc2VkIGFkanVzdG1lbnRzXHJcbiAgICBjb25zdCBzdHJvbmdPcHBvc2l0aW9uID0gWydjb21wbGV0ZWx5IG9wcG9zaXRlJywgJ2RpcmVjdGx5IGNvbnRyYWRpY3RzJywgJ3RvdGFsIHJldmVyc2FsJywgJ2ZsaXAtZmxvcCddO1xyXG4gICAgaWYgKHN0cm9uZ09wcG9zaXRpb24uc29tZShwaHJhc2UgPT4gZGVzY3JpcHRpb24udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhwaHJhc2UpKSkge1xyXG4gICAgICBjb25maWRlbmNlICs9IDE1O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBDb250ZXh0IGFkanVzdG1lbnRzXHJcbiAgICBpZiAoc3VtbWFyeTEub3JpZ2luYWxDb21tZW50LnN1YnJlZGRpdCAhPT0gc3VtbWFyeTIub3JpZ2luYWxDb21tZW50LnN1YnJlZGRpdCkge1xyXG4gICAgICBjb25zdCBjb250ZXh0dWFsU3VicyA9IFsnY2lyY2xlamVyaycsICdzYXRpcmUnLCAnam9rZXMnLCAnbWVtZXMnXTtcclxuICAgICAgaWYgKGNvbnRleHR1YWxTdWJzLnNvbWUoc3ViID0+IFxyXG4gICAgICAgIHN1bW1hcnkxLm9yaWdpbmFsQ29tbWVudC5zdWJyZWRkaXQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzdWIpIHx8XHJcbiAgICAgICAgc3VtbWFyeTIub3JpZ2luYWxDb21tZW50LnN1YnJlZGRpdC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHN1YilcclxuICAgICAgKSkge1xyXG4gICAgICAgIGNvbmZpZGVuY2UgLT0gMjA7IC8vIExpa2VseSBzYXRpcmljYWwgY29udGV4dFxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbmZpZGVuY2UgLT0gNTsgLy8gRGlmZmVyZW50IGNvbnRleHRzXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIE1hdGgubWF4KDUwLCBNYXRoLm1pbig5NSwgY29uZmlkZW5jZSkpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVGYWxsYmFja1N1bW1hcmllcyhjb21tZW50czogQ29tbWVudFdpdGhJZFtdKTogU3VtbWFyeVJlc3VsdFtdIHtcclxuICAgIHJldHVybiBjb21tZW50cy5tYXAoY29tbWVudCA9PiAoe1xyXG4gICAgICBpZDogY29tbWVudC5pZCxcclxuICAgICAgc3VtbWFyeTogdGhpcy5jcmVhdGVFbmhhbmNlZFN1bW1hcnkoY29tbWVudCksXHJcbiAgICAgIG9yaWdpbmFsQ29tbWVudDogY29tbWVudFxyXG4gICAgfSkpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVFbmhhbmNlZFN1bW1hcnkoY29tbWVudDogQ29tbWVudFdpdGhJZCk6IHN0cmluZyB7XHJcbiAgICBjb25zdCB0ZXh0ID0gY29tbWVudC50ZXh0O1xyXG4gICAgY29uc3QgdHJ1bmNhdGVkID0gdGV4dC5sZW5ndGggPiAyMDAgPyB0ZXh0LnN1YnN0cmluZygwLCAyMDApICsgJy4uLicgOiB0ZXh0O1xyXG4gICAgY29uc3Qgc2VudGltZW50ID0gdGhpcy5kZXRlY3RBZHZhbmNlZFNlbnRpbWVudCh0ZXh0KTtcclxuICAgIGNvbnN0IHN0YW5jZSA9IHRoaXMuZGV0ZWN0U3RhbmNlKHRleHQpO1xyXG4gICAgY29uc3QgaW50ZW5zaXR5ID0gdGhpcy5kZXRlY3RJbnRlbnNpdHkodGV4dCk7XHJcbiAgICBcclxuICAgIHJldHVybiBgJHt0cnVuY2F0ZWR9ICgke3NlbnRpbWVudH0gc2VudGltZW50LCAke3N0YW5jZX0gc3RhbmNlLCAke2ludGVuc2l0eX0gaW50ZW5zaXR5KWA7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGRldGVjdEFkdmFuY2VkU2VudGltZW50KHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBwb3NpdGl2ZSA9IFsnZ29vZCcsICdncmVhdCcsICdsb3ZlJywgJ2xpa2UnLCAnYW1hemluZycsICdhd2Vzb21lJywgJ2V4Y2VsbGVudCcsICdmYW50YXN0aWMnLCAnd29uZGVyZnVsJywgJ3N1cHBvcnQnXTtcclxuICAgIGNvbnN0IG5lZ2F0aXZlID0gWydiYWQnLCAnaGF0ZScsICd0ZXJyaWJsZScsICdhd2Z1bCcsICdob3JyaWJsZScsICd3b3JzdCcsICdzdWNrcycsICdkaXNndXN0aW5nJywgJ3BhdGhldGljJywgJ29wcG9zZSddO1xyXG4gICAgXHJcbiAgICBjb25zdCBsb3dlciA9IHRleHQudG9Mb3dlckNhc2UoKTtcclxuICAgIGNvbnN0IHBvc0NvdW50ID0gcG9zaXRpdmUuZmlsdGVyKHdvcmQgPT4gbG93ZXIuaW5jbHVkZXMod29yZCkpLmxlbmd0aDtcclxuICAgIGNvbnN0IG5lZ0NvdW50ID0gbmVnYXRpdmUuZmlsdGVyKHdvcmQgPT4gbG93ZXIuaW5jbHVkZXMod29yZCkpLmxlbmd0aDtcclxuICAgIFxyXG4gICAgaWYgKHBvc0NvdW50ID4gbmVnQ291bnQgKyAxKSByZXR1cm4gJ3Bvc2l0aXZlJztcclxuICAgIGlmIChuZWdDb3VudCA+IHBvc0NvdW50ICsgMSkgcmV0dXJuICduZWdhdGl2ZSc7XHJcbiAgICByZXR1cm4gJ25ldXRyYWwnO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBkZXRlY3RTdGFuY2UodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGxvd2VyID0gdGV4dC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgXHJcbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ3N0cm9uZ2x5JykgfHwgbG93ZXIuaW5jbHVkZXMoJ2Fic29sdXRlbHknKSB8fCBsb3dlci5pbmNsdWRlcygnZGVmaW5pdGVseScpKSByZXR1cm4gJ3N0cm9uZyc7XHJcbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ21heWJlJykgfHwgbG93ZXIuaW5jbHVkZXMoJ3BlcmhhcHMnKSB8fCBsb3dlci5pbmNsdWRlcygnbWlnaHQnKSkgcmV0dXJuICd0ZW50YXRpdmUnO1xyXG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdhbHdheXMnKSB8fCBsb3dlci5pbmNsdWRlcygnbmV2ZXInKSB8fCBsb3dlci5pbmNsdWRlcygnY29tcGxldGVseScpKSByZXR1cm4gJ2Fic29sdXRlJztcclxuICAgIFxyXG4gICAgcmV0dXJuICdtb2RlcmF0ZSc7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGRldGVjdEludGVuc2l0eSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgaW50ZW5zaWZpZXJzID0gWyd2ZXJ5JywgJ2V4dHJlbWVseScsICdhYnNvbHV0ZWx5JywgJ2NvbXBsZXRlbHknLCAndG90YWxseScsICdyZWFsbHknLCAnc28gbXVjaCddO1xyXG4gICAgY29uc3QgbG93ZXIgPSB0ZXh0LnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBpbnRlbnNpZmllckNvdW50ID0gaW50ZW5zaWZpZXJzLmZpbHRlcih3b3JkID0+IGxvd2VyLmluY2x1ZGVzKHdvcmQpKS5sZW5ndGg7XHJcbiAgICBcclxuICAgIGlmIChpbnRlbnNpZmllckNvdW50ID4gMiB8fCB0ZXh0LmluY2x1ZGVzKCchISEnKSB8fCAvW0EtWl17Myx9Ly50ZXN0KHRleHQpKSByZXR1cm4gJ2hpZ2gnO1xyXG4gICAgaWYgKGludGVuc2lmaWVyQ291bnQgPiAwIHx8IHRleHQuaW5jbHVkZXMoJyEhJykpIHJldHVybiAnbWVkaXVtJztcclxuICAgIHJldHVybiAnbG93JztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlRmFsbGJhY2tDb250cmFkaWN0aW9ucyhzdW1tYXJpZXM6IFN1bW1hcnlSZXN1bHRbXSk6IENvbnRyYWRpY3Rpb25SZXN1bHRbXSB7XHJcbiAgICBjb25zdCBjb250cmFkaWN0aW9uczogQ29udHJhZGljdGlvblJlc3VsdFtdID0gW107XHJcbiAgICBcclxuICAgIC8vIEVuaGFuY2VkIHNlbWFudGljIGNvbnRyYWRpY3Rpb24gZGV0ZWN0aW9uXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN1bW1hcmllcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBmb3IgKGxldCBqID0gaSArIDE7IGogPCBzdW1tYXJpZXMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICBjb25zdCBzdW1tYXJ5MSA9IHN1bW1hcmllc1tpXTtcclxuICAgICAgICBjb25zdCBzdW1tYXJ5MiA9IHN1bW1hcmllc1tqXTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBTa2lwIGlmIHNhbWUgY29udGV4dCBhbmQgY2xvc2UgaW4gdGltZVxyXG4gICAgICAgIGNvbnN0IHRpbWVEaWZmID0gTWF0aC5hYnMoc3VtbWFyeTIub3JpZ2luYWxDb21tZW50LmRhdGUgLSBzdW1tYXJ5MS5vcmlnaW5hbENvbW1lbnQuZGF0ZSk7XHJcbiAgICAgICAgY29uc3QgZGF5c0RpZmYgPSB0aW1lRGlmZiAvICgyNCAqIDYwICogNjApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChzdW1tYXJ5MS5vcmlnaW5hbENvbW1lbnQuc3VicmVkZGl0ID09PSBzdW1tYXJ5Mi5vcmlnaW5hbENvbW1lbnQuc3VicmVkZGl0ICYmIGRheXNEaWZmIDwgMSkge1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGNvbnRyYWRpY3Rpb25UeXBlID0gdGhpcy5kZXRlY3RTZW1hbnRpY0NvbnRyYWRpY3Rpb24oc3VtbWFyeTEuc3VtbWFyeSwgc3VtbWFyeTIuc3VtbWFyeSk7XHJcbiAgICAgICAgaWYgKGNvbnRyYWRpY3Rpb25UeXBlKSB7XHJcbiAgICAgICAgICBjb250cmFkaWN0aW9ucy5wdXNoKHtcclxuICAgICAgICAgICAgaWQxOiBzdW1tYXJ5MS5pZCxcclxuICAgICAgICAgICAgaWQyOiBzdW1tYXJ5Mi5pZCxcclxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGAke2NvbnRyYWRpY3Rpb25UeXBlLmRlc2NyaXB0aW9ufSAoZW5oYW5jZWQgZmFsbGJhY2sgYW5hbHlzaXMpYCxcclxuICAgICAgICAgICAgY29uZmlkZW5jZTogY29udHJhZGljdGlvblR5cGUuY29uZmlkZW5jZSxcclxuICAgICAgICAgICAgY2F0ZWdvcnk6IGNvbnRyYWRpY3Rpb25UeXBlLmNhdGVnb3J5XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGNvbnRyYWRpY3Rpb25zXHJcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBiLmNvbmZpZGVuY2UgLSBhLmNvbmZpZGVuY2UpXHJcbiAgICAgIC5zbGljZSgwLCA2KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZGV0ZWN0U2VtYW50aWNDb250cmFkaWN0aW9uKHRleHQxOiBzdHJpbmcsIHRleHQyOiBzdHJpbmcpOiB7XHJcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gICAgY29uZmlkZW5jZTogbnVtYmVyO1xyXG4gICAgY2F0ZWdvcnk6IHN0cmluZztcclxuICB9IHwgbnVsbCB7XHJcbiAgICBjb25zdCBsb3dlcjEgPSB0ZXh0MS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgbG93ZXIyID0gdGV4dDIudG9Mb3dlckNhc2UoKTtcclxuICAgIFxyXG4gICAgLy8gRW5oYW5jZWQgb3Bwb3NpdGlvbiBwYXR0ZXJuc1xyXG4gICAgY29uc3Qgb3Bwb3NpdGlvblBhdHRlcm5zID0gW1xyXG4gICAgICB7IFxyXG4gICAgICAgIHBvczogWydzdHJvbmdseSBzdXBwb3J0JywgJ2Fic29sdXRlbHkgbG92ZScsICdjb21wbGV0ZWx5IGFncmVlJ10sIFxyXG4gICAgICAgIG5lZzogWydzdHJvbmdseSBvcHBvc2UnLCAnYWJzb2x1dGVseSBoYXRlJywgJ2NvbXBsZXRlbHkgZGlzYWdyZWUnXSwgXHJcbiAgICAgICAgY29uZjogODUsXHJcbiAgICAgICAgZGVzYzogJ1N0cm9uZyBvcHBvc2luZyBwb3NpdGlvbnMnXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgXHJcbiAgICAgICAgcG9zOiBbJ3N1cHBvcnQnLCAnZmF2b3InLCAnZW5kb3JzZSddLCBcclxuICAgICAgICBuZWc6IFsnb3Bwb3NlJywgJ2FnYWluc3QnLCAncmVqZWN0J10sIFxyXG4gICAgICAgIGNvbmY6IDc1LFxyXG4gICAgICAgIGRlc2M6ICdPcHBvc2luZyB2aWV3cG9pbnRzJ1xyXG4gICAgICB9LFxyXG4gICAgICB7IFxyXG4gICAgICAgIHBvczogWydsb3ZlJywgJ2Vuam95JywgJ2xpa2UnXSwgXHJcbiAgICAgICAgbmVnOiBbJ2hhdGUnLCAnZGVzcGlzZScsICdkaXNsaWtlJ10sIFxyXG4gICAgICAgIGNvbmY6IDcwLFxyXG4gICAgICAgIGRlc2M6ICdDb250cmFkaWN0b3J5IHByZWZlcmVuY2VzJ1xyXG4gICAgICB9XHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2Ygb3Bwb3NpdGlvblBhdHRlcm5zKSB7XHJcbiAgICAgIGNvbnN0IGhhc1BvczEgPSBwYXR0ZXJuLnBvcy5zb21lKHAgPT4gbG93ZXIxLmluY2x1ZGVzKHApKTtcclxuICAgICAgY29uc3QgaGFzTmVnMSA9IHBhdHRlcm4ubmVnLnNvbWUobiA9PiBsb3dlcjEuaW5jbHVkZXMobikpO1xyXG4gICAgICBjb25zdCBoYXNQb3MyID0gcGF0dGVybi5wb3Muc29tZShwID0+IGxvd2VyMi5pbmNsdWRlcyhwKSk7XHJcbiAgICAgIGNvbnN0IGhhc05lZzIgPSBwYXR0ZXJuLm5lZy5zb21lKG4gPT4gbG93ZXIyLmluY2x1ZGVzKG4pKTtcclxuICAgICAgXHJcbiAgICAgIGlmICgoaGFzUG9zMSAmJiBoYXNOZWcyKSB8fCAoaGFzTmVnMSAmJiBoYXNQb3MyKSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogYCR7cGF0dGVybi5kZXNjfTogY29uZmxpY3Rpbmcgc3RhbmNlcyBkZXRlY3RlZGAsXHJcbiAgICAgICAgICBjb25maWRlbmNlOiBwYXR0ZXJuLmNvbmYsXHJcbiAgICAgICAgICBjYXRlZ29yeTogdGhpcy5kZXRlY3RDYXRlZ29yeSh0ZXh0MSArICcgJyArIHRleHQyKVxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGRldGVjdENhdGVnb3J5KGRlc2NyaXB0aW9uOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgbG93ZXIgPSBkZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpO1xyXG4gICAgXHJcbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ3BvbGl0aWMnKSB8fCBsb3dlci5pbmNsdWRlcygnZ292ZXJubWVudCcpIHx8IGxvd2VyLmluY2x1ZGVzKCdlbGVjdGlvbicpIHx8IGxvd2VyLmluY2x1ZGVzKCd2b3RlJykpIHJldHVybiAncG9saXRpY2FsJztcclxuICAgIGlmIChsb3dlci5pbmNsdWRlcygnZm9vZCcpIHx8IGxvd2VyLmluY2x1ZGVzKCdwcmVmZXJlbmNlJykgfHwgbG93ZXIuaW5jbHVkZXMoJ3Rhc3RlJykgfHwgbG93ZXIuaW5jbHVkZXMoJ2xpa2UnKSB8fCBsb3dlci5pbmNsdWRlcygnbG92ZScpKSByZXR1cm4gJ3BlcnNvbmFsLXByZWZlcmVuY2UnO1xyXG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCdmYWN0JykgfHwgbG93ZXIuaW5jbHVkZXMoJ3RydXRoJykgfHwgbG93ZXIuaW5jbHVkZXMoJ2V2aWRlbmNlJykgfHwgbG93ZXIuaW5jbHVkZXMoJ3NjaWVuY2UnKSkgcmV0dXJuICdmYWN0dWFsJztcclxuICAgIGlmIChsb3dlci5pbmNsdWRlcygncmVsYXRpb25zaGlwJykgfHwgbG93ZXIuaW5jbHVkZXMoJ2RhdGluZycpIHx8IGxvd2VyLmluY2x1ZGVzKCdtYXJyaWFnZScpIHx8IGxvd2VyLmluY2x1ZGVzKCdmYW1pbHknKSkgcmV0dXJuICdyZWxhdGlvbnNoaXAnO1xyXG4gICAgaWYgKGxvd2VyLmluY2x1ZGVzKCd0ZWNobm9sb2d5JykgfHwgbG93ZXIuaW5jbHVkZXMoJ3RlY2gnKSB8fCBsb3dlci5pbmNsdWRlcygnc29mdHdhcmUnKSB8fCBsb3dlci5pbmNsdWRlcygnY29tcHV0ZXInKSkgcmV0dXJuICd0ZWNobm9sb2d5JztcclxuICAgIGlmIChsb3dlci5pbmNsdWRlcygnZW50ZXJ0YWlubWVudCcpIHx8IGxvd2VyLmluY2x1ZGVzKCdtb3ZpZScpIHx8IGxvd2VyLmluY2x1ZGVzKCdnYW1lJykgfHwgbG93ZXIuaW5jbHVkZXMoJ211c2ljJykpIHJldHVybiAnZW50ZXJ0YWlubWVudCc7XHJcbiAgICBpZiAobG93ZXIuaW5jbHVkZXMoJ2xpZmVzdHlsZScpIHx8IGxvd2VyLmluY2x1ZGVzKCdoZWFsdGgnKSB8fCBsb3dlci5pbmNsdWRlcygnZml0bmVzcycpIHx8IGxvd2VyLmluY2x1ZGVzKCdkaWV0JykpIHJldHVybiAnbGlmZXN0eWxlJztcclxuICAgIFxyXG4gICAgcmV0dXJuICdvcGluaW9uJztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2VuZXJhdGVSZXBvcnQoXHJcbiAgICBhbGxDb21tZW50czogQ29tbWVudFdpdGhJZFtdLCBcclxuICAgIHN1bW1hcmllczogU3VtbWFyeVJlc3VsdFtdLCBcclxuICAgIGNvbnRyYWRpY3Rpb25zOiBDb250cmFkaWN0aW9uUmVzdWx0W10sIFxyXG4gICAgdXNlcm5hbWU6IHN0cmluZ1xyXG4gICk6IEFuYWx5c2lzUmVwb3J0IHtcclxuICAgIC8vIENvbnZlcnQgY29udHJhZGljdGlvbnMgdG8gZXhwZWN0ZWQgZm9ybWF0XHJcbiAgICBjb25zdCBmb3JtYXR0ZWRDb250cmFkaWN0aW9ucyA9IGNvbnRyYWRpY3Rpb25zLm1hcChjID0+IHtcclxuICAgICAgY29uc3QgY29tbWVudDEgPSBzdW1tYXJpZXMuZmluZChzID0+IHMuaWQgPT09IGMuaWQxKT8ub3JpZ2luYWxDb21tZW50O1xyXG4gICAgICBjb25zdCBjb21tZW50MiA9IHN1bW1hcmllcy5maW5kKHMgPT4gcy5pZCA9PT0gYy5pZDIpPy5vcmlnaW5hbENvbW1lbnQ7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBgJHtjLmlkMX0tJHtjLmlkMn1gLFxyXG4gICAgICAgIHN0YXRlbWVudDE6IGNvbW1lbnQxPy50ZXh0LnN1YnN0cmluZygwLCA0MDApIHx8ICdTdGF0ZW1lbnQgbm90IGZvdW5kJyxcclxuICAgICAgICBzdGF0ZW1lbnQyOiBjb21tZW50Mj8udGV4dC5zdWJzdHJpbmcoMCwgNDAwKSB8fCAnU3RhdGVtZW50IG5vdCBmb3VuZCcsXHJcbiAgICAgICAgZGF0ZXM6IFtcclxuICAgICAgICAgIG5ldyBEYXRlKChjb21tZW50MT8uZGF0ZSB8fCAwKSAqIDEwMDApLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICBuZXcgRGF0ZSgoY29tbWVudDI/LmRhdGUgfHwgMCkgKiAxMDAwKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgXSBhcyBbc3RyaW5nLCBzdHJpbmddLFxyXG4gICAgICAgIHN1YnJlZGRpdHM6IFtcclxuICAgICAgICAgIGNvbW1lbnQxPy5zdWJyZWRkaXQgfHwgJ3Vua25vd24nLFxyXG4gICAgICAgICAgY29tbWVudDI/LnN1YnJlZGRpdCB8fCAndW5rbm93bidcclxuICAgICAgICBdIGFzIFtzdHJpbmcsIHN0cmluZ10sXHJcbiAgICAgICAgY29uZmlkZW5jZVNjb3JlOiBjLmNvbmZpZGVuY2UsXHJcbiAgICAgICAgY29udGV4dDogYy5kZXNjcmlwdGlvbixcclxuICAgICAgICB1cHZvdGVzOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA1MCkgKyAxMCxcclxuICAgICAgICBkb3dudm90ZXM6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKSxcclxuICAgICAgICB2ZXJpZmllZDogYy5jb25maWRlbmNlID4gODAsXHJcbiAgICAgICAgY2F0ZWdvcnk6IGMuY2F0ZWdvcnkgYXMgYW55LFxyXG4gICAgICAgIHJlcXVpcmVzSHVtYW5SZXZpZXc6IGMuY29uZmlkZW5jZSA8IDcwXHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBHZW5lcmF0ZSB0aW1lbGluZVxyXG4gICAgY29uc3QgdGltZWxpbmUgPSBhbGxDb21tZW50cy5zbGljZSgtMjApLm1hcChjb21tZW50ID0+ICh7XHJcbiAgICAgIGRhdGU6IG5ldyBEYXRlKGNvbW1lbnQuZGF0ZSAqIDEwMDApLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIGV2ZW50OiBjb21tZW50LnRleHQuc3Vic3RyaW5nKDAsIDEwMCksXHJcbiAgICAgIHN1YnJlZGRpdDogY29tbWVudC5zdWJyZWRkaXQsXHJcbiAgICAgIHNjb3JlOiBjb21tZW50LnNjb3JlXHJcbiAgICB9KSk7XHJcblxyXG4gICAgLy8gQ2FsY3VsYXRlIHN0YXRzXHJcbiAgICBjb25zdCBzdGF0cyA9IHRoaXMuY2FsY3VsYXRlU3RhdHMoYWxsQ29tbWVudHMpO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1bW1hcnk6IHRoaXMuZ2VuZXJhdGVTdW1tYXJ5KGZvcm1hdHRlZENvbnRyYWRpY3Rpb25zLCBzdGF0cywgYWxsQ29tbWVudHMubGVuZ3RoLCB1c2VybmFtZSksXHJcbiAgICAgIGNvbnRyYWRpY3Rpb25zOiBmb3JtYXR0ZWRDb250cmFkaWN0aW9ucyxcclxuICAgICAgdGltZWxpbmUsXHJcbiAgICAgIHN0YXRzXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjYWxjdWxhdGVTdGF0cyhjb21tZW50czogQ29tbWVudFdpdGhJZFtdKSB7XHJcbiAgICBpZiAoY29tbWVudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgdG90YWxDb21tZW50czogMCxcclxuICAgICAgICB0aW1lc3BhbjogJzAgZGF5cycsXHJcbiAgICAgICAgdG9wU3VicmVkZGl0czogW10sXHJcbiAgICAgICAgc2VudGltZW50VHJlbmQ6IDBcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBvbGRlc3QgPSBNYXRoLm1pbiguLi5jb21tZW50cy5tYXAoYyA9PiBjLmRhdGUpKTtcclxuICAgIGNvbnN0IG5ld2VzdCA9IE1hdGgubWF4KC4uLmNvbW1lbnRzLm1hcChjID0+IGMuZGF0ZSkpO1xyXG4gICAgY29uc3QgZGlmZkRheXMgPSBNYXRoLmZsb29yKChuZXdlc3QgLSBvbGRlc3QpIC8gKDI0ICogNjAgKiA2MCkpO1xyXG4gICAgXHJcbiAgICBjb25zdCB0aW1lc3BhbiA9IGRpZmZEYXlzIDwgMzAgPyBgJHtkaWZmRGF5c30gZGF5c2AgOiBcclxuICAgICAgICAgICAgICAgICAgICBkaWZmRGF5cyA8IDM2NSA/IGAke01hdGguZmxvb3IoZGlmZkRheXMgLyAzMCl9IG1vbnRoc2AgOiBcclxuICAgICAgICAgICAgICAgICAgICBgJHtNYXRoLmZsb29yKGRpZmZEYXlzIC8gMzY1KX0geWVhcnNgO1xyXG5cclxuICAgIGNvbnN0IHN1YnJlZGRpdENvdW50czogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfSA9IHt9O1xyXG4gICAgY29tbWVudHMuZm9yRWFjaChjb21tZW50ID0+IHtcclxuICAgICAgc3VicmVkZGl0Q291bnRzW2NvbW1lbnQuc3VicmVkZGl0XSA9IChzdWJyZWRkaXRDb3VudHNbY29tbWVudC5zdWJyZWRkaXRdIHx8IDApICsgMTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IHRvcFN1YnJlZGRpdHMgPSBPYmplY3QuZW50cmllcyhzdWJyZWRkaXRDb3VudHMpXHJcbiAgICAgIC5zb3J0KChbLGFdLCBbLGJdKSA9PiBiIC0gYSlcclxuICAgICAgLnNsaWNlKDAsIDUpXHJcbiAgICAgIC5tYXAoKFtzdWJyZWRkaXRdKSA9PiBzdWJyZWRkaXQpO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRvdGFsQ29tbWVudHM6IGNvbW1lbnRzLmxlbmd0aCxcclxuICAgICAgdGltZXNwYW4sXHJcbiAgICAgIHRvcFN1YnJlZGRpdHMsXHJcbiAgICAgIHNlbnRpbWVudFRyZW5kOiAwXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZW5lcmF0ZVN1bW1hcnkoY29udHJhZGljdGlvbnM6IGFueVtdLCBzdGF0czogYW55LCB0b3RhbENvbW1lbnRzOiBudW1iZXIsIHVzZXJuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgYnVkZ2V0U3RhdHVzID0gdG9rZW5CdWRnZXQuZ2V0QnVkZ2V0U3RhdHVzKCk7XHJcbiAgICBjb25zdCBhbmFseXNpc01ldGhvZCA9IHRoaXMuaXNBdmFpbGFibGUgJiYgIWJ1ZGdldFN0YXR1cy5pc0V4Y2VlZGVkID8gJ0FJLXBvd2VyZWQnIDogJ0VuaGFuY2VkIGZhbGxiYWNrJztcclxuICAgIFxyXG4gICAgaWYgKGNvbnRyYWRpY3Rpb25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gYCR7YW5hbHlzaXNNZXRob2R9IGFuYWx5c2lzIGNvbXBsZXRlIGZvciAke3VzZXJuYW1lfS4gTm8gc2lnbmlmaWNhbnQgY29udHJhZGljdGlvbnMgZGV0ZWN0ZWQgYWNyb3NzICR7dG90YWxDb21tZW50c30gc3RhdGVtZW50cyBzcGFubmluZyAke3N0YXRzLnRpbWVzcGFufS4gVXNlciBtYWludGFpbnMgY29uc2lzdGVudCBwb3NpdGlvbnMgYWNyb3NzIHRvcGljcyBhbmQgdGltZSBwZXJpb2RzLmA7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaGlnaENvbmZpZGVuY2VDb3VudCA9IGNvbnRyYWRpY3Rpb25zLmZpbHRlcihjID0+IGMuY29uZmlkZW5jZVNjb3JlID4gODApLmxlbmd0aDtcclxuICAgIGNvbnN0IGh1bWFuUmV2aWV3Q291bnQgPSBjb250cmFkaWN0aW9ucy5maWx0ZXIoYyA9PiBjLnJlcXVpcmVzSHVtYW5SZXZpZXcpLmxlbmd0aDtcclxuICAgIFxyXG4gICAgbGV0IHN1bW1hcnkgPSBgJHthbmFseXNpc01ldGhvZH0gYW5hbHlzaXMgcmV2ZWFscyAke2NvbnRyYWRpY3Rpb25zLmxlbmd0aH0gcG90ZW50aWFsIGNvbnRyYWRpY3Rpb25zIGFjcm9zcyAke3RvdGFsQ29tbWVudHN9IHN0YXRlbWVudHMgc3Bhbm5pbmcgJHtzdGF0cy50aW1lc3Bhbn0uIGA7XHJcbiAgICBcclxuICAgIGlmIChoaWdoQ29uZmlkZW5jZUNvdW50ID4gMCkge1xyXG4gICAgICBzdW1tYXJ5ICs9IGAke2hpZ2hDb25maWRlbmNlQ291bnR9IGNvbnRyYWRpY3Rpb25zIHNob3cgaGlnaCBjb25maWRlbmNlICg+ODAlKS4gYDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKGh1bWFuUmV2aWV3Q291bnQgPiAwKSB7XHJcbiAgICAgIHN1bW1hcnkgKz0gYCR7aHVtYW5SZXZpZXdDb3VudH0gZmluZGluZ3MgcmVxdWlyZSBodW1hbiByZXZpZXcgZHVlIHRvIGNvbnRleHQgY29tcGxleGl0eS4gYDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHRoaXMuaXNBdmFpbGFibGUpIHtcclxuICAgICAgc3VtbWFyeSArPSBgQW5hbHlzaXMgdXNlZCBvcHRpbWl6ZWQgMi1zdGFnZSBwaXBlbGluZSB3aXRoIGJ1ZGdldC1hd2FyZSBtb2RlbCBzZWxlY3Rpb24uYDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHN1bW1hcnkgKz0gYEFuYWx5c2lzIHVzZWQgZW5oYW5jZWQgc2VtYW50aWMgZGV0ZWN0aW9uIHdpdGggbG9jYWwgcHJvY2Vzc2luZy5gO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBzdW1tYXJ5O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVFbXB0eVJlcG9ydCh1c2VybmFtZTogc3RyaW5nKTogQW5hbHlzaXNSZXBvcnQge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VtbWFyeTogYE5vIGNvbnRlbnQgYXZhaWxhYmxlIGZvciBhbmFseXNpcyBmb3IgdXNlciAke3VzZXJuYW1lfS5gLFxyXG4gICAgICBjb250cmFkaWN0aW9uczogW10sXHJcbiAgICAgIHRpbWVsaW5lOiBbXSxcclxuICAgICAgc3RhdHM6IHtcclxuICAgICAgICB0b3RhbENvbW1lbnRzOiAwLFxyXG4gICAgICAgIHRpbWVzcGFuOiAnMCBkYXlzJyxcclxuICAgICAgICB0b3BTdWJyZWRkaXRzOiBbXSxcclxuICAgICAgICBzZW50aW1lbnRUcmVuZDogMFxyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjcmVhdGVFcnJvclJlcG9ydCh1c2VybmFtZTogc3RyaW5nLCBlcnJvcjogYW55KTogQW5hbHlzaXNSZXBvcnQge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VtbWFyeTogYEFuYWx5c2lzIGZhaWxlZCBmb3IgJHt1c2VybmFtZX06ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvciBvY2N1cnJlZCd9YCxcclxuICAgICAgY29udHJhZGljdGlvbnM6IFtdLFxyXG4gICAgICB0aW1lbGluZTogW10sXHJcbiAgICAgIHN0YXRzOiB7XHJcbiAgICAgICAgdG90YWxDb21tZW50czogMCxcclxuICAgICAgICB0aW1lc3BhbjogJzAgZGF5cycsXHJcbiAgICAgICAgdG9wU3VicmVkZGl0czogW10sXHJcbiAgICAgICAgc2VudGltZW50VHJlbmQ6IDBcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY3JlYXRlRmFsbGJhY2tSZXBvcnQoY29tbWVudHM6IENvbW1lbnRXaXRoSWRbXSwgdXNlcm5hbWU6IHN0cmluZyk6IEFuYWx5c2lzUmVwb3J0IHtcclxuICAgIGNvbnN0IHN1bW1hcmllcyA9IHRoaXMuY3JlYXRlRmFsbGJhY2tTdW1tYXJpZXMoY29tbWVudHMpO1xyXG4gICAgY29uc3QgY29udHJhZGljdGlvbnMgPSB0aGlzLmNyZWF0ZUZhbGxiYWNrQ29udHJhZGljdGlvbnMoc3VtbWFyaWVzKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVSZXBvcnQoY29tbWVudHMsIHN1bW1hcmllcywgY29udHJhZGljdGlvbnMsIHVzZXJuYW1lKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBtdWx0aU1vZGVsUGlwZWxpbmUgPSBuZXcgTXVsdGlNb2RlbFBpcGVsaW5lKCk7Il0sIm5hbWVzIjpbImNhY2hlU2VydmljZSIsInRva2VuQnVkZ2V0IiwiTXVsdGlNb2RlbFBpcGVsaW5lIiwiY29uc3RydWN0b3IiLCJhcGlLZXkiLCJiYXNlVXJsIiwiaXNBdmFpbGFibGUiLCJ2ZXJib3NlIiwic3VtbWFyaXplck1vZGVsIiwiY29udHJhZGljdGlvbk1vZGVsIiwicHJlbWl1bVN1bW1hcml6ZXJNb2RlbCIsInByZW1pdW1Db250cmFkaWN0aW9uTW9kZWwiLCJwcm9jZXNzIiwiZW52IiwiT1BFTlJPVVRFUl9BUElfS0VZIiwiY29uc29sZSIsIndhcm4iLCJkZWJ1ZyIsImVycm9yIiwic2V0VmVyYm9zZSIsImFyZ3MiLCJsb2ciLCJhbmFseXplVXNlciIsImNvbW1lbnRzIiwicG9zdHMiLCJ1c2VybmFtZSIsImxlbmd0aCIsImNhY2hlZFJlc3VsdCIsImdldEFuYWx5c2lzIiwiYWxsQ29tbWVudHMiLCJjb252ZXJ0QW5kRGVkdXBsaWNhdGVDb21tZW50cyIsImNyZWF0ZUVtcHR5UmVwb3J0IiwiYnVkZ2V0U3RhdHVzIiwiZ2V0QnVkZ2V0U3RhdHVzIiwiaXNFeGNlZWRlZCIsImNyZWF0ZUZhbGxiYWNrUmVwb3J0Iiwic3VtbWFyaWVzIiwib3B0aW1pemVkU3VtbWFyaXphdGlvbiIsImNvbnRyYWRpY3Rpb25zIiwiYW5hbHl6ZUNvbnRyYWRpY3Rpb25zIiwicmVwb3J0IiwiZ2VuZXJhdGVSZXBvcnQiLCJzZXRBbmFseXNpcyIsImNyZWF0ZUVycm9yUmVwb3J0IiwiYWxsSXRlbXMiLCJpZENvdW50ZXIiLCJmb3JFYWNoIiwiY29tbWVudCIsImJvZHkiLCJwdXNoIiwiaWQiLCJ0ZXh0IiwiZGF0ZSIsImNyZWF0ZWRfdXRjIiwic3VicmVkZGl0Iiwic2NvcmUiLCJwZXJtYWxpbmsiLCJ0eXBlIiwiY29udGV4dCIsImxpbmtfdGl0bGUiLCJwb3N0Iiwic2VsZnRleHQiLCJmdWxsVGV4dCIsInRpdGxlIiwidHJpbSIsImRlZHVwbGljYXRlZCIsInNtYXJ0RGVkdXBsaWNhdGlvbiIsInNvcnQiLCJhIiwiYiIsIml0ZW1zIiwiY2x1c3RlcnMiLCJNYXAiLCJpdGVtIiwic2lnbmF0dXJlIiwiY3JlYXRlQ29udGVudFNpZ25hdHVyZSIsImhhcyIsInNldCIsImdldCIsImNsdXN0ZXIiLCJ2YWx1ZXMiLCJiZXN0IiwicmVkdWNlIiwiY3VycmVudCIsIm5vcm1hbGl6ZWQiLCJ0b0xvd2VyQ2FzZSIsInJlcGxhY2UiLCJzdWJzdHJpbmciLCJjcmVhdGVGYWxsYmFja1N1bW1hcmllcyIsIm1heFRva2Vuc1BlckJhdGNoIiwiYmF0Y2hlcyIsImNyZWF0ZUR5bmFtaWNCYXRjaGVzIiwiYWxsU3VtbWFyaWVzIiwidXNlTW9kZWwiLCJyZW1haW5pbmciLCJpIiwiYmF0Y2giLCJwcm9tcHQiLCJidWlsZE9wdGltaXplZFN1bW1hcml6YXRpb25Qcm9tcHQiLCJlc3RpbWF0ZWRUb2tlbnMiLCJlc3RpbWF0ZVRva2VucyIsImNhbkFmZm9yZCIsImZhbGxiYWNrU3VtbWFyaWVzIiwiYmF0Y2hTdW1tYXJpZXMiLCJzdW1tYXJpemVCYXRjaCIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImN1cnJlbnRCYXRjaCIsImN1cnJlbnRUb2tlbnMiLCJjb21tZW50VG9rZW5zIiwiY29tbWVudHNUZXh0IiwibWFwIiwiZGF0ZVN0ciIsIkRhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJqb2luIiwibW9kZWwiLCJyZXNwb25zZSIsIm1ha2VPcGVuUm91dGVyUmVxdWVzdCIsInBhcnNlU3VtbWFyaXphdGlvblJlc3BvbnNlIiwiY3JlYXRlRmFsbGJhY2tDb250cmFkaWN0aW9ucyIsImJ1aWxkT3B0aW1pemVkQ29udHJhZGljdGlvblByb21wdCIsInBhcnNlQ29udHJhZGljdGlvblJlc3BvbnNlIiwic3VtbWFyaWVzVGV4dCIsInMiLCJzdW1tYXJ5IiwiRXJyb3IiLCJpbnB1dFRva2VucyIsIm1heE91dHB1dFRva2VucyIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIndpbmRvdyIsImxvY2F0aW9uIiwib3JpZ2luIiwiSlNPTiIsInN0cmluZ2lmeSIsIm1lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJ0ZW1wZXJhdHVyZSIsIm1heF90b2tlbnMiLCJ0b3BfcCIsIm9rIiwiZXJyb3JEYXRhIiwianNvbiIsImNhdGNoIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImRhdGEiLCJyZXNwb25zZVRleHQiLCJjaG9pY2VzIiwibWVzc2FnZSIsIm91dHB1dFRva2VucyIsInJlY29yZFVzYWdlIiwibGluZXMiLCJzcGxpdCIsImZpbHRlciIsImxpbmUiLCJtYXRjaCIsIm9yaWdpbmFsQ29tbWVudCIsImZpbmQiLCJjIiwibWlzc2luZ0NvbW1lbnRzIiwic29tZSIsImlkMSIsImlkMiIsImRlc2NyaXB0aW9uIiwic3VtbWFyeTEiLCJzdW1tYXJ5MiIsImNvbmZpZGVuY2UiLCJjYWxjdWxhdGVDb250cmFkaWN0aW9uQ29uZmlkZW5jZSIsImNhdGVnb3J5IiwiZGV0ZWN0Q2F0ZWdvcnkiLCJzbGljZSIsInRpbWVEaWZmIiwiTWF0aCIsImFicyIsImRheXNEaWZmIiwic3Ryb25nT3Bwb3NpdGlvbiIsInBocmFzZSIsImluY2x1ZGVzIiwiY29udGV4dHVhbFN1YnMiLCJzdWIiLCJtYXgiLCJtaW4iLCJjcmVhdGVFbmhhbmNlZFN1bW1hcnkiLCJ0cnVuY2F0ZWQiLCJzZW50aW1lbnQiLCJkZXRlY3RBZHZhbmNlZFNlbnRpbWVudCIsInN0YW5jZSIsImRldGVjdFN0YW5jZSIsImludGVuc2l0eSIsImRldGVjdEludGVuc2l0eSIsInBvc2l0aXZlIiwibmVnYXRpdmUiLCJsb3dlciIsInBvc0NvdW50Iiwid29yZCIsIm5lZ0NvdW50IiwiaW50ZW5zaWZpZXJzIiwiaW50ZW5zaWZpZXJDb3VudCIsInRlc3QiLCJqIiwiY29udHJhZGljdGlvblR5cGUiLCJkZXRlY3RTZW1hbnRpY0NvbnRyYWRpY3Rpb24iLCJ0ZXh0MSIsInRleHQyIiwibG93ZXIxIiwibG93ZXIyIiwib3Bwb3NpdGlvblBhdHRlcm5zIiwicG9zIiwibmVnIiwiY29uZiIsImRlc2MiLCJwYXR0ZXJuIiwiaGFzUG9zMSIsInAiLCJoYXNOZWcxIiwibiIsImhhc1BvczIiLCJoYXNOZWcyIiwiZm9ybWF0dGVkQ29udHJhZGljdGlvbnMiLCJjb21tZW50MSIsImNvbW1lbnQyIiwic3RhdGVtZW50MSIsInN0YXRlbWVudDIiLCJkYXRlcyIsInRvSVNPU3RyaW5nIiwic3VicmVkZGl0cyIsImNvbmZpZGVuY2VTY29yZSIsInVwdm90ZXMiLCJmbG9vciIsInJhbmRvbSIsImRvd252b3RlcyIsInZlcmlmaWVkIiwicmVxdWlyZXNIdW1hblJldmlldyIsInRpbWVsaW5lIiwiZXZlbnQiLCJzdGF0cyIsImNhbGN1bGF0ZVN0YXRzIiwiZ2VuZXJhdGVTdW1tYXJ5IiwidG90YWxDb21tZW50cyIsInRpbWVzcGFuIiwidG9wU3VicmVkZGl0cyIsInNlbnRpbWVudFRyZW5kIiwib2xkZXN0IiwibmV3ZXN0IiwiZGlmZkRheXMiLCJzdWJyZWRkaXRDb3VudHMiLCJPYmplY3QiLCJlbnRyaWVzIiwiYW5hbHlzaXNNZXRob2QiLCJoaWdoQ29uZmlkZW5jZUNvdW50IiwiaHVtYW5SZXZpZXdDb3VudCIsIm11bHRpTW9kZWxQaXBlbGluZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/multiModelPipeline.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/redditApi.ts":
/*!***************************************!*\
  !*** ./src/lib/services/redditApi.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   redditApi: () => (/* binding */ redditApi)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! axios */ \"(rsc)/./node_modules/axios/lib/axios.js\");\n/* harmony import */ var axios_retry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios-retry */ \"(rsc)/./node_modules/axios-retry/dist/esm/index.js\");\n\n\nclass RedditApiService {\n    constructor(){\n        this.baseUrl = 'https://www.reddit.com';\n        this.verbose = false;\n        this.axiosInstance = axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].create({\n            timeout: 30000\n        });\n        // Enhanced retry configuration\n        (0,axios_retry__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(this.axiosInstance, {\n            retries: 3,\n            retryDelay: axios_retry__WEBPACK_IMPORTED_MODULE_0__[\"default\"].exponentialDelay,\n            retryCondition: (error)=>{\n                return axios_retry__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isNetworkOrIdempotentRequestError(error) || error.code === 'ECONNRESET' || error.code === 'ENOTFOUND' || error.code === 'ECONNABORTED' || error.message.includes('socket hang up') || error.response?.status === 503 || // Reddit overload\n                error.response?.status === 502 || // Bad gateway\n                error.response?.status === 504; // Gateway timeout\n            },\n            onRetry: (retryCount, error, requestConfig)=>{\n                if (this.verbose) {\n                    console.log(`Retrying request (attempt ${retryCount}):`, requestConfig.url);\n                }\n            }\n        });\n    }\n    setVerbose(verbose) {\n        this.verbose = verbose;\n    }\n    debug(...args) {\n        if (this.verbose) {\n            console.log('[RedditAPI]', ...args);\n        }\n    }\n    async makeRequest(url, source = 'reddit') {\n        try {\n            this.debug('Making request to:', url);\n            const response = await this.axiosInstance.get(url);\n            this.debug('Request successful:', {\n                url,\n                status: response.status\n            });\n            return response.data;\n        } catch (error) {\n            this.debug('Request failed:', {\n                url,\n                error: error instanceof Error ? error.message : 'Unknown error'\n            });\n            if (axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].isAxiosError(error)) {\n                if (error.response?.status === 404) {\n                    throw new Error('User not found');\n                } else if (error.response?.status === 429) {\n                    throw new Error('Rate limit exceeded. Please try again later.');\n                } else if (error.response?.status === 503) {\n                    throw new Error('Service temporarily unavailable. Please try again later.');\n                } else if (error.response?.status && error.response.status >= 500) {\n                    throw new Error(`Server error occurred (${error.response.status}). Please try again.`);\n                } else if (error.code === 'ECONNABORTED' || error.message.includes('timeout')) {\n                    throw new Error('Request timeout. Please try again.');\n                }\n            }\n            throw new Error(`Failed to fetch data: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n    }\n    delay(ms) {\n        return new Promise((resolve)=>setTimeout(resolve, ms));\n    }\n    // Streaming iterator for Reddit comments (Reddit API only)\n    async *iterateComments(username, options = {}) {\n        const { maxItems = 10000, maxAge = 365 } = options;\n        let totalFetched = 0;\n        let after = null;\n        let before = null;\n        const cutoffDate = Date.now() / 1000 - maxAge * 24 * 60 * 60;\n        this.debug(`Starting Reddit comment iteration for ${username}, max: ${maxItems}, maxAge: ${maxAge} days`);\n        // Use Reddit official API only\n        let requestCount = 0;\n        const maxRequests = 50; // Limit to prevent infinite loops\n        while(totalFetched < maxItems && requestCount < maxRequests){\n            try {\n                let url = `${this.baseUrl}/user/${username}/comments.json?limit=100&sort=new`;\n                if (after) {\n                    url += `&after=${after}`;\n                }\n                if (before) {\n                    url += `&before=${before}`;\n                }\n                const data = await this.makeRequest(url, 'reddit');\n                if (!data.data || !data.data.children || data.data.children.length === 0) {\n                    this.debug('No more comments from Reddit API');\n                    break;\n                }\n                const batch = data.data.children.map((child)=>child.data).filter((comment)=>{\n                    return comment.body && comment.body !== '[deleted]' && comment.body !== '[removed]' && comment.body.length > 20 && comment.created_utc >= cutoffDate;\n                }).map((comment)=>({\n                        id: comment.id,\n                        body: comment.body,\n                        created_utc: comment.created_utc,\n                        subreddit: comment.subreddit,\n                        score: comment.score,\n                        permalink: comment.permalink,\n                        author: comment.author,\n                        link_title: comment.link_title\n                    }));\n                if (batch.length > 0) {\n                    yield batch;\n                    totalFetched += batch.length;\n                    this.debug(`Reddit batch yielded: ${batch.length}, total: ${totalFetched}`);\n                }\n                // Update pagination\n                after = data.data.after;\n                before = data.data.before;\n                if (!after && !before) {\n                    this.debug('Reddit pagination complete - no more pages');\n                    break;\n                }\n                requestCount++;\n                await this.delay(1000); // Rate limiting\n            } catch (error) {\n                this.debug('Reddit API error:', error instanceof Error ? error.message : 'Unknown error');\n                break;\n            }\n        }\n        this.debug(`Comment iteration complete: ${totalFetched} total comments, ${requestCount} requests made`);\n    }\n    // Streaming iterator for posts\n    async *iteratePosts(username, options = {}) {\n        const { maxItems = 2000, maxAge = 365 } = options;\n        let totalFetched = 0;\n        let after = null;\n        const cutoffDate = Date.now() / 1000 - maxAge * 24 * 60 * 60;\n        this.debug(`Starting Reddit post iteration for ${username}, max: ${maxItems}`);\n        let requestCount = 0;\n        const maxRequests = 20; // Posts are typically less numerous\n        while(totalFetched < maxItems && requestCount < maxRequests){\n            try {\n                let url = `${this.baseUrl}/user/${username}/submitted.json?limit=100&sort=new`;\n                if (after) {\n                    url += `&after=${after}`;\n                }\n                const data = await this.makeRequest(url, 'reddit');\n                if (!data.data || !data.data.children || data.data.children.length === 0) {\n                    this.debug('No more posts from Reddit API');\n                    break;\n                }\n                const batch = data.data.children.map((child)=>child.data).filter((post)=>{\n                    return post.selftext && post.selftext !== '[deleted]' && post.selftext !== '[removed]' && post.selftext.length > 20 && post.created_utc >= cutoffDate;\n                }).map((post)=>({\n                        id: post.id,\n                        title: post.title,\n                        selftext: post.selftext,\n                        created_utc: post.created_utc,\n                        subreddit: post.subreddit,\n                        score: post.score,\n                        permalink: post.permalink,\n                        author: post.author,\n                        num_comments: post.num_comments\n                    }));\n                if (batch.length > 0) {\n                    yield batch;\n                    totalFetched += batch.length;\n                    this.debug(`Reddit post batch yielded: ${batch.length}, total: ${totalFetched}`);\n                }\n                after = data.data.after;\n                if (!after) {\n                    this.debug('Reddit post pagination complete');\n                    break;\n                }\n                requestCount++;\n                await this.delay(1000);\n            } catch (error) {\n                this.debug('Posts API error:', error instanceof Error ? error.message : 'Unknown error');\n                break;\n            }\n        }\n        this.debug(`Post iteration complete: ${totalFetched} total posts, ${requestCount} requests made`);\n    }\n    // User info method\n    async getUserInfo(username) {\n        const url = `${this.baseUrl}/user/${username}/about.json`;\n        this.debug('Fetching user info for:', username);\n        const data = await this.makeRequest(url, 'reddit');\n        if (!data.data) {\n            throw new Error('User not found');\n        }\n        return {\n            name: data.data.name,\n            created_utc: data.data.created_utc,\n            comment_karma: data.data.comment_karma,\n            link_karma: data.data.link_karma,\n            total_karma: data.data.total_karma,\n            verified: data.data.verified,\n            is_gold: data.data.is_gold,\n            is_mod: data.data.is_mod\n        };\n    }\n    // Legacy method for compatibility\n    async getUserComments(username, maxComments = 5000) {\n        const comments = [];\n        for await (const batch of this.iterateComments(username, {\n            maxItems: maxComments\n        })){\n            comments.push(...batch);\n            if (comments.length >= maxComments) break;\n        }\n        return comments.slice(0, maxComments);\n    }\n    // Legacy method for compatibility\n    async getUserPosts(username, maxPosts = 2000) {\n        const posts = [];\n        for await (const batch of this.iteratePosts(username, {\n            maxItems: maxPosts\n        })){\n            posts.push(...batch);\n            if (posts.length >= maxPosts) break;\n        }\n        return posts.slice(0, maxPosts);\n    }\n    // Get full user data\n    async getFullUserData(username, options = {}) {\n        try {\n            this.debug('Fetching comprehensive user data for:', username);\n            // Fetch user info first\n            const user = await this.getUserInfo(username);\n            // Stream all content\n            const comments = [];\n            const posts = [];\n            // Collect comments\n            for await (const batch of this.iterateComments(username, options)){\n                comments.push(...batch);\n                if (comments.length >= (options.maxItems || 5000)) break;\n            }\n            // Collect posts\n            for await (const batch of this.iteratePosts(username, options)){\n                posts.push(...batch);\n                if (posts.length >= 1000) break;\n            }\n            this.debug('Comprehensive data complete:', {\n                username,\n                comments: comments.length,\n                posts: posts.length,\n                totalContent: comments.length + posts.length\n            });\n            return {\n                user,\n                comments,\n                posts\n            };\n        } catch (error) {\n            this.debug('Failed to fetch comprehensive user data:', error instanceof Error ? error.message : 'Unknown error');\n            throw error;\n        }\n    }\n    // Get user preview\n    async getUserPreview(username) {\n        try {\n            const user = await this.getUserInfo(username);\n            // Get a small sample to check for recent activity\n            const sampleComments = [];\n            let batchCount = 0;\n            for await (const batch of this.iterateComments(username, {\n                maxItems: 20\n            })){\n                sampleComments.push(...batch);\n                batchCount++;\n                if (batchCount >= 1) break; // Just first batch for preview\n            }\n            const accountAge = Math.floor((Date.now() / 1000 - user.created_utc) / (24 * 60 * 60));\n            const ageString = accountAge < 30 ? `${accountAge} days` : accountAge < 365 ? `${Math.floor(accountAge / 30)} months` : `${Math.floor(accountAge / 365)} years`;\n            // Better estimation based on karma and account age\n            const dailyKarma = user.comment_karma / Math.max(accountAge, 1);\n            const estimatedComments = Math.min(Math.max(dailyKarma * 2, 100), 8000);\n            return {\n                exists: true,\n                karma: user.total_karma,\n                accountAge: ageString,\n                recentActivity: sampleComments.length > 0,\n                estimatedComments: Math.floor(estimatedComments)\n            };\n        } catch  {\n            return {\n                exists: false,\n                karma: 0,\n                accountAge: 'Unknown',\n                recentActivity: false,\n                estimatedComments: 0\n            };\n        }\n    }\n    // Check if user exists\n    async userExists(username) {\n        try {\n            await this.getUserInfo(username);\n            return true;\n        } catch  {\n            return false;\n        }\n    }\n    // Get subreddit info (bonus method)\n    async getSubredditInfo(subreddit) {\n        try {\n            const url = `${this.baseUrl}/r/${subreddit}/about.json`;\n            const data = await this.makeRequest(url, 'reddit');\n            return data.data;\n        } catch (error) {\n            this.debug('Failed to fetch subreddit info:', error);\n            throw error;\n        }\n    }\n    // Health check\n    async healthCheck() {\n        try {\n            const response = await this.axiosInstance.get(`${this.baseUrl}/r/test.json`, {\n                timeout: 5000\n            });\n            return response.status === 200;\n        } catch  {\n            return false;\n        }\n    }\n}\nconst redditApi = new RedditApiService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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M0csbUJBQW1CIiwic291cmNlcyI6WyJEOlxcY29kaW5nXFxsYXVuY2hcXHRob3VnaHRQb2xpY2VcXHNyY1xcbGliXFxzZXJ2aWNlc1xccmVkZGl0QXBpLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XHJcbmltcG9ydCBheGlvc1JldHJ5IGZyb20gJ2F4aW9zLXJldHJ5JztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmVkZGl0Q29tbWVudCB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBib2R5OiBzdHJpbmc7XHJcbiAgY3JlYXRlZF91dGM6IG51bWJlcjtcclxuICBzdWJyZWRkaXQ6IHN0cmluZztcclxuICBzY29yZTogbnVtYmVyO1xyXG4gIHBlcm1hbGluazogc3RyaW5nO1xyXG4gIGF1dGhvcjogc3RyaW5nO1xyXG4gIGxpbmtfdGl0bGU/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmVkZGl0UG9zdCB7XHJcbiAgaWQ6IHN0cmluZztcclxuICB0aXRsZTogc3RyaW5nO1xyXG4gIHNlbGZ0ZXh0OiBzdHJpbmc7XHJcbiAgY3JlYXRlZF91dGM6IG51bWJlcjtcclxuICBzdWJyZWRkaXQ6IHN0cmluZztcclxuICBzY29yZTogbnVtYmVyO1xyXG4gIHBlcm1hbGluazogc3RyaW5nO1xyXG4gIGF1dGhvcjogc3RyaW5nO1xyXG4gIG51bV9jb21tZW50czogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJlZGRpdFVzZXIge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBjcmVhdGVkX3V0YzogbnVtYmVyO1xyXG4gIGNvbW1lbnRfa2FybWE6IG51bWJlcjtcclxuICBsaW5rX2thcm1hOiBudW1iZXI7XHJcbiAgdG90YWxfa2FybWE6IG51bWJlcjtcclxuICB2ZXJpZmllZDogYm9vbGVhbjtcclxuICBpc19nb2xkOiBib29sZWFuO1xyXG4gIGlzX21vZDogYm9vbGVhbjtcclxufVxyXG5cclxuaW50ZXJmYWNlIEZldGNoT3B0aW9ucyB7XHJcbiAgbWF4SXRlbXM/OiBudW1iZXI7XHJcbiAgbWF4QWdlPzogbnVtYmVyOyAvLyBkYXlzXHJcbiAgdmVyYm9zZT86IGJvb2xlYW47XHJcbn1cclxuXHJcbmNsYXNzIFJlZGRpdEFwaVNlcnZpY2Uge1xyXG4gIHByaXZhdGUgYmFzZVVybCA9ICdodHRwczovL3d3dy5yZWRkaXQuY29tJ1xyXG4gIHByaXZhdGUgYXhpb3NJbnN0YW5jZTtcclxuICBwcml2YXRlIHZlcmJvc2UgPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmF4aW9zSW5zdGFuY2UgPSBheGlvcy5jcmVhdGUoe1xyXG4gICAgICB0aW1lb3V0OiAzMDAwMCxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEVuaGFuY2VkIHJldHJ5IGNvbmZpZ3VyYXRpb25cclxuICAgIGF4aW9zUmV0cnkodGhpcy5heGlvc0luc3RhbmNlLCB7XHJcbiAgICAgIHJldHJpZXM6IDMsXHJcbiAgICAgIHJldHJ5RGVsYXk6IGF4aW9zUmV0cnkuZXhwb25lbnRpYWxEZWxheSxcclxuICAgICAgcmV0cnlDb25kaXRpb246IChlcnJvcikgPT4ge1xyXG4gICAgICAgIHJldHVybiBheGlvc1JldHJ5LmlzTmV0d29ya09ySWRlbXBvdGVudFJlcXVlc3RFcnJvcihlcnJvcikgfHxcclxuICAgICAgICAgICAgICAgZXJyb3IuY29kZSA9PT0gJ0VDT05OUkVTRVQnIHx8XHJcbiAgICAgICAgICAgICAgIGVycm9yLmNvZGUgPT09ICdFTk9URk9VTkQnIHx8XHJcbiAgICAgICAgICAgICAgIGVycm9yLmNvZGUgPT09ICdFQ09OTkFCT1JURUQnIHx8XHJcbiAgICAgICAgICAgICAgIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3NvY2tldCBoYW5nIHVwJykgfHxcclxuICAgICAgICAgICAgICAgZXJyb3IucmVzcG9uc2U/LnN0YXR1cyA9PT0gNTAzIHx8IC8vIFJlZGRpdCBvdmVybG9hZFxyXG4gICAgICAgICAgICAgICBlcnJvci5yZXNwb25zZT8uc3RhdHVzID09PSA1MDIgfHwgLy8gQmFkIGdhdGV3YXlcclxuICAgICAgICAgICAgICAgZXJyb3IucmVzcG9uc2U/LnN0YXR1cyA9PT0gNTA0OyAgIC8vIEdhdGV3YXkgdGltZW91dFxyXG4gICAgICB9LFxyXG4gICAgICBvblJldHJ5OiAocmV0cnlDb3VudCwgZXJyb3IsIHJlcXVlc3RDb25maWcpID0+IHtcclxuICAgICAgICBpZiAodGhpcy52ZXJib3NlKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhgUmV0cnlpbmcgcmVxdWVzdCAoYXR0ZW1wdCAke3JldHJ5Q291bnR9KTpgLCByZXF1ZXN0Q29uZmlnLnVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRWZXJib3NlKHZlcmJvc2U6IGJvb2xlYW4pIHtcclxuICAgIHRoaXMudmVyYm9zZSA9IHZlcmJvc2U7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGRlYnVnKC4uLmFyZ3M6IGFueVtdKSB7XHJcbiAgICBpZiAodGhpcy52ZXJib3NlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbUmVkZGl0QVBJXScsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBtYWtlUmVxdWVzdCh1cmw6IHN0cmluZywgc291cmNlOiAncmVkZGl0JyA9ICdyZWRkaXQnKTogUHJvbWlzZTxhbnk+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHRoaXMuZGVidWcoJ01ha2luZyByZXF1ZXN0IHRvOicsIHVybCk7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5heGlvc0luc3RhbmNlLmdldCh1cmwpO1xyXG4gICAgICB0aGlzLmRlYnVnKCdSZXF1ZXN0IHN1Y2Nlc3NmdWw6JywgeyB1cmwsIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzIH0pO1xyXG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMuZGVidWcoJ1JlcXVlc3QgZmFpbGVkOicsIHsgdXJsLCBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicgfSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYXhpb3MuaXNBeGlvc0Vycm9yKGVycm9yKSkge1xyXG4gICAgICAgIGlmIChlcnJvci5yZXNwb25zZT8uc3RhdHVzID09PSA0MDQpIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVXNlciBub3QgZm91bmQnKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGVycm9yLnJlc3BvbnNlPy5zdGF0dXMgPT09IDQyOSkge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSYXRlIGxpbWl0IGV4Y2VlZGVkLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLicpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXJyb3IucmVzcG9uc2U/LnN0YXR1cyA9PT0gNTAzKSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1NlcnZpY2UgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChlcnJvci5yZXNwb25zZT8uc3RhdHVzICYmIGVycm9yLnJlc3BvbnNlLnN0YXR1cyA+PSA1MDApIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgU2VydmVyIGVycm9yIG9jY3VycmVkICgke2Vycm9yLnJlc3BvbnNlLnN0YXR1c30pLiBQbGVhc2UgdHJ5IGFnYWluLmApO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXJyb3IuY29kZSA9PT0gJ0VDT05OQUJPUlRFRCcgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygndGltZW91dCcpKSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVlc3QgdGltZW91dC4gUGxlYXNlIHRyeSBhZ2Fpbi4nKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggZGF0YTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ31gKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgZGVsYXkobXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xyXG4gIH1cclxuXHJcbiAgLy8gU3RyZWFtaW5nIGl0ZXJhdG9yIGZvciBSZWRkaXQgY29tbWVudHMgKFJlZGRpdCBBUEkgb25seSlcclxuICBhc3luYyogaXRlcmF0ZUNvbW1lbnRzKHVzZXJuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IEZldGNoT3B0aW9ucyA9IHt9KTogQXN5bmNHZW5lcmF0b3I8UmVkZGl0Q29tbWVudFtdLCB2b2lkLCB1bmtub3duPiB7XHJcbiAgICBjb25zdCB7IG1heEl0ZW1zID0gMTAwMDAsIG1heEFnZSA9IDM2NSB9ID0gb3B0aW9ucztcclxuICAgIGxldCB0b3RhbEZldGNoZWQgPSAwO1xyXG4gICAgbGV0IGFmdGVyOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuICAgIGxldCBiZWZvcmU6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG4gICAgY29uc3QgY3V0b2ZmRGF0ZSA9IERhdGUubm93KCkgLyAxMDAwIC0gKG1heEFnZSAqIDI0ICogNjAgKiA2MCk7XHJcblxyXG4gICAgdGhpcy5kZWJ1ZyhgU3RhcnRpbmcgUmVkZGl0IGNvbW1lbnQgaXRlcmF0aW9uIGZvciAke3VzZXJuYW1lfSwgbWF4OiAke21heEl0ZW1zfSwgbWF4QWdlOiAke21heEFnZX0gZGF5c2ApO1xyXG5cclxuICAgIC8vIFVzZSBSZWRkaXQgb2ZmaWNpYWwgQVBJIG9ubHlcclxuICAgIGxldCByZXF1ZXN0Q291bnQgPSAwO1xyXG4gICAgY29uc3QgbWF4UmVxdWVzdHMgPSA1MDsgLy8gTGltaXQgdG8gcHJldmVudCBpbmZpbml0ZSBsb29wc1xyXG5cclxuICAgIHdoaWxlICh0b3RhbEZldGNoZWQgPCBtYXhJdGVtcyAmJiByZXF1ZXN0Q291bnQgPCBtYXhSZXF1ZXN0cykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGxldCB1cmwgPSBgJHt0aGlzLmJhc2VVcmx9L3VzZXIvJHt1c2VybmFtZX0vY29tbWVudHMuanNvbj9saW1pdD0xMDAmc29ydD1uZXdgO1xyXG4gICAgICAgIGlmIChhZnRlcikge1xyXG4gICAgICAgICAgdXJsICs9IGAmYWZ0ZXI9JHthZnRlcn1gO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYmVmb3JlKSB7XHJcbiAgICAgICAgICB1cmwgKz0gYCZiZWZvcmU9JHtiZWZvcmV9YDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KHVybCwgJ3JlZGRpdCcpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghZGF0YS5kYXRhIHx8ICFkYXRhLmRhdGEuY2hpbGRyZW4gfHwgZGF0YS5kYXRhLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgdGhpcy5kZWJ1ZygnTm8gbW9yZSBjb21tZW50cyBmcm9tIFJlZGRpdCBBUEknKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgYmF0Y2ggPSBkYXRhLmRhdGEuY2hpbGRyZW5cclxuICAgICAgICAgIC5tYXAoKGNoaWxkOiBhbnkpID0+IGNoaWxkLmRhdGEpXHJcbiAgICAgICAgICAuZmlsdGVyKChjb21tZW50OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbW1lbnQuYm9keSAmJiBcclxuICAgICAgICAgICAgICAgICAgIGNvbW1lbnQuYm9keSAhPT0gJ1tkZWxldGVkXScgJiYgXHJcbiAgICAgICAgICAgICAgICAgICBjb21tZW50LmJvZHkgIT09ICdbcmVtb3ZlZF0nICYmXHJcbiAgICAgICAgICAgICAgICAgICBjb21tZW50LmJvZHkubGVuZ3RoID4gMjAgJiZcclxuICAgICAgICAgICAgICAgICAgIGNvbW1lbnQuY3JlYXRlZF91dGMgPj0gY3V0b2ZmRGF0ZTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAubWFwKChjb21tZW50OiBhbnkpID0+ICh7XHJcbiAgICAgICAgICAgIGlkOiBjb21tZW50LmlkLFxyXG4gICAgICAgICAgICBib2R5OiBjb21tZW50LmJvZHksXHJcbiAgICAgICAgICAgIGNyZWF0ZWRfdXRjOiBjb21tZW50LmNyZWF0ZWRfdXRjLFxyXG4gICAgICAgICAgICBzdWJyZWRkaXQ6IGNvbW1lbnQuc3VicmVkZGl0LFxyXG4gICAgICAgICAgICBzY29yZTogY29tbWVudC5zY29yZSxcclxuICAgICAgICAgICAgcGVybWFsaW5rOiBjb21tZW50LnBlcm1hbGluayxcclxuICAgICAgICAgICAgYXV0aG9yOiBjb21tZW50LmF1dGhvcixcclxuICAgICAgICAgICAgbGlua190aXRsZTogY29tbWVudC5saW5rX3RpdGxlLFxyXG4gICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBpZiAoYmF0Y2gubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgeWllbGQgYmF0Y2g7XHJcbiAgICAgICAgICB0b3RhbEZldGNoZWQgKz0gYmF0Y2gubGVuZ3RoO1xyXG4gICAgICAgICAgdGhpcy5kZWJ1ZyhgUmVkZGl0IGJhdGNoIHlpZWxkZWQ6ICR7YmF0Y2gubGVuZ3RofSwgdG90YWw6ICR7dG90YWxGZXRjaGVkfWApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVXBkYXRlIHBhZ2luYXRpb25cclxuICAgICAgICBhZnRlciA9IGRhdGEuZGF0YS5hZnRlcjtcclxuICAgICAgICBiZWZvcmUgPSBkYXRhLmRhdGEuYmVmb3JlO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghYWZ0ZXIgJiYgIWJlZm9yZSkge1xyXG4gICAgICAgICAgdGhpcy5kZWJ1ZygnUmVkZGl0IHBhZ2luYXRpb24gY29tcGxldGUgLSBubyBtb3JlIHBhZ2VzJyk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJlcXVlc3RDb3VudCsrO1xyXG4gICAgICAgIGF3YWl0IHRoaXMuZGVsYXkoMTAwMCk7IC8vIFJhdGUgbGltaXRpbmdcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLmRlYnVnKCdSZWRkaXQgQVBJIGVycm9yOicsIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZGVidWcoYENvbW1lbnQgaXRlcmF0aW9uIGNvbXBsZXRlOiAke3RvdGFsRmV0Y2hlZH0gdG90YWwgY29tbWVudHMsICR7cmVxdWVzdENvdW50fSByZXF1ZXN0cyBtYWRlYCk7XHJcbiAgfVxyXG5cclxuICAvLyBTdHJlYW1pbmcgaXRlcmF0b3IgZm9yIHBvc3RzXHJcbiAgYXN5bmMqIGl0ZXJhdGVQb3N0cyh1c2VybmFtZTogc3RyaW5nLCBvcHRpb25zOiBGZXRjaE9wdGlvbnMgPSB7fSk6IEFzeW5jR2VuZXJhdG9yPFJlZGRpdFBvc3RbXSwgdm9pZCwgdW5rbm93bj4ge1xyXG4gICAgY29uc3QgeyBtYXhJdGVtcyA9IDIwMDAsIG1heEFnZSA9IDM2NSB9ID0gb3B0aW9ucztcclxuICAgIGxldCB0b3RhbEZldGNoZWQgPSAwO1xyXG4gICAgbGV0IGFmdGVyOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuICAgIGNvbnN0IGN1dG9mZkRhdGUgPSBEYXRlLm5vdygpIC8gMTAwMCAtIChtYXhBZ2UgKiAyNCAqIDYwICogNjApO1xyXG5cclxuICAgIHRoaXMuZGVidWcoYFN0YXJ0aW5nIFJlZGRpdCBwb3N0IGl0ZXJhdGlvbiBmb3IgJHt1c2VybmFtZX0sIG1heDogJHttYXhJdGVtc31gKTtcclxuXHJcbiAgICBsZXQgcmVxdWVzdENvdW50ID0gMDtcclxuICAgIGNvbnN0IG1heFJlcXVlc3RzID0gMjA7IC8vIFBvc3RzIGFyZSB0eXBpY2FsbHkgbGVzcyBudW1lcm91c1xyXG5cclxuICAgIHdoaWxlICh0b3RhbEZldGNoZWQgPCBtYXhJdGVtcyAmJiByZXF1ZXN0Q291bnQgPCBtYXhSZXF1ZXN0cykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGxldCB1cmwgPSBgJHt0aGlzLmJhc2VVcmx9L3VzZXIvJHt1c2VybmFtZX0vc3VibWl0dGVkLmpzb24/bGltaXQ9MTAwJnNvcnQ9bmV3YDtcclxuICAgICAgICBpZiAoYWZ0ZXIpIHtcclxuICAgICAgICAgIHVybCArPSBgJmFmdGVyPSR7YWZ0ZXJ9YDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KHVybCwgJ3JlZGRpdCcpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghZGF0YS5kYXRhIHx8ICFkYXRhLmRhdGEuY2hpbGRyZW4gfHwgZGF0YS5kYXRhLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgdGhpcy5kZWJ1ZygnTm8gbW9yZSBwb3N0cyBmcm9tIFJlZGRpdCBBUEknKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgYmF0Y2ggPSBkYXRhLmRhdGEuY2hpbGRyZW5cclxuICAgICAgICAgIC5tYXAoKGNoaWxkOiBhbnkpID0+IGNoaWxkLmRhdGEpXHJcbiAgICAgICAgICAuZmlsdGVyKChwb3N0OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHBvc3Quc2VsZnRleHQgJiYgXHJcbiAgICAgICAgICAgICAgICAgICBwb3N0LnNlbGZ0ZXh0ICE9PSAnW2RlbGV0ZWRdJyAmJiBcclxuICAgICAgICAgICAgICAgICAgIHBvc3Quc2VsZnRleHQgIT09ICdbcmVtb3ZlZF0nICYmXHJcbiAgICAgICAgICAgICAgICAgICBwb3N0LnNlbGZ0ZXh0Lmxlbmd0aCA+IDIwICYmXHJcbiAgICAgICAgICAgICAgICAgICBwb3N0LmNyZWF0ZWRfdXRjID49IGN1dG9mZkRhdGU7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLm1hcCgocG9zdDogYW55KSA9PiAoe1xyXG4gICAgICAgICAgICBpZDogcG9zdC5pZCxcclxuICAgICAgICAgICAgdGl0bGU6IHBvc3QudGl0bGUsXHJcbiAgICAgICAgICAgIHNlbGZ0ZXh0OiBwb3N0LnNlbGZ0ZXh0LFxyXG4gICAgICAgICAgICBjcmVhdGVkX3V0YzogcG9zdC5jcmVhdGVkX3V0YyxcclxuICAgICAgICAgICAgc3VicmVkZGl0OiBwb3N0LnN1YnJlZGRpdCxcclxuICAgICAgICAgICAgc2NvcmU6IHBvc3Quc2NvcmUsXHJcbiAgICAgICAgICAgIHBlcm1hbGluazogcG9zdC5wZXJtYWxpbmssXHJcbiAgICAgICAgICAgIGF1dGhvcjogcG9zdC5hdXRob3IsXHJcbiAgICAgICAgICAgIG51bV9jb21tZW50czogcG9zdC5udW1fY29tbWVudHMsXHJcbiAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIGlmIChiYXRjaC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICB5aWVsZCBiYXRjaDtcclxuICAgICAgICAgIHRvdGFsRmV0Y2hlZCArPSBiYXRjaC5sZW5ndGg7XHJcbiAgICAgICAgICB0aGlzLmRlYnVnKGBSZWRkaXQgcG9zdCBiYXRjaCB5aWVsZGVkOiAke2JhdGNoLmxlbmd0aH0sIHRvdGFsOiAke3RvdGFsRmV0Y2hlZH1gKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGFmdGVyID0gZGF0YS5kYXRhLmFmdGVyO1xyXG4gICAgICAgIGlmICghYWZ0ZXIpIHtcclxuICAgICAgICAgIHRoaXMuZGVidWcoJ1JlZGRpdCBwb3N0IHBhZ2luYXRpb24gY29tcGxldGUnKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVxdWVzdENvdW50Kys7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5kZWxheSgxMDAwKTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLmRlYnVnKCdQb3N0cyBBUEkgZXJyb3I6JywgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5kZWJ1ZyhgUG9zdCBpdGVyYXRpb24gY29tcGxldGU6ICR7dG90YWxGZXRjaGVkfSB0b3RhbCBwb3N0cywgJHtyZXF1ZXN0Q291bnR9IHJlcXVlc3RzIG1hZGVgKTtcclxuICB9XHJcblxyXG4gIC8vIFVzZXIgaW5mbyBtZXRob2RcclxuICBhc3luYyBnZXRVc2VySW5mbyh1c2VybmFtZTogc3RyaW5nKTogUHJvbWlzZTxSZWRkaXRVc2VyPiB7XHJcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVcmx9L3VzZXIvJHt1c2VybmFtZX0vYWJvdXQuanNvbmA7XHJcbiAgICB0aGlzLmRlYnVnKCdGZXRjaGluZyB1c2VyIGluZm8gZm9yOicsIHVzZXJuYW1lKTtcclxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLm1ha2VSZXF1ZXN0KHVybCwgJ3JlZGRpdCcpO1xyXG4gICAgXHJcbiAgICBpZiAoIWRhdGEuZGF0YSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VzZXIgbm90IGZvdW5kJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogZGF0YS5kYXRhLm5hbWUsXHJcbiAgICAgIGNyZWF0ZWRfdXRjOiBkYXRhLmRhdGEuY3JlYXRlZF91dGMsXHJcbiAgICAgIGNvbW1lbnRfa2FybWE6IGRhdGEuZGF0YS5jb21tZW50X2thcm1hLFxyXG4gICAgICBsaW5rX2thcm1hOiBkYXRhLmRhdGEubGlua19rYXJtYSxcclxuICAgICAgdG90YWxfa2FybWE6IGRhdGEuZGF0YS50b3RhbF9rYXJtYSxcclxuICAgICAgdmVyaWZpZWQ6IGRhdGEuZGF0YS52ZXJpZmllZCxcclxuICAgICAgaXNfZ29sZDogZGF0YS5kYXRhLmlzX2dvbGQsXHJcbiAgICAgIGlzX21vZDogZGF0YS5kYXRhLmlzX21vZCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvLyBMZWdhY3kgbWV0aG9kIGZvciBjb21wYXRpYmlsaXR5XHJcbiAgYXN5bmMgZ2V0VXNlckNvbW1lbnRzKHVzZXJuYW1lOiBzdHJpbmcsIG1heENvbW1lbnRzOiBudW1iZXIgPSA1MDAwKTogUHJvbWlzZTxSZWRkaXRDb21tZW50W10+IHtcclxuICAgIGNvbnN0IGNvbW1lbnRzOiBSZWRkaXRDb21tZW50W10gPSBbXTtcclxuICAgIFxyXG4gICAgZm9yIGF3YWl0IChjb25zdCBiYXRjaCBvZiB0aGlzLml0ZXJhdGVDb21tZW50cyh1c2VybmFtZSwgeyBtYXhJdGVtczogbWF4Q29tbWVudHMgfSkpIHtcclxuICAgICAgY29tbWVudHMucHVzaCguLi5iYXRjaCk7XHJcbiAgICAgIGlmIChjb21tZW50cy5sZW5ndGggPj0gbWF4Q29tbWVudHMpIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gY29tbWVudHMuc2xpY2UoMCwgbWF4Q29tbWVudHMpO1xyXG4gIH1cclxuXHJcbiAgLy8gTGVnYWN5IG1ldGhvZCBmb3IgY29tcGF0aWJpbGl0eVxyXG4gIGFzeW5jIGdldFVzZXJQb3N0cyh1c2VybmFtZTogc3RyaW5nLCBtYXhQb3N0czogbnVtYmVyID0gMjAwMCk6IFByb21pc2U8UmVkZGl0UG9zdFtdPiB7XHJcbiAgICBjb25zdCBwb3N0czogUmVkZGl0UG9zdFtdID0gW107XHJcbiAgICBcclxuICAgIGZvciBhd2FpdCAoY29uc3QgYmF0Y2ggb2YgdGhpcy5pdGVyYXRlUG9zdHModXNlcm5hbWUsIHsgbWF4SXRlbXM6IG1heFBvc3RzIH0pKSB7XHJcbiAgICAgIHBvc3RzLnB1c2goLi4uYmF0Y2gpO1xyXG4gICAgICBpZiAocG9zdHMubGVuZ3RoID49IG1heFBvc3RzKSBicmVhaztcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHBvc3RzLnNsaWNlKDAsIG1heFBvc3RzKTtcclxuICB9XHJcblxyXG4gIC8vIEdldCBmdWxsIHVzZXIgZGF0YVxyXG4gIGFzeW5jIGdldEZ1bGxVc2VyRGF0YSh1c2VybmFtZTogc3RyaW5nLCBvcHRpb25zOiBGZXRjaE9wdGlvbnMgPSB7fSk6IFByb21pc2U8e1xyXG4gICAgdXNlcjogUmVkZGl0VXNlcjtcclxuICAgIGNvbW1lbnRzOiBSZWRkaXRDb21tZW50W107XHJcbiAgICBwb3N0czogUmVkZGl0UG9zdFtdO1xyXG4gIH0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHRoaXMuZGVidWcoJ0ZldGNoaW5nIGNvbXByZWhlbnNpdmUgdXNlciBkYXRhIGZvcjonLCB1c2VybmFtZSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBGZXRjaCB1c2VyIGluZm8gZmlyc3RcclxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHRoaXMuZ2V0VXNlckluZm8odXNlcm5hbWUpO1xyXG4gICAgICBcclxuICAgICAgLy8gU3RyZWFtIGFsbCBjb250ZW50XHJcbiAgICAgIGNvbnN0IGNvbW1lbnRzOiBSZWRkaXRDb21tZW50W10gPSBbXTtcclxuICAgICAgY29uc3QgcG9zdHM6IFJlZGRpdFBvc3RbXSA9IFtdO1xyXG5cclxuICAgICAgLy8gQ29sbGVjdCBjb21tZW50c1xyXG4gICAgICBmb3IgYXdhaXQgKGNvbnN0IGJhdGNoIG9mIHRoaXMuaXRlcmF0ZUNvbW1lbnRzKHVzZXJuYW1lLCBvcHRpb25zKSkge1xyXG4gICAgICAgIGNvbW1lbnRzLnB1c2goLi4uYmF0Y2gpO1xyXG4gICAgICAgIGlmIChjb21tZW50cy5sZW5ndGggPj0gKG9wdGlvbnMubWF4SXRlbXMgfHwgNTAwMCkpIGJyZWFrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDb2xsZWN0IHBvc3RzXHJcbiAgICAgIGZvciBhd2FpdCAoY29uc3QgYmF0Y2ggb2YgdGhpcy5pdGVyYXRlUG9zdHModXNlcm5hbWUsIG9wdGlvbnMpKSB7XHJcbiAgICAgICAgcG9zdHMucHVzaCguLi5iYXRjaCk7XHJcbiAgICAgICAgaWYgKHBvc3RzLmxlbmd0aCA+PSAxMDAwKSBicmVhaztcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5kZWJ1ZygnQ29tcHJlaGVuc2l2ZSBkYXRhIGNvbXBsZXRlOicsIHtcclxuICAgICAgICB1c2VybmFtZSxcclxuICAgICAgICBjb21tZW50czogY29tbWVudHMubGVuZ3RoLFxyXG4gICAgICAgIHBvc3RzOiBwb3N0cy5sZW5ndGgsXHJcbiAgICAgICAgdG90YWxDb250ZW50OiBjb21tZW50cy5sZW5ndGggKyBwb3N0cy5sZW5ndGhcclxuICAgICAgfSk7XHJcblxyXG4gICAgICByZXR1cm4geyB1c2VyLCBjb21tZW50cywgcG9zdHMgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMuZGVidWcoJ0ZhaWxlZCB0byBmZXRjaCBjb21wcmVoZW5zaXZlIHVzZXIgZGF0YTonLCBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyk7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gR2V0IHVzZXIgcHJldmlld1xyXG4gIGFzeW5jIGdldFVzZXJQcmV2aWV3KHVzZXJuYW1lOiBzdHJpbmcpOiBQcm9taXNlPHtcclxuICAgIGV4aXN0czogYm9vbGVhbjtcclxuICAgIGthcm1hOiBudW1iZXI7XHJcbiAgICBhY2NvdW50QWdlOiBzdHJpbmc7XHJcbiAgICByZWNlbnRBY3Rpdml0eTogYm9vbGVhbjtcclxuICAgIGVzdGltYXRlZENvbW1lbnRzOiBudW1iZXI7XHJcbiAgfT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHRoaXMuZ2V0VXNlckluZm8odXNlcm5hbWUpO1xyXG4gICAgICBcclxuICAgICAgLy8gR2V0IGEgc21hbGwgc2FtcGxlIHRvIGNoZWNrIGZvciByZWNlbnQgYWN0aXZpdHlcclxuICAgICAgY29uc3Qgc2FtcGxlQ29tbWVudHM6IFJlZGRpdENvbW1lbnRbXSA9IFtdO1xyXG4gICAgICBsZXQgYmF0Y2hDb3VudCA9IDA7XHJcbiAgICAgIFxyXG4gICAgICBmb3IgYXdhaXQgKGNvbnN0IGJhdGNoIG9mIHRoaXMuaXRlcmF0ZUNvbW1lbnRzKHVzZXJuYW1lLCB7IG1heEl0ZW1zOiAyMCB9KSkge1xyXG4gICAgICAgIHNhbXBsZUNvbW1lbnRzLnB1c2goLi4uYmF0Y2gpO1xyXG4gICAgICAgIGJhdGNoQ291bnQrKztcclxuICAgICAgICBpZiAoYmF0Y2hDb3VudCA+PSAxKSBicmVhazsgLy8gSnVzdCBmaXJzdCBiYXRjaCBmb3IgcHJldmlld1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBhY2NvdW50QWdlID0gTWF0aC5mbG9vcigoRGF0ZS5ub3coKSAvIDEwMDAgLSB1c2VyLmNyZWF0ZWRfdXRjKSAvICgyNCAqIDYwICogNjApKTtcclxuICAgICAgY29uc3QgYWdlU3RyaW5nID0gYWNjb3VudEFnZSA8IDMwID8gYCR7YWNjb3VudEFnZX0gZGF5c2AgOiBcclxuICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50QWdlIDwgMzY1ID8gYCR7TWF0aC5mbG9vcihhY2NvdW50QWdlIC8gMzApfSBtb250aHNgIDogXHJcbiAgICAgICAgICAgICAgICAgICAgICAgYCR7TWF0aC5mbG9vcihhY2NvdW50QWdlIC8gMzY1KX0geWVhcnNgO1xyXG5cclxuICAgICAgLy8gQmV0dGVyIGVzdGltYXRpb24gYmFzZWQgb24ga2FybWEgYW5kIGFjY291bnQgYWdlXHJcbiAgICAgIGNvbnN0IGRhaWx5S2FybWEgPSB1c2VyLmNvbW1lbnRfa2FybWEgLyBNYXRoLm1heChhY2NvdW50QWdlLCAxKTtcclxuICAgICAgY29uc3QgZXN0aW1hdGVkQ29tbWVudHMgPSBNYXRoLm1pbihNYXRoLm1heChkYWlseUthcm1hICogMiwgMTAwKSwgODAwMCk7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGV4aXN0czogdHJ1ZSxcclxuICAgICAgICBrYXJtYTogdXNlci50b3RhbF9rYXJtYSxcclxuICAgICAgICBhY2NvdW50QWdlOiBhZ2VTdHJpbmcsXHJcbiAgICAgICAgcmVjZW50QWN0aXZpdHk6IHNhbXBsZUNvbW1lbnRzLmxlbmd0aCA+IDAsXHJcbiAgICAgICAgZXN0aW1hdGVkQ29tbWVudHM6IE1hdGguZmxvb3IoZXN0aW1hdGVkQ29tbWVudHMpXHJcbiAgICAgIH07XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBleGlzdHM6IGZhbHNlLFxyXG4gICAgICAgIGthcm1hOiAwLFxyXG4gICAgICAgIGFjY291bnRBZ2U6ICdVbmtub3duJyxcclxuICAgICAgICByZWNlbnRBY3Rpdml0eTogZmFsc2UsXHJcbiAgICAgICAgZXN0aW1hdGVkQ29tbWVudHM6IDBcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGlmIHVzZXIgZXhpc3RzXHJcbiAgYXN5bmMgdXNlckV4aXN0cyh1c2VybmFtZTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCB0aGlzLmdldFVzZXJJbmZvKHVzZXJuYW1lKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gR2V0IHN1YnJlZGRpdCBpbmZvIChib251cyBtZXRob2QpXHJcbiAgYXN5bmMgZ2V0U3VicmVkZGl0SW5mbyhzdWJyZWRkaXQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmJhc2VVcmx9L3IvJHtzdWJyZWRkaXR9L2Fib3V0Lmpzb25gO1xyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdCh1cmwsICdyZWRkaXQnKTtcclxuICAgICAgcmV0dXJuIGRhdGEuZGF0YTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMuZGVidWcoJ0ZhaWxlZCB0byBmZXRjaCBzdWJyZWRkaXQgaW5mbzonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gSGVhbHRoIGNoZWNrXHJcbiAgYXN5bmMgaGVhbHRoQ2hlY2soKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYXhpb3NJbnN0YW5jZS5nZXQoYCR7dGhpcy5iYXNlVXJsfS9yL3Rlc3QuanNvbmAsIHsgdGltZW91dDogNTAwMCB9KTtcclxuICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwO1xyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCByZWRkaXRBcGkgPSBuZXcgUmVkZGl0QXBpU2VydmljZSgpOyJdLCJuYW1lcyI6WyJheGlvcyIsImF4aW9zUmV0cnkiLCJSZWRkaXRBcGlTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJiYXNlVXJsIiwidmVyYm9zZSIsImF4aW9zSW5zdGFuY2UiLCJjcmVhdGUiLCJ0aW1lb3V0IiwicmV0cmllcyIsInJldHJ5RGVsYXkiLCJleHBvbmVudGlhbERlbGF5IiwicmV0cnlDb25kaXRpb24iLCJlcnJvciIsImlzTmV0d29ya09ySWRlbXBvdGVudFJlcXVlc3RFcnJvciIsImNvZGUiLCJtZXNzYWdlIiwiaW5jbHVkZXMiLCJyZXNwb25zZSIsInN0YXR1cyIsIm9uUmV0cnkiLCJyZXRyeUNvdW50IiwicmVxdWVzdENvbmZpZyIsImNvbnNvbGUiLCJsb2ciLCJ1cmwiLCJzZXRWZXJib3NlIiwiZGVidWciLCJhcmdzIiwibWFrZVJlcXVlc3QiLCJzb3VyY2UiLCJnZXQiLCJkYXRhIiwiRXJyb3IiLCJpc0F4aW9zRXJyb3IiLCJkZWxheSIsIm1zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiaXRlcmF0ZUNvbW1lbnRzIiwidXNlcm5hbWUiLCJvcHRpb25zIiwibWF4SXRlbXMiLCJtYXhBZ2UiLCJ0b3RhbEZldGNoZWQiLCJhZnRlciIsImJlZm9yZSIsImN1dG9mZkRhdGUiLCJEYXRlIiwibm93IiwicmVxdWVzdENvdW50IiwibWF4UmVxdWVzdHMiLCJjaGlsZHJlbiIsImxlbmd0aCIsImJhdGNoIiwibWFwIiwiY2hpbGQiLCJmaWx0ZXIiLCJjb21tZW50IiwiYm9keSIsImNyZWF0ZWRfdXRjIiwiaWQiLCJzdWJyZWRkaXQiLCJzY29yZSIsInBlcm1hbGluayIsImF1dGhvciIsImxpbmtfdGl0bGUiLCJpdGVyYXRlUG9zdHMiLCJwb3N0Iiwic2VsZnRleHQiLCJ0aXRsZSIsIm51bV9jb21tZW50cyIsImdldFVzZXJJbmZvIiwibmFtZSIsImNvbW1lbnRfa2FybWEiLCJsaW5rX2thcm1hIiwidG90YWxfa2FybWEiLCJ2ZXJpZmllZCIsImlzX2dvbGQiLCJpc19tb2QiLCJnZXRVc2VyQ29tbWVudHMiLCJtYXhDb21tZW50cyIsImNvbW1lbnRzIiwicHVzaCIsInNsaWNlIiwiZ2V0VXNlclBvc3RzIiwibWF4UG9zdHMiLCJwb3N0cyIsImdldEZ1bGxVc2VyRGF0YSIsInVzZXIiLCJ0b3RhbENvbnRlbnQiLCJnZXRVc2VyUHJldmlldyIsInNhbXBsZUNvbW1lbnRzIiwiYmF0Y2hDb3VudCIsImFjY291bnRBZ2UiLCJNYXRoIiwiZmxvb3IiLCJhZ2VTdHJpbmciLCJkYWlseUthcm1hIiwibWF4IiwiZXN0aW1hdGVkQ29tbWVudHMiLCJtaW4iLCJleGlzdHMiLCJrYXJtYSIsInJlY2VudEFjdGl2aXR5IiwidXNlckV4aXN0cyIsImdldFN1YnJlZGRpdEluZm8iLCJoZWFsdGhDaGVjayIsInJlZGRpdEFwaSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/redditApi.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/tokenBudget.ts":
/*!*****************************************!*\
  !*** ./src/lib/services/tokenBudget.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   tokenBudget: () => (/* binding */ tokenBudget)\n/* harmony export */ });\nclass TokenBudgetService {\n    constructor(config = {\n        maxDollar: 5.00,\n        warningThreshold: 80\n    }){\n        this.usage = [];\n        this.modelPricing = {\n            // Free models (estimated costs for tracking)\n            'mistralai/mistral-7b-instruct:free': {\n                inputTokens: 0,\n                outputTokens: 0\n            },\n            'mistralai/mistral-small-3.2-24b-instruct:free': {\n                inputTokens: 0,\n                outputTokens: 0\n            },\n            'google/gemma-7b-it:free': {\n                inputTokens: 0,\n                outputTokens: 0\n            },\n            'deepseek/deepseek-llm-7b-instruct:free': {\n                inputTokens: 0,\n                outputTokens: 0\n            },\n            'openchat/openchat-3.5-1210:free': {\n                inputTokens: 0,\n                outputTokens: 0\n            },\n            // Paid models (actual pricing)\n            'openai/gpt-4o': {\n                inputTokens: 2.50,\n                outputTokens: 10.00\n            },\n            'openai/gpt-4o-mini': {\n                inputTokens: 0.15,\n                outputTokens: 0.60\n            },\n            'anthropic/claude-3.5-sonnet': {\n                inputTokens: 3.00,\n                outputTokens: 15.00\n            },\n            'google/gemini-pro-1.5': {\n                inputTokens: 1.25,\n                outputTokens: 5.00\n            },\n            'mistralai/mixtral-8x7b-instruct': {\n                inputTokens: 0.24,\n                outputTokens: 0.24\n            }\n        };\n        this.budget = config;\n        this.loadUsageFromStorage();\n    }\n    loadUsageFromStorage() {\n        try {\n            const stored = localStorage.getItem('tokenBudgetUsage');\n            if (stored) {\n                this.usage = JSON.parse(stored);\n                // Clean up old usage (older than 24 hours)\n                const cutoff = Date.now() - 24 * 60 * 60 * 1000;\n                this.usage = this.usage.filter((u)=>u.timestamp > cutoff);\n            }\n        } catch (error) {\n            console.warn('Failed to load token budget usage:', error);\n            this.usage = [];\n        }\n    }\n    saveUsageToStorage() {\n        try {\n            localStorage.setItem('tokenBudgetUsage', JSON.stringify(this.usage));\n        } catch (error) {\n            console.warn('Failed to save token budget usage:', error);\n        }\n    }\n    estimateTokens(text) {\n        // Rough estimation: ~4 characters per token for English text\n        // More accurate would be to use tiktoken, but this is good enough\n        return Math.ceil(text.length / 4);\n    }\n    getCurrentSpend() {\n        return this.usage.reduce((total, usage)=>total + usage.cost, 0);\n    }\n    getRemainingBudget() {\n        return Math.max(0, this.budget.maxDollar - this.getCurrentSpend());\n    }\n    getBudgetStatus() {\n        const spent = this.getCurrentSpend();\n        const remaining = this.getRemainingBudget();\n        const percentage = spent / this.budget.maxDollar * 100;\n        return {\n            spent,\n            remaining,\n            percentage,\n            isWarning: percentage >= this.budget.warningThreshold,\n            isExceeded: spent >= this.budget.maxDollar\n        };\n    }\n    canAfford(model, estimatedInputTokens, estimatedOutputTokens = 500) {\n        const cost = this.calculateCost(model, estimatedInputTokens, estimatedOutputTokens);\n        return this.getRemainingBudget() >= cost;\n    }\n    calculateCost(model, inputTokens, outputTokens) {\n        const pricing = this.modelPricing[model];\n        if (!pricing) {\n            console.warn(`No pricing info for model: ${model}, assuming free`);\n            return 0;\n        }\n        const inputCost = inputTokens / 1000000 * pricing.inputTokens;\n        const outputCost = outputTokens / 1000000 * pricing.outputTokens;\n        return inputCost + outputCost;\n    }\n    recordUsage(model, inputTokens, outputTokens) {\n        const cost = this.calculateCost(model, inputTokens, outputTokens);\n        const usage = {\n            model,\n            inputTokens,\n            outputTokens,\n            cost,\n            timestamp: Date.now()\n        };\n        this.usage.push(usage);\n        this.saveUsageToStorage();\n        console.log(`Token usage recorded:`, {\n            model,\n            inputTokens,\n            outputTokens,\n            cost: cost.toFixed(4),\n            totalSpent: this.getCurrentSpend().toFixed(4),\n            remaining: this.getRemainingBudget().toFixed(4)\n        });\n    }\n    getUsageStats() {\n        const modelBreakdown = {};\n        let totalRequests = 0;\n        let totalInputTokens = 0;\n        let totalOutputTokens = 0;\n        let totalCost = 0;\n        for (const usage of this.usage){\n            totalRequests++;\n            totalInputTokens += usage.inputTokens;\n            totalOutputTokens += usage.outputTokens;\n            totalCost += usage.cost;\n            if (!modelBreakdown[usage.model]) {\n                modelBreakdown[usage.model] = {\n                    requests: 0,\n                    cost: 0,\n                    tokens: 0\n                };\n            }\n            modelBreakdown[usage.model].requests++;\n            modelBreakdown[usage.model].cost += usage.cost;\n            modelBreakdown[usage.model].tokens += usage.inputTokens + usage.outputTokens;\n        }\n        return {\n            totalRequests,\n            totalInputTokens,\n            totalOutputTokens,\n            totalCost,\n            modelBreakdown\n        };\n    }\n    resetBudget() {\n        this.usage = [];\n        this.saveUsageToStorage();\n    }\n    setBudget(config) {\n        this.budget = {\n            ...this.budget,\n            ...config\n        };\n    }\n}\nconst tokenBudget = new TokenBudgetService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFxRixDQUFDO1FBRTVGLElBQUlDLGdCQUFnQjtRQUNwQixJQUFJQyxtQkFBbUI7UUFDdkIsSUFBSUMsb0JBQW9CO1FBQ3hCLElBQUlDLFlBQVk7UUFFaEIsS0FBSyxNQUFNMUQsU0FBUyxJQUFJLENBQUNBLEtBQUssQ0FBRTtZQUM5QnVEO1lBQ0FDLG9CQUFvQnhELE1BQU1FLFdBQVc7WUFDckN1RCxxQkFBcUJ6RCxNQUFNRyxZQUFZO1lBQ3ZDdUQsYUFBYTFELE1BQU0rQixJQUFJO1lBRXZCLElBQUksQ0FBQ3VCLGNBQWMsQ0FBQ3RELE1BQU15QyxLQUFLLENBQUMsRUFBRTtnQkFDaENhLGNBQWMsQ0FBQ3RELE1BQU15QyxLQUFLLENBQUMsR0FBRztvQkFBRWtCLFVBQVU7b0JBQUc1QixNQUFNO29CQUFHNkIsUUFBUTtnQkFBRTtZQUNsRTtZQUVBTixjQUFjLENBQUN0RCxNQUFNeUMsS0FBSyxDQUFDLENBQUNrQixRQUFRO1lBQ3BDTCxjQUFjLENBQUN0RCxNQUFNeUMsS0FBSyxDQUFDLENBQUNWLElBQUksSUFBSS9CLE1BQU0rQixJQUFJO1lBQzlDdUIsY0FBYyxDQUFDdEQsTUFBTXlDLEtBQUssQ0FBQyxDQUFDbUIsTUFBTSxJQUFJNUQsTUFBTUUsV0FBVyxHQUFHRixNQUFNRyxZQUFZO1FBQzlFO1FBRUEsT0FBTztZQUNMb0Q7WUFDQUM7WUFDQUM7WUFDQUM7WUFDQUo7UUFDRjtJQUNGO0lBRUFPLGNBQW9CO1FBQ2xCLElBQUksQ0FBQzdELEtBQUssR0FBRyxFQUFFO1FBQ2YsSUFBSSxDQUFDb0Isa0JBQWtCO0lBQ3pCO0lBRUEwQyxVQUFVakUsTUFBNkIsRUFBUTtRQUM3QyxJQUFJLENBQUNPLE1BQU0sR0FBRztZQUFFLEdBQUcsSUFBSSxDQUFDQSxNQUFNO1lBQUUsR0FBR1AsTUFBTTtRQUFDO0lBQzVDO0FBQ0Y7QUFFTyxNQUFNa0UsY0FBYyxJQUFJcEUscUJBQXFCIiwic291cmNlcyI6WyJEOlxcY29kaW5nXFxsYXVuY2hcXHRob3VnaHRQb2xpY2VcXHNyY1xcbGliXFxzZXJ2aWNlc1xcdG9rZW5CdWRnZXQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW50ZXJmYWNlIE1vZGVsUHJpY2luZyB7XHJcbiAgaW5wdXRUb2tlbnM6IG51bWJlcjsgIC8vIHBlciAxTSB0b2tlbnNcclxuICBvdXRwdXRUb2tlbnM6IG51bWJlcjsgLy8gcGVyIDFNIHRva2Vuc1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQnVkZ2V0Q29uZmlnIHtcclxuICBtYXhEb2xsYXI6IG51bWJlcjtcclxuICB3YXJuaW5nVGhyZXNob2xkOiBudW1iZXI7IC8vIHBlcmNlbnRhZ2UgKGUuZy4sIDgwIGZvciA4MCUpXHJcbn1cclxuXHJcbmludGVyZmFjZSBCdWRnZXRVc2FnZSB7XHJcbiAgbW9kZWw6IHN0cmluZztcclxuICBpbnB1dFRva2VuczogbnVtYmVyO1xyXG4gIG91dHB1dFRva2VuczogbnVtYmVyO1xyXG4gIGNvc3Q6IG51bWJlcjtcclxuICB0aW1lc3RhbXA6IG51bWJlcjtcclxufVxyXG5cclxuY2xhc3MgVG9rZW5CdWRnZXRTZXJ2aWNlIHtcclxuICBwcml2YXRlIGJ1ZGdldDogQnVkZ2V0Q29uZmlnO1xyXG4gIHByaXZhdGUgdXNhZ2U6IEJ1ZGdldFVzYWdlW10gPSBbXTtcclxuICBwcml2YXRlIG1vZGVsUHJpY2luZzogUmVjb3JkPHN0cmluZywgTW9kZWxQcmljaW5nPiA9IHtcclxuICAgIC8vIEZyZWUgbW9kZWxzIChlc3RpbWF0ZWQgY29zdHMgZm9yIHRyYWNraW5nKVxyXG4gICAgJ21pc3RyYWxhaS9taXN0cmFsLTdiLWluc3RydWN0OmZyZWUnOiB7IGlucHV0VG9rZW5zOiAwLCBvdXRwdXRUb2tlbnM6IDAgfSxcclxuICAgICdtaXN0cmFsYWkvbWlzdHJhbC1zbWFsbC0zLjItMjRiLWluc3RydWN0OmZyZWUnOiB7IGlucHV0VG9rZW5zOiAwLCBvdXRwdXRUb2tlbnM6IDAgfSxcclxuICAgICdnb29nbGUvZ2VtbWEtN2ItaXQ6ZnJlZSc6IHsgaW5wdXRUb2tlbnM6IDAsIG91dHB1dFRva2VuczogMCB9LFxyXG4gICAgJ2RlZXBzZWVrL2RlZXBzZWVrLWxsbS03Yi1pbnN0cnVjdDpmcmVlJzogeyBpbnB1dFRva2VuczogMCwgb3V0cHV0VG9rZW5zOiAwIH0sXHJcbiAgICAnb3BlbmNoYXQvb3BlbmNoYXQtMy41LTEyMTA6ZnJlZSc6IHsgaW5wdXRUb2tlbnM6IDAsIG91dHB1dFRva2VuczogMCB9LFxyXG4gICAgXHJcbiAgICAvLyBQYWlkIG1vZGVscyAoYWN0dWFsIHByaWNpbmcpXHJcbiAgICAnb3BlbmFpL2dwdC00byc6IHsgaW5wdXRUb2tlbnM6IDIuNTAsIG91dHB1dFRva2VuczogMTAuMDAgfSxcclxuICAgICdvcGVuYWkvZ3B0LTRvLW1pbmknOiB7IGlucHV0VG9rZW5zOiAwLjE1LCBvdXRwdXRUb2tlbnM6IDAuNjAgfSxcclxuICAgICdhbnRocm9waWMvY2xhdWRlLTMuNS1zb25uZXQnOiB7IGlucHV0VG9rZW5zOiAzLjAwLCBvdXRwdXRUb2tlbnM6IDE1LjAwIH0sXHJcbiAgICAnZ29vZ2xlL2dlbWluaS1wcm8tMS41JzogeyBpbnB1dFRva2VuczogMS4yNSwgb3V0cHV0VG9rZW5zOiA1LjAwIH0sXHJcbiAgICAnbWlzdHJhbGFpL21peHRyYWwtOHg3Yi1pbnN0cnVjdCc6IHsgaW5wdXRUb2tlbnM6IDAuMjQsIG91dHB1dFRva2VuczogMC4yNCB9LFxyXG4gIH07XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogQnVkZ2V0Q29uZmlnID0geyBtYXhEb2xsYXI6IDUuMDAsIHdhcm5pbmdUaHJlc2hvbGQ6IDgwIH0pIHtcclxuICAgIHRoaXMuYnVkZ2V0ID0gY29uZmlnO1xyXG4gICAgdGhpcy5sb2FkVXNhZ2VGcm9tU3RvcmFnZSgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBsb2FkVXNhZ2VGcm9tU3RvcmFnZSgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHN0b3JlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbkJ1ZGdldFVzYWdlJyk7XHJcbiAgICAgIGlmIChzdG9yZWQpIHtcclxuICAgICAgICB0aGlzLnVzYWdlID0gSlNPTi5wYXJzZShzdG9yZWQpO1xyXG4gICAgICAgIC8vIENsZWFuIHVwIG9sZCB1c2FnZSAob2xkZXIgdGhhbiAyNCBob3VycylcclxuICAgICAgICBjb25zdCBjdXRvZmYgPSBEYXRlLm5vdygpIC0gKDI0ICogNjAgKiA2MCAqIDEwMDApO1xyXG4gICAgICAgIHRoaXMudXNhZ2UgPSB0aGlzLnVzYWdlLmZpbHRlcih1ID0+IHUudGltZXN0YW1wID4gY3V0b2ZmKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9hZCB0b2tlbiBidWRnZXQgdXNhZ2U6JywgZXJyb3IpO1xyXG4gICAgICB0aGlzLnVzYWdlID0gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHNhdmVVc2FnZVRvU3RvcmFnZSgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0b2tlbkJ1ZGdldFVzYWdlJywgSlNPTi5zdHJpbmdpZnkodGhpcy51c2FnZSkpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gc2F2ZSB0b2tlbiBidWRnZXQgdXNhZ2U6JywgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZXN0aW1hdGVUb2tlbnModGV4dDogc3RyaW5nKTogbnVtYmVyIHtcclxuICAgIC8vIFJvdWdoIGVzdGltYXRpb246IH40IGNoYXJhY3RlcnMgcGVyIHRva2VuIGZvciBFbmdsaXNoIHRleHRcclxuICAgIC8vIE1vcmUgYWNjdXJhdGUgd291bGQgYmUgdG8gdXNlIHRpa3Rva2VuLCBidXQgdGhpcyBpcyBnb29kIGVub3VnaFxyXG4gICAgcmV0dXJuIE1hdGguY2VpbCh0ZXh0Lmxlbmd0aCAvIDQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q3VycmVudFNwZW5kKCk6IG51bWJlciB7XHJcbiAgICByZXR1cm4gdGhpcy51c2FnZS5yZWR1Y2UoKHRvdGFsLCB1c2FnZSkgPT4gdG90YWwgKyB1c2FnZS5jb3N0LCAwKTtcclxuICB9XHJcblxyXG4gIGdldFJlbWFpbmluZ0J1ZGdldCgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIHRoaXMuYnVkZ2V0Lm1heERvbGxhciAtIHRoaXMuZ2V0Q3VycmVudFNwZW5kKCkpO1xyXG4gIH1cclxuXHJcbiAgZ2V0QnVkZ2V0U3RhdHVzKCk6IHtcclxuICAgIHNwZW50OiBudW1iZXI7XHJcbiAgICByZW1haW5pbmc6IG51bWJlcjtcclxuICAgIHBlcmNlbnRhZ2U6IG51bWJlcjtcclxuICAgIGlzV2FybmluZzogYm9vbGVhbjtcclxuICAgIGlzRXhjZWVkZWQ6IGJvb2xlYW47XHJcbiAgfSB7XHJcbiAgICBjb25zdCBzcGVudCA9IHRoaXMuZ2V0Q3VycmVudFNwZW5kKCk7XHJcbiAgICBjb25zdCByZW1haW5pbmcgPSB0aGlzLmdldFJlbWFpbmluZ0J1ZGdldCgpO1xyXG4gICAgY29uc3QgcGVyY2VudGFnZSA9IChzcGVudCAvIHRoaXMuYnVkZ2V0Lm1heERvbGxhcikgKiAxMDA7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHNwZW50LFxyXG4gICAgICByZW1haW5pbmcsXHJcbiAgICAgIHBlcmNlbnRhZ2UsXHJcbiAgICAgIGlzV2FybmluZzogcGVyY2VudGFnZSA+PSB0aGlzLmJ1ZGdldC53YXJuaW5nVGhyZXNob2xkLFxyXG4gICAgICBpc0V4Y2VlZGVkOiBzcGVudCA+PSB0aGlzLmJ1ZGdldC5tYXhEb2xsYXJcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBjYW5BZmZvcmQobW9kZWw6IHN0cmluZywgZXN0aW1hdGVkSW5wdXRUb2tlbnM6IG51bWJlciwgZXN0aW1hdGVkT3V0cHV0VG9rZW5zOiBudW1iZXIgPSA1MDApOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGNvc3QgPSB0aGlzLmNhbGN1bGF0ZUNvc3QobW9kZWwsIGVzdGltYXRlZElucHV0VG9rZW5zLCBlc3RpbWF0ZWRPdXRwdXRUb2tlbnMpO1xyXG4gICAgcmV0dXJuIHRoaXMuZ2V0UmVtYWluaW5nQnVkZ2V0KCkgPj0gY29zdDtcclxuICB9XHJcblxyXG4gIGNhbGN1bGF0ZUNvc3QobW9kZWw6IHN0cmluZywgaW5wdXRUb2tlbnM6IG51bWJlciwgb3V0cHV0VG9rZW5zOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgY29uc3QgcHJpY2luZyA9IHRoaXMubW9kZWxQcmljaW5nW21vZGVsXTtcclxuICAgIGlmICghcHJpY2luZykge1xyXG4gICAgICBjb25zb2xlLndhcm4oYE5vIHByaWNpbmcgaW5mbyBmb3IgbW9kZWw6ICR7bW9kZWx9LCBhc3N1bWluZyBmcmVlYCk7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGlucHV0Q29zdCA9IChpbnB1dFRva2VucyAvIDFfMDAwXzAwMCkgKiBwcmljaW5nLmlucHV0VG9rZW5zO1xyXG4gICAgY29uc3Qgb3V0cHV0Q29zdCA9IChvdXRwdXRUb2tlbnMgLyAxXzAwMF8wMDApICogcHJpY2luZy5vdXRwdXRUb2tlbnM7XHJcbiAgICBcclxuICAgIHJldHVybiBpbnB1dENvc3QgKyBvdXRwdXRDb3N0O1xyXG4gIH1cclxuXHJcbiAgcmVjb3JkVXNhZ2UobW9kZWw6IHN0cmluZywgaW5wdXRUb2tlbnM6IG51bWJlciwgb3V0cHV0VG9rZW5zOiBudW1iZXIpOiB2b2lkIHtcclxuICAgIGNvbnN0IGNvc3QgPSB0aGlzLmNhbGN1bGF0ZUNvc3QobW9kZWwsIGlucHV0VG9rZW5zLCBvdXRwdXRUb2tlbnMpO1xyXG4gICAgXHJcbiAgICBjb25zdCB1c2FnZTogQnVkZ2V0VXNhZ2UgPSB7XHJcbiAgICAgIG1vZGVsLFxyXG4gICAgICBpbnB1dFRva2VucyxcclxuICAgICAgb3V0cHV0VG9rZW5zLFxyXG4gICAgICBjb3N0LFxyXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy51c2FnZS5wdXNoKHVzYWdlKTtcclxuICAgIHRoaXMuc2F2ZVVzYWdlVG9TdG9yYWdlKCk7XHJcblxyXG4gICAgY29uc29sZS5sb2coYFRva2VuIHVzYWdlIHJlY29yZGVkOmAsIHtcclxuICAgICAgbW9kZWwsXHJcbiAgICAgIGlucHV0VG9rZW5zLFxyXG4gICAgICBvdXRwdXRUb2tlbnMsXHJcbiAgICAgIGNvc3Q6IGNvc3QudG9GaXhlZCg0KSxcclxuICAgICAgdG90YWxTcGVudDogdGhpcy5nZXRDdXJyZW50U3BlbmQoKS50b0ZpeGVkKDQpLFxyXG4gICAgICByZW1haW5pbmc6IHRoaXMuZ2V0UmVtYWluaW5nQnVkZ2V0KCkudG9GaXhlZCg0KVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2FnZVN0YXRzKCk6IHtcclxuICAgIHRvdGFsUmVxdWVzdHM6IG51bWJlcjtcclxuICAgIHRvdGFsSW5wdXRUb2tlbnM6IG51bWJlcjtcclxuICAgIHRvdGFsT3V0cHV0VG9rZW5zOiBudW1iZXI7XHJcbiAgICB0b3RhbENvc3Q6IG51bWJlcjtcclxuICAgIG1vZGVsQnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCB7IHJlcXVlc3RzOiBudW1iZXI7IGNvc3Q6IG51bWJlcjsgdG9rZW5zOiBudW1iZXIgfT47XHJcbiAgfSB7XHJcbiAgICBjb25zdCBtb2RlbEJyZWFrZG93bjogUmVjb3JkPHN0cmluZywgeyByZXF1ZXN0czogbnVtYmVyOyBjb3N0OiBudW1iZXI7IHRva2VuczogbnVtYmVyIH0+ID0ge307XHJcbiAgICBcclxuICAgIGxldCB0b3RhbFJlcXVlc3RzID0gMDtcclxuICAgIGxldCB0b3RhbElucHV0VG9rZW5zID0gMDtcclxuICAgIGxldCB0b3RhbE91dHB1dFRva2VucyA9IDA7XHJcbiAgICBsZXQgdG90YWxDb3N0ID0gMDtcclxuXHJcbiAgICBmb3IgKGNvbnN0IHVzYWdlIG9mIHRoaXMudXNhZ2UpIHtcclxuICAgICAgdG90YWxSZXF1ZXN0cysrO1xyXG4gICAgICB0b3RhbElucHV0VG9rZW5zICs9IHVzYWdlLmlucHV0VG9rZW5zO1xyXG4gICAgICB0b3RhbE91dHB1dFRva2VucyArPSB1c2FnZS5vdXRwdXRUb2tlbnM7XHJcbiAgICAgIHRvdGFsQ29zdCArPSB1c2FnZS5jb3N0O1xyXG5cclxuICAgICAgaWYgKCFtb2RlbEJyZWFrZG93blt1c2FnZS5tb2RlbF0pIHtcclxuICAgICAgICBtb2RlbEJyZWFrZG93blt1c2FnZS5tb2RlbF0gPSB7IHJlcXVlc3RzOiAwLCBjb3N0OiAwLCB0b2tlbnM6IDAgfTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgbW9kZWxCcmVha2Rvd25bdXNhZ2UubW9kZWxdLnJlcXVlc3RzKys7XHJcbiAgICAgIG1vZGVsQnJlYWtkb3duW3VzYWdlLm1vZGVsXS5jb3N0ICs9IHVzYWdlLmNvc3Q7XHJcbiAgICAgIG1vZGVsQnJlYWtkb3duW3VzYWdlLm1vZGVsXS50b2tlbnMgKz0gdXNhZ2UuaW5wdXRUb2tlbnMgKyB1c2FnZS5vdXRwdXRUb2tlbnM7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdG90YWxSZXF1ZXN0cyxcclxuICAgICAgdG90YWxJbnB1dFRva2VucyxcclxuICAgICAgdG90YWxPdXRwdXRUb2tlbnMsXHJcbiAgICAgIHRvdGFsQ29zdCxcclxuICAgICAgbW9kZWxCcmVha2Rvd25cclxuICAgIH07XHJcbiAgfVxyXG5cclxuICByZXNldEJ1ZGdldCgpOiB2b2lkIHtcclxuICAgIHRoaXMudXNhZ2UgPSBbXTtcclxuICAgIHRoaXMuc2F2ZVVzYWdlVG9TdG9yYWdlKCk7XHJcbiAgfVxyXG5cclxuICBzZXRCdWRnZXQoY29uZmlnOiBQYXJ0aWFsPEJ1ZGdldENvbmZpZz4pOiB2b2lkIHtcclxuICAgIHRoaXMuYnVkZ2V0ID0geyAuLi50aGlzLmJ1ZGdldCwgLi4uY29uZmlnIH07XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgdG9rZW5CdWRnZXQgPSBuZXcgVG9rZW5CdWRnZXRTZXJ2aWNlKCk7Il0sIm5hbWVzIjpbIlRva2VuQnVkZ2V0U2VydmljZSIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwibWF4RG9sbGFyIiwid2FybmluZ1RocmVzaG9sZCIsInVzYWdlIiwibW9kZWxQcmljaW5nIiwiaW5wdXRUb2tlbnMiLCJvdXRwdXRUb2tlbnMiLCJidWRnZXQiLCJsb2FkVXNhZ2VGcm9tU3RvcmFnZSIsInN0b3JlZCIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJKU09OIiwicGFyc2UiLCJjdXRvZmYiLCJEYXRlIiwibm93IiwiZmlsdGVyIiwidSIsInRpbWVzdGFtcCIsImVycm9yIiwiY29uc29sZSIsIndhcm4iLCJzYXZlVXNhZ2VUb1N0b3JhZ2UiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwiZXN0aW1hdGVUb2tlbnMiLCJ0ZXh0IiwiTWF0aCIsImNlaWwiLCJsZW5ndGgiLCJnZXRDdXJyZW50U3BlbmQiLCJyZWR1Y2UiLCJ0b3RhbCIsImNvc3QiLCJnZXRSZW1haW5pbmdCdWRnZXQiLCJtYXgiLCJnZXRCdWRnZXRTdGF0dXMiLCJzcGVudCIsInJlbWFpbmluZyIsInBlcmNlbnRhZ2UiLCJpc1dhcm5pbmciLCJpc0V4Y2VlZGVkIiwiY2FuQWZmb3JkIiwibW9kZWwiLCJlc3RpbWF0ZWRJbnB1dFRva2VucyIsImVzdGltYXRlZE91dHB1dFRva2VucyIsImNhbGN1bGF0ZUNvc3QiLCJwcmljaW5nIiwiaW5wdXRDb3N0Iiwib3V0cHV0Q29zdCIsInJlY29yZFVzYWdlIiwicHVzaCIsImxvZyIsInRvRml4ZWQiLCJ0b3RhbFNwZW50IiwiZ2V0VXNhZ2VTdGF0cyIsIm1vZGVsQnJlYWtkb3duIiwidG90YWxSZXF1ZXN0cyIsInRvdGFsSW5wdXRUb2tlbnMiLCJ0b3RhbE91dHB1dFRva2VucyIsInRvdGFsQ29zdCIsInJlcXVlc3RzIiwidG9rZW5zIiwicmVzZXRCdWRnZXQiLCJzZXRCdWRnZXQiLCJ0b2tlbkJ1ZGdldCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/tokenBudget.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "?d272":
/*!********************************!*\
  !*** supports-color (ignored) ***!
  \********************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/axios","vendor-chunks/asynckit","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/call-bind-apply-helpers","vendor-chunks/debug","vendor-chunks/get-proto","vendor-chunks/mime-db","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/form-data","vendor-chunks/follow-redirects","vendor-chunks/axios-retry","vendor-chunks/proxy-from-env","vendor-chunks/ms","vendor-chunks/mime-types","vendor-chunks/is-retry-allowed","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/get-intrinsic","vendor-chunks/es-set-tostringtag","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/delayed-stream","vendor-chunks/combined-stream"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=D%3A%5Ccoding%5Claunch%5CthoughtPolice%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5Ccoding%5Claunch%5CthoughtPolice&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();